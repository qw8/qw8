<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.9.0">
    

    

    



    <meta charset="utf-8">
    
    
    
    
    <title>前端通信 | 秦伟博客 | 前端、全栈、SEO的知识点、面试题与学习链接的整理</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    <meta name="theme-color" content="#3F51B5">
    
    
    <meta name="keywords" content="同源策略,通信方式,Ajax,JSON,跨域通信,异步">
    <meta name="description" content="前言前端通信类的问题，主要包括以下内容： 前后端如何通信：如果你不准备，估计也就只能说出ajax。这个可以考察出知识面。 如何创建Ajax  Ajax在前后端通信中经常用到。做业务时，可以借助第三方的库，比如vue框架里的库、jQuery也有封装好的方法。但如果让你用原生的js去实现，该怎么做？  这就是考察你的动手能力，以及框架原理的掌握。如果能写出来，可以体现出你的基本功。是加分项。  在回答">
<meta name="keywords" content="同源策略,通信方式,Ajax,JSON,跨域通信,异步">
<meta property="og:type" content="article">
<meta property="og:title" content="前端通信">
<meta property="og:url" content="https://qw8.github.io/qw8/knowledges/qian-duan-tong-xin.html">
<meta property="og:site_name" content="秦伟博客">
<meta property="og:description" content="前言前端通信类的问题，主要包括以下内容： 前后端如何通信：如果你不准备，估计也就只能说出ajax。这个可以考察出知识面。 如何创建Ajax  Ajax在前后端通信中经常用到。做业务时，可以借助第三方的库，比如vue框架里的库、jQuery也有封装好的方法。但如果让你用原生的js去实现，该怎么做？  这就是考察你的动手能力，以及框架原理的掌握。如果能写出来，可以体现出你的基本功。是加分项。  在回答">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="https://qw8.github.io/img/loading.gif">
<meta property="og:image" content="https://qw8.github.io/img/loading.gif">
<meta property="og:updated_time" content="2023-12-25T08:44:40.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="前端通信">
<meta name="twitter:description" content="前言前端通信类的问题，主要包括以下内容： 前后端如何通信：如果你不准备，估计也就只能说出ajax。这个可以考察出知识面。 如何创建Ajax  Ajax在前后端通信中经常用到。做业务时，可以借助第三方的库，比如vue框架里的库、jQuery也有封装好的方法。但如果让你用原生的js去实现，该怎么做？  这就是考察你的动手能力，以及框架原理的掌握。如果能写出来，可以体现出你的基本功。是加分项。  在回答">
<meta name="twitter:image" content="https://qw8.github.io/img/loading.gif">
    
        <link rel="alternate" type="application/atom+xml" title="秦伟博客" href="/qw8/atom.xml">
    
    <link rel="shortcut icon" href="/qw8/img/qw.ico">
    <link rel="stylesheet" href="/qw8/css/style.css?v=1.7.2">
    <script>window.lazyScripts=[]</script>

    <!-- custom head -->
    

</head>

<body>
<div id="loading" class="active"></div>

<aside id="menu" class="hide" >
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-close"></i>
    </a>
    <div class="brand-wrap" style="background-image:url(/qw8/img/brand.jpg)">
      <div class="brand">
        <a href="/qw8/" class="avatar waves-effect waves-circle waves-light">
          <img src="/qw8/img/avatar.jpg">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname">秦伟</h5>
          <a href="mailto:124729081@qq.com" title="124729081@qq.com" class="mail">124729081@qq.com</a>
        </hgroup>
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
            <li class="waves-block waves-effect">
              <a href="/qw8/"  >
                <i class="icon icon-lg icon-home"></i>
                主页
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/qw8/categories"  >
                <i class="icon icon-lg icon-th-list"></i>
                分类
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/qw8/tags"  >
                <i class="icon icon-lg icon-tags"></i>
                标签
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/qw8/archives"  >
                <i class="icon icon-lg icon-hourglass"></i>
                时光
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="http://wpa.qq.com/msgrd?v=3&uin=124729081&site=qq&menu=yes" target="_blank" >
                <i class="icon icon-lg icon-qq"></i>
                聊天
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&email=124729081@qq.com"  >
                <i class="icon icon-lg icon-envelope-o"></i>
                邮箱
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/qw8/user"  >
                <i class="icon icon-lg icon-user"></i>
                简介
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://gitee.com/qw66" target="_blank" >
                <i class="icon icon-lg icon-code"></i>
                Gitee
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://github.com/qw8" target="_blank" >
                <i class="icon icon-lg icon-github"></i>
                Github
              </a>
            </li>
        
      </ul>
    </div>
  </div>
</aside>

<main id="main">
    <header class="top-header" id="header">
    <div class="flex-row">
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">前端通信</div>
        
        <div class="search-wrap" id="search-wrap">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="back">
                <i class="icon icon-lg icon-chevron-left"></i>
            </a>
            <input type="text" id="key" class="search-input" autocomplete="off" placeholder="输入感兴趣的关键字">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="search">
                <i class="icon icon-lg icon-search"></i>
            </a>
        </div>
        
        
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menuShare">
            <i class="icon icon-lg icon-share-alt"></i>
        </a>
        
    </div>
</header>
<header class="content-header post-header">

    <div class="container fade-scale">
        <h1 class="title">前端通信</h1>
        <h5 class="subtitle">
            
                <time datetime="2020-12-10T13:51:01.000Z" itemprop="datePublished" class="page-time">
  2020-12-10
</time>


	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/qw8/categories/前端知识点/">前端知识点</a></li></ul>

            
        </h5>
    </div>

    


</header>


<div class="container body-wrap">
    
    <aside class="post-widget">
        <nav class="post-toc-wrap post-toc-shrink" id="post-toc">
            <h4>TOC</h4>
            <ol class="post-toc"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#前言"><span class="post-toc-number">1.</span> <span class="post-toc-text">前言</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#1-同源策略的概念和具体限制"><span class="post-toc-number">2.</span> <span class="post-toc-text">1.同源策略的概念和具体限制</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#请解释一下-JavaScript-的同源策略"><span class="post-toc-number">2.1.</span> <span class="post-toc-text">请解释一下 JavaScript 的同源策略</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#为什么要有同源限制？"><span class="post-toc-number">2.2.</span> <span class="post-toc-text">为什么要有同源限制？</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#2-前后端如何通信"><span class="post-toc-number">3.</span> <span class="post-toc-text">2. 前后端如何通信</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#主要有以下几种方式："><span class="post-toc-number">3.1.</span> <span class="post-toc-text">主要有以下几种方式：</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#多个页面之间如何进行通信"><span class="post-toc-number">3.2.</span> <span class="post-toc-text">多个页面之间如何进行通信</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Ajax"><span class="post-toc-number">4.</span> <span class="post-toc-text">Ajax</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#什么是-Ajax"><span class="post-toc-number">4.1.</span> <span class="post-toc-text">什么是 Ajax</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#ajax-的优点"><span class="post-toc-number">4.2.</span> <span class="post-toc-text">ajax 的优点</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#ajax-的缺点"><span class="post-toc-number">4.3.</span> <span class="post-toc-text">ajax 的缺点</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#如何创建一个Ajax？"><span class="post-toc-number">4.4.</span> <span class="post-toc-text">如何创建一个Ajax？</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Ajax-是什么-如何创建一个Ajax？"><span class="post-toc-number">4.5.</span> <span class="post-toc-text">Ajax 是什么? 如何创建一个Ajax？</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#创建-ajax-过程"><span class="post-toc-number">4.6.</span> <span class="post-toc-text">创建 ajax 过程</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#创建-ajax-步骤："><span class="post-toc-number">4.7.</span> <span class="post-toc-text">创建 ajax 步骤：</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Ajax-实现的原理"><span class="post-toc-number">4.8.</span> <span class="post-toc-text">Ajax 实现的原理</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#ajax-如何实现，readyState-的五种状态的含义？"><span class="post-toc-number">4.9.</span> <span class="post-toc-text">ajax 如何实现，readyState 的五种状态的含义？</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#ajax-加载的页面，跳转到另外一个页面再跳转回来，内容相同，如何节约读取请求"><span class="post-toc-number">4.10.</span> <span class="post-toc-text">ajax 加载的页面，跳转到另外一个页面再跳转回来，内容相同，如何节约读取请求?</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Ajax-解决浏览器缓存问题？"><span class="post-toc-number">4.11.</span> <span class="post-toc-text">Ajax 解决浏览器缓存问题？</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#GET-和-POST-的区别，何时使用-POST？"><span class="post-toc-number">4.12.</span> <span class="post-toc-text">GET 和 POST 的区别，何时使用 POST？</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#ajax-请求时，如何解析-json-数据"><span class="post-toc-number">4.13.</span> <span class="post-toc-text">ajax 请求时，如何解析 json 数据</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#发送-get-请求和-post-请求"><span class="post-toc-number">4.14.</span> <span class="post-toc-text">发送 get 请求和 post 请求</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#onreadystatechange-事件"><span class="post-toc-number">4.15.</span> <span class="post-toc-text">onreadystatechange 事件</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#事件的触发条件"><span class="post-toc-number">4.16.</span> <span class="post-toc-text">事件的触发条件</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#事件的触发顺序"><span class="post-toc-number">4.17.</span> <span class="post-toc-text">事件的触发顺序</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#实际开发中用的-原生Ajax请求"><span class="post-toc-number">4.18.</span> <span class="post-toc-text">实际开发中用的 原生Ajax请求</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#4-json"><span class="post-toc-number">5.</span> <span class="post-toc-text">4.json</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#什么是-json"><span class="post-toc-number">5.1.</span> <span class="post-toc-text">什么是 json</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#json优点"><span class="post-toc-number">5.2.</span> <span class="post-toc-text">json优点:</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#json缺点"><span class="post-toc-number">5.3.</span> <span class="post-toc-text">json缺点:</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#XML和JSON的区别？"><span class="post-toc-number">5.4.</span> <span class="post-toc-text">XML和JSON的区别？</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#5-跨域"><span class="post-toc-number">6.</span> <span class="post-toc-text">5.跨域</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#如何解决跨域问题"><span class="post-toc-number">6.1.</span> <span class="post-toc-text">如何解决跨域问题?</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#如何解决跨域问题-1"><span class="post-toc-number">6.2.</span> <span class="post-toc-text">如何解决跨域问题?</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#跨域通信的几种方式"><span class="post-toc-number">6.3.</span> <span class="post-toc-text">跨域通信的几种方式</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#5-1-JSONP"><span class="post-toc-number">6.4.</span> <span class="post-toc-text">5.1 JSONP</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#5-2-WebSocket"><span class="post-toc-number">6.5.</span> <span class="post-toc-text">5.2 WebSocket</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#5-3-CORS"><span class="post-toc-number">6.6.</span> <span class="post-toc-text">5.3 CORS</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#5-4-Hash"><span class="post-toc-number">6.7.</span> <span class="post-toc-text">5.4 Hash</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#5-5-postMessage-方法"><span class="post-toc-number">6.8.</span> <span class="post-toc-text">5.5 postMessage()方法</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#如何解决跨域问题-2"><span class="post-toc-number">6.9.</span> <span class="post-toc-text">如何解决跨域问题</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-6"><a class="post-toc-link" href="#JSONP："><span class="post-toc-number">6.9.0.0.1.</span> <span class="post-toc-text">JSONP：</span></a></li></ol></li></ol></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#5-1-跨域"><span class="post-toc-number">6.10.</span> <span class="post-toc-text">5.1 跨域</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#解释-jsonp-的原理，以及为什么不是真正的-ajax"><span class="post-toc-number">6.11.</span> <span class="post-toc-text">解释 jsonp 的原理，以及为什么不是真正的 ajax</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#jsonp-优缺点"><span class="post-toc-number">6.12.</span> <span class="post-toc-text">jsonp 优缺点</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#6-其他"><span class="post-toc-number">7.</span> <span class="post-toc-text">6.其他</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#同步和异步的区别"><span class="post-toc-number">7.1.</span> <span class="post-toc-text">同步和异步的区别?</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#异步加载和延迟加载"><span class="post-toc-number">7.2.</span> <span class="post-toc-text">异步加载和延迟加载</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#一个页面从输入-URL-到页面加载显示完成，这个过程中都发生了什么？"><span class="post-toc-number">7.3.</span> <span class="post-toc-text">一个页面从输入 URL 到页面加载显示完成，这个过程中都发生了什么？</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#页面编码和被请求的资源编码如果不一致如何处理？"><span class="post-toc-number">7.4.</span> <span class="post-toc-text">页面编码和被请求的资源编码如果不一致如何处理？</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Ajax-和-Fetch-区别"><span class="post-toc-number">7.5.</span> <span class="post-toc-text">Ajax 和 Fetch 区别</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#XML-和-JSON-的区别？"><span class="post-toc-number">7.6.</span> <span class="post-toc-text">XML 和 JSON 的区别？</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#RESTful"><span class="post-toc-number">7.7.</span> <span class="post-toc-text">RESTful</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#withCredentials详细介绍"><span class="post-toc-number">7.8.</span> <span class="post-toc-text">withCredentials详细介绍</span></a></li></ol></li></ol>
        </nav>
    </aside>


<article id="post-knowledges/前端通信"
  class="post-article article-type-post fade" itemprop="blogPost">

    <div class="post-card">
        <h1 class="post-card-title">前端通信</h1>
        <div class="post-meta">
            <time class="post-time" title="2020-12-10 21:51:01" datetime="2020-12-10T13:51:01.000Z"  itemprop="datePublished">2020-12-10</time>

            
	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/qw8/categories/前端知识点/">前端知识点</a></li></ul>



            
<span id="busuanzi_container_page_pv" title="文章总阅读量" style='display:none'>
    <i class="icon icon-eye icon-pr"></i><span id="busuanzi_value_page_pv"></span>
</span>


        </div>
        <div class="post-content" id="post-content" itemprop="postContent">
            <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p><strong>前端通信类的问题，主要包括以下内容</strong>：</p>
<p><strong>前后端如何通信</strong>：如果你不准备，估计也就只能说出<code>ajax</code>。这个可以考察出知识面。</p>
<p><strong>如何创建Ajax</strong></p>
<blockquote>
<p><code>Ajax</code>在前后端通信中经常用到。做业务时，可以借助第三方的库，比如<code>vue</code>框架里的库、<code>jQuery</code>也有封装好的方法。但如果让你用原生的<code>js</code>去实现，该怎么做？</p>
</blockquote>
<p>这就是考察你的动手能力，以及框架原理的掌握。如果能写出来，可以体现出你的基本功。是加分项。</p>
<blockquote>
<p>在回答 <code>Ajax</code> 的问题时，要回答以下几个方面：</p>
</blockquote>
<ol>
<li><code>XMLHttpRequest</code> 的工作原理</li>
<li>兼容性处理</li>
</ol>
<blockquote>
<p><code>XMLHttpRequest</code>只有在高级浏览器中才支持。在回答问题时，这个兼容性问题不要忽略。</p>
</blockquote>
<ol start="3">
<li>事件的触发条件</li>
<li>事件的触发顺序</li>
</ol>
<blockquote>
<p><code>XMLHttpRequest</code>有很多触发事件，每个事件是怎么触发的。</p>
</blockquote>
<p><strong>跨域通信的几种方式</strong></p>
<blockquote>
<p>这部分非常重要。无非就是问你：什么是跨域、跨域有什么限制、<strong>跨域有几种方式</strong>。</p>
</blockquote>
<h2 id="1-同源策略的概念和具体限制"><a href="#1-同源策略的概念和具体限制" class="headerlink" title="1.同源策略的概念和具体限制"></a>1.同源策略的概念和具体限制</h2><h3 id="请解释一下-JavaScript-的同源策略"><a href="#请解释一下-JavaScript-的同源策略" class="headerlink" title="请解释一下 JavaScript 的同源策略"></a>请解释一下 JavaScript 的同源策略</h3><p><strong>同源策略</strong>：限制从一个源加载的文档或脚本如何与来自另一个源的资源进行交互。这是一个用于隔离潜在恶意文件的关键的安全机制。</p>
<p>是客户端脚本（尤其是 Javascript）的重要的安全度量标准。它最早出自 Netscape Navigator2.0，其目的是<strong>防止某个文档或脚本从多个不同源装载</strong>。</p>
<p>所谓<strong>同源</strong>指的是：协议，域名，端口相同，同源策略是一种安全协议，指一段脚本只能读取来自同一来源的窗口和文档的属性。</p>
<p><strong>具体解释：</strong></p>
<ol>
<li><code>源</code>包括三个部分：协议、域名、端口（<code>http</code>协议的默认端口是<code>80</code>）。如果有任何一个部分不同，则<code>源</code>不同，那就是跨域了。</li>
<li><code>限制</code>：这个源的文档没有权利去操作另一个源的文档。这个限制体现在：（要记住）</li>
</ol>
<ul>
<li><code>Cookie</code>、<code>LocalStorage</code>和<code>IndexDB</code>无法获取。</li>
<li>无法获取和操作<code>DOM</code>。</li>
<li>不能发送<code>Ajax</code>请求。我们要注意，<code>Ajax</code>只适合<strong>同源</strong>的通信。</li>
</ul>
<h3 id="为什么要有同源限制？"><a href="#为什么要有同源限制？" class="headerlink" title="为什么要有同源限制？"></a>为什么要有同源限制？</h3><p>我们举例说明：比如一个黑客程序，他利用Iframe把真正的银行登录页面嵌到他的页面上，当你使用真实的用户名，密码登录时，他的页面就可以通过Javascript读取到你的表单中input中的内容，这样用户名，密码就轻松到手了。</p>
<p><strong>缺点</strong></p>
<p>同源策略带来的麻烦：ajax 在不同域名下的请求无法实现，需要进行跨域操作</p>
<p>现在网站的JS都会进行压缩，一些文件用了严格模式，而另一些没有。这时这些本来是严格模式的文件，被 merge后，这个串就到了文件的中间，不仅没有指示严格模式，反而在压缩后浪费了字节。</p>
<h2 id="2-前后端如何通信"><a href="#2-前后端如何通信" class="headerlink" title="2. 前后端如何通信"></a>2. 前后端如何通信</h2><h3 id="主要有以下几种方式："><a href="#主要有以下几种方式：" class="headerlink" title="主要有以下几种方式："></a>主要有以下几种方式：</h3><ul>
<li><code>Ajax</code>：不支持跨域。</li>
<li><code>WebSocket</code>：不受同源策略的限制，支持跨域</li>
<li><code>CORS</code>：不受同源策略的限制，支持跨域。一种新的通信协议标准。可以理解成是：<strong>同时支持同源和跨域的Ajax</strong>。</li>
</ul>
<h3 id="多个页面之间如何进行通信"><a href="#多个页面之间如何进行通信" class="headerlink" title="多个页面之间如何进行通信"></a>多个页面之间如何进行通信</h3><ul>
<li>cookie</li>
<li>web worker</li>
<li>localeStorage 和 sessionStorage</li>
</ul>
<h2 id="Ajax"><a href="#Ajax" class="headerlink" title="Ajax"></a>Ajax</h2><h3 id="什么是-Ajax"><a href="#什么是-Ajax" class="headerlink" title="什么是 Ajax"></a>什么是 Ajax</h3><p>Ajax 是全称是Asynchronous Javascript And XML，异步传输+js+xml，即异步 JavaScript 和 xml；</p>
<p>主要用来实现客户端与服务器异步数据交互，不用重载整个网页，实现页面局部刷新。</p>
<p>所谓异步，在这里简单地解释就是：向服务器发送请求的时候，我们不必等待结果，而是可以同时做其他的事情，等到有了结果它自己会根据设定进行后续操作，与此同时，页面是不会发生整页刷新的，提高了用户体验。</p>
<h3 id="ajax-的优点"><a href="#ajax-的优点" class="headerlink" title="ajax 的优点"></a>ajax 的优点</h3><ol>
<li>来自服务器的新内容可以动态更改，通过异步模式，无需重新加载整个页面，实现页面局部刷新</li>
<li>避免用户不断刷新或者跳转页面，提高用户体验</li>
<li>优化了浏览器和服务器之间的传输，降低数据传输量，减少不必要的数据往返，减少了带宽占用</li>
<li>Ajax 在客户端运行，承担了一部分本来由服务器承担的工作，减少了大用户量下的服务器负载。</li>
</ol>
<h3 id="ajax-的缺点"><a href="#ajax-的缺点" class="headerlink" title="ajax 的缺点"></a>ajax 的缺点</h3><ol>
<li>ajax 不支持浏览器 back 按钮，要实现 ajax 下的前后退功能成本较大</li>
<li>可能造成请求数的增加跨域问题限制；</li>
<li>安全问题： AJAX 暴露了与服务器交互的细节。</li>
<li>对搜索引擎的支持比较弱。</li>
<li>破坏了程序的异常机制。</li>
</ol>
<h3 id="如何创建一个Ajax？"><a href="#如何创建一个Ajax？" class="headerlink" title="如何创建一个Ajax？"></a>如何创建一个Ajax？</h3><p>(1)创建XMLHttpRequest对象,也就是创建一个异步调用对象</p>
<p>(2)创建一个新的HTTP请求,并指定该HTTP请求的方法、URL及验证信息</p>
<p>(3)设置响应HTTP请求状态变化的函数</p>
<p>(4)发送HTTP请求</p>
<p>(5)获取异步调用返回的数据</p>
<p>(6)使用JavaScript和DOM实现局部刷新</p>
<h3 id="Ajax-是什么-如何创建一个Ajax？"><a href="#Ajax-是什么-如何创建一个Ajax？" class="headerlink" title="Ajax 是什么? 如何创建一个Ajax？"></a>Ajax 是什么? 如何创建一个Ajax？</h3><blockquote>
<p>ajax的全称：Asynchronous Javascript And XML</p>
</blockquote>
<ul>
<li><p>异步传输+js+xml</p>
</li>
<li><p>所谓异步，在这里简单地解释就是：向服务器发送请求的时候，我们不必等待结果，而是可以同时做其他的事情，等到有了结果它自己会根据设定进行后续操作，与此同时，页面是不会发生整页刷新的，提高了用户体验</p>
</li>
<li><p>创建XMLHttpRequest对象,也就是创建一个异步调用对象</p>
</li>
<li><p>建一个新的HTTP请求,并指定该HTTP请求的方法、URL及验证信息</p>
</li>
<li><p>设置响应HTTP请求状态变化的函数</p>
</li>
<li><p>发送HTTP请求</p>
</li>
<li><p>获取异步调用返回的数据</p>
</li>
<li><p>用JavaScript和DOM实现局部刷新</p>
</li>
</ul>
<h3 id="创建-ajax-过程"><a href="#创建-ajax-过程" class="headerlink" title="创建 ajax 过程"></a>创建 ajax 过程</h3><p>基本步骤 5步走：（创建对象、建立连接、发送数据、接收数据、局部刷新）</p>
<p>1.创建 XMLHttpRequest 对象,也就是创建一个异步调用对象</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var xhr=new XMLHttpRequest() //创建对象</span><br></pre></td></tr></table></figure>

<p>2.创建一个新的 HTTP 请求,并指定该 HTTP 请求的方法、URL 及验证信息，跟服务器建立一个连接，设置响应 HTTP 请求状态变化的函数</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">xhr.open(&quot;type 提交方式&quot;, &quot;url  提交的地址&quot;)</span><br><span class="line"></span><br><span class="line">如果是post请求，需要设置请求头</span><br><span class="line"></span><br><span class="line">xhr.setRequestHeader(&quot;Content-Type&quot;,&quot;application/x-www-form-urlencoded&quot;);</span><br></pre></td></tr></table></figure>

<p>3.我要发送数据给服务器（发送 HTTP 请求）</p>
<p>​    如果是get 请求，请求的数据在地址的后面。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xhr.send() //发送数据，这一步不能省略</span><br></pre></td></tr></table></figure>

<p>4.获取异步调用服务器返回的数据<br>        服务端返回数据会调用一个回调函数，通过回调函数去接收数据.   </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">xhr.onreadystatechange=function()&#123;</span><br><span class="line">            if(xhr.readyState==4)&#123; 响应完成了</span><br><span class="line">                    if(xhr.status==200)&#123; //响应成功了</span><br><span class="line">                          responseText 属性接收服务端返回的数据.</span><br><span class="line">                    &#125;</span><br><span class="line">            &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>5.使用 JavaScript 和 DOM 实现局部刷新</p>
<h3 id="创建-ajax-步骤："><a href="#创建-ajax-步骤：" class="headerlink" title="创建 ajax 步骤："></a>创建 <code>ajax</code> 步骤：</h3><ul>
<li>1.创建 <code>XMLHttpRequest</code> 对象</li>
<li>2.创建一个新的 <code>HTTP</code> 请求，并指定该 <code>HTTP</code> 请求的类型、验证信息</li>
<li>3.设置响应 <code>HTTP</code> 请求状态变化的回调函数</li>
<li>4.发送 <code>HTTP</code> 请求</li>
<li>5.获取异步调用返回的数据</li>
<li>6.使用 <code>JavaScript</code> 和 <code>DOM</code> 实现局部刷新</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> xhr = <span class="keyword">new</span> XMLHttpRequest();</span><br><span class="line">xhr.open(<span class="string">"POST"</span>, url, <span class="literal">true</span>);</span><br><span class="line">xhr.setRequestHeader(<span class="string">"Content-type"</span>, <span class="string">"application/x-www-form-urlencoded"</span>);</span><br><span class="line">xhr.onreadystatechange = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (xhr.readyState == <span class="number">4</span> &amp;&amp; (xhr.status == <span class="number">200</span> || xhr.status == <span class="number">304</span>)) &#123;</span><br><span class="line">        fn.call(<span class="keyword">this</span>, xhr.responseText);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">xhr.send(data);</span><br></pre></td></tr></table></figure>

<h3 id="Ajax-实现的原理"><a href="#Ajax-实现的原理" class="headerlink" title="Ajax 实现的原理"></a>Ajax 实现的原理</h3><p>浏览器提供的 XMLHttpRequest 对象</p>
<h3 id="ajax-如何实现，readyState-的五种状态的含义？"><a href="#ajax-如何实现，readyState-的五种状态的含义？" class="headerlink" title="ajax 如何实现，readyState 的五种状态的含义？"></a>ajax 如何实现，readyState 的五种状态的含义？</h3><ul>
<li>0 － （未初始化）还没有调用 send()方法</li>
<li>1 － （载入）已调用 send()方法，正在发送请求</li>
<li>2 － （载入完成）send()方法执行完成，已经接收到全部响应内容</li>
<li>3 － （交互）正在解析响应内容</li>
<li>4 － （完成）响应内容解析完成，可以在客户端调用了</li>
</ul>
<p>解析：</p>
<p>(0)未初始化</p>
<p>此阶段确认 XMLHttpRequest 对象是否创建，并为调用 open()方法进行未初始化作好准备。值为 0 表示对象已经存在，否则浏览器会报错－－对象不存在。</p>
<p>(1)载入</p>
<p>此阶段对 XMLHttpRequest 对象进行初始化，即调用 open()方法，根据参数(method,url,true)完成对象状态的设置。并调用 send()方法开始向服务端发送请求。值为 1 表示正在向服务端发送请求。</p>
<p>(2)载入完成</p>
<p>此阶段接收服务器端的响应数据。但获得的还只是服务端响应的原始数据，并不能直接在客户端使用。值为 2 表示已经接收完全部响应数据。并为下一阶段对数据解析作好准备。</p>
<p>(3)交互</p>
<p>此阶段解析接收到的服务器端响应数据。即根据服务器端响应头部返回的 MIME 类型把数据转换成能通过 responseBody、responseText 或 responseXML 属性存取的格式，为在客户端调用作好准备。状态 3 表示正在解析数据。</p>
<p>(4)完成</p>
<p>此阶段确认全部数据都已经解析为客户端可用的格式，解析已经完成。值为 4 表示数据解析完毕，可以通过 XMLHttpRequest 对象的相应属性取得数据。</p>
<p><a href="https://blog.csdn.net/u011565547/article/details/78979030" target="_blank" rel="noopener">参考</a></p>
<h3 id="ajax-加载的页面，跳转到另外一个页面再跳转回来，内容相同，如何节约读取请求"><a href="#ajax-加载的页面，跳转到另外一个页面再跳转回来，内容相同，如何节约读取请求" class="headerlink" title="ajax 加载的页面，跳转到另外一个页面再跳转回来，内容相同，如何节约读取请求?"></a>ajax 加载的页面，跳转到另外一个页面再跳转回来，内容相同，如何节约读取请求?</h3><p>后台做缓存，读取缓存里面的数据。CDN</p>
<h3 id="Ajax-解决浏览器缓存问题？"><a href="#Ajax-解决浏览器缓存问题？" class="headerlink" title="Ajax 解决浏览器缓存问题？"></a>Ajax 解决浏览器缓存问题？</h3><p>1、在ajax发送请求前加上      anyAjaxObj.setRequestHeader(“If-Modified-Since”,”0”)。</p>
<p>2、在ajax发送请求前加上    anyAjaxObj.setRequestHeader(“Cache-Control”,”no-cache”)。</p>
<p>3、在URL后面加上一个随机数： “fresh=” + Math.random();。</p>
<p>4、在URL后面加上时间搓：”nowtime=” + new Date().getTime();。</p>
<p>5、如果是使用jQuery，直接这样就可以了    $.ajaxSetup({cache:false})。这样页面的所有ajax都会执行这条语句就是不需要保存缓存记录</p>
<h3 id="GET-和-POST-的区别，何时使用-POST？"><a href="#GET-和-POST-的区别，何时使用-POST？" class="headerlink" title="GET 和 POST 的区别，何时使用 POST？"></a>GET 和 POST 的区别，何时使用 POST？</h3><p><strong>GET：</strong></p>
<ul>
<li>一般用于信息获取，使用 URL 传递参数，对所发送信息的数量也有限制，一般在 2000 个字符，有的浏览器是 8000 个字符；</li>
<li>请求的参数都暴露在 url 地址当中，如果传递中文参数，需要自己进行编码操作，安全性较低。</li>
</ul>
<p><strong>POST：</strong></p>
<ul>
<li>一般用于提交数据和修改服务器上的资源，对所发送的信息没有限制</li>
<li>提交的数据内容存在于 http 请求体中，数据不会暴漏在 url 地址中。</li>
</ul>
<p><strong>在以下情况中，请使用 POST 请求：</strong></p>
<ol>
<li>无法使用缓存文件（更新服务器上的文件或数据库）</li>
<li>向服务器发送大量数据（POST 没有数据量限制）</li>
<li>发送包含未知字符的用户输入时，POST 比 GET 更稳定也更可靠</li>
</ol>
<h3 id="ajax-请求时，如何解析-json-数据"><a href="#ajax-请求时，如何解析-json-数据" class="headerlink" title="ajax 请求时，如何解析 json 数据"></a>ajax 请求时，如何解析 json 数据</h3><p>使用 eval() 或者 JSON.parse() 鉴于安全性考虑，推荐使用 JSON.parse()更靠谱，对数据的安全性更好。</p>
<h3 id="发送-get-请求和-post-请求"><a href="#发送-get-请求和-post-请求" class="headerlink" title="发送 get 请求和 post 请求"></a>发送 get 请求和 post 请求</h3><blockquote>
<p><code>get</code>请求举例：</p>
</blockquote>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>Ajax 发送 get 请求<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">value</span>=<span class="string">"发送get_ajax请求"</span> <span class="attr">id</span>=<span class="string">'btnAjax'</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span></span><br><span class="line"><span class="actionscript">    <span class="comment">// 绑定点击事件</span></span></span><br><span class="line"><span class="javascript">    <span class="built_in">document</span>.querySelector(<span class="string">'#btnAjax'</span>).onclick = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="actionscript">        <span class="comment">// 发送ajax 请求 需要 五步</span></span></span><br><span class="line"></span><br><span class="line"><span class="actionscript">        <span class="comment">// （1）创建异步对象</span></span></span><br><span class="line"><span class="actionscript">        <span class="keyword">var</span> ajaxObj = <span class="keyword">new</span> XMLHttpRequest();</span></span><br><span class="line"></span><br><span class="line"><span class="actionscript">        <span class="comment">// （2）设置请求的参数。包括：请求的方法、请求的url。</span></span></span><br><span class="line"><span class="actionscript">        ajaxObj.open(<span class="string">'get'</span>, <span class="string">'02-ajax.php'</span>);</span></span><br><span class="line"></span><br><span class="line"><span class="actionscript">        <span class="comment">// （3）发送请求</span></span></span><br><span class="line">        ajaxObj.send();</span><br><span class="line"></span><br><span class="line"><span class="actionscript">        <span class="comment">//（4）注册事件。 onreadystatechange事件，状态改变时就会调用。</span></span></span><br><span class="line"><span class="actionscript">        <span class="comment">//如果要在数据完整请求回来的时候才调用，我们需要手动写一些判断的逻辑。</span></span></span><br><span class="line"><span class="actionscript">        ajaxObj.onreadystatechange = <span class="function"><span class="keyword">function</span> <span class="params">()</span> </span>&#123;</span></span><br><span class="line"><span class="actionscript">            <span class="comment">// 为了保证 数据 完整返回，我们一般会判断 两个值</span></span></span><br><span class="line"><span class="actionscript">            <span class="keyword">if</span> (ajaxObj.readyState == <span class="number">4</span> &amp;&amp; ajaxObj.status == <span class="number">200</span>) &#123;</span></span><br><span class="line"><span class="actionscript">                <span class="comment">// 如果能够进到这个判断 说明 数据 完美的回来了,并且请求的页面是存在的</span></span></span><br><span class="line"><span class="actionscript">                <span class="comment">// 5.在注册的事件中 获取 返回的 内容 并修改页面的显示</span></span></span><br><span class="line"><span class="javascript">                <span class="built_in">console</span>.log(<span class="string">'数据返回成功'</span>);</span></span><br><span class="line"></span><br><span class="line"><span class="actionscript">                <span class="comment">// 数据是保存在 异步对象的 属性中</span></span></span><br><span class="line"><span class="javascript">                <span class="built_in">console</span>.log(ajaxObj.responseText);</span></span><br><span class="line"></span><br><span class="line"><span class="actionscript">                <span class="comment">// 修改页面的显示</span></span></span><br><span class="line"><span class="javascript">                <span class="built_in">document</span>.querySelector(<span class="string">'h1'</span>).innerHTML = ajaxObj.responseText;</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p><code>post</code> 请求举例：</p>
</blockquote>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>Ajax 发送 get 请求<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">value</span>=<span class="string">"发送put_ajax请求"</span> <span class="attr">id</span>=<span class="string">'btnAjax'</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="actionscript">    <span class="comment">// 异步对象</span></span></span><br><span class="line"><span class="actionscript">    <span class="keyword">var</span> xhr = <span class="keyword">new</span> XMLHttpRequest();</span></span><br><span class="line"></span><br><span class="line"><span class="actionscript">    <span class="comment">// 设置属性</span></span></span><br><span class="line"><span class="actionscript">    xhr.open(<span class="string">'post'</span>, <span class="string">'02.post.php'</span>);</span></span><br><span class="line"></span><br><span class="line"><span class="actionscript">    <span class="comment">// 如果想要使用post提交数据,必须添加此行</span></span></span><br><span class="line"><span class="actionscript">    xhr.setRequestHeader(<span class="string">"Content-type"</span>, <span class="string">"application/x-www-form-urlencoded"</span>);</span></span><br><span class="line"></span><br><span class="line"><span class="actionscript">    <span class="comment">// 将数据通过send方法传递</span></span></span><br><span class="line"><span class="actionscript">    xhr.send(<span class="string">'name=fox&amp;age=18'</span>);</span></span><br><span class="line"></span><br><span class="line"><span class="actionscript">    <span class="comment">// 发送并接受返回值</span></span></span><br><span class="line"><span class="actionscript">    xhr.onreadystatechange = <span class="function"><span class="keyword">function</span> <span class="params">()</span> </span>&#123;</span></span><br><span class="line"><span class="actionscript">        <span class="comment">// 这步为判断服务器是否正确响应</span></span></span><br><span class="line"><span class="actionscript">        <span class="keyword">if</span> (xhr.readyState == <span class="number">4</span> &amp;&amp; xhr.status == <span class="number">200</span>) &#123;</span></span><br><span class="line">            alert(xhr.responseText);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="onreadystatechange-事件"><a href="#onreadystatechange-事件" class="headerlink" title="onreadystatechange 事件"></a>onreadystatechange 事件</h3><blockquote>
<p>注册 <code>onreadystatechange</code> 事件后，每当 <code>readyState</code> 属性改变时，就会调用 <code>onreadystatechange</code> 函数。</p>
</blockquote>
<blockquote>
<p><code>readyState</code>：（存有 <code>XMLHttpRequest</code> 的状态。从 <code>0</code> 到 <code>4</code> 发生变化）</p>
</blockquote>
<ul>
<li><code>0</code>: 请求未初始化</li>
<li><code>1</code>: 服务器连接已建立</li>
<li><code>2</code>: 请求已接收</li>
<li><code>3</code>: 请求处理中</li>
<li><code>4</code>: 请求已完成，且响应已就绪</li>
</ul>
<h3 id="事件的触发条件"><a href="#事件的触发条件" class="headerlink" title="事件的触发条件"></a>事件的触发条件</h3><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="/img/loading.gif" data-original="http://img.smyhvae.com/20180307_1443.png" alt title>
                </div>
                <div class="image-caption"></div>
            </figure>



<h3 id="事件的触发顺序"><a href="#事件的触发顺序" class="headerlink" title="事件的触发顺序"></a>事件的触发顺序</h3><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="/img/loading.gif" data-original="http://img.smyhvae.com/20180307_1445.png" alt title>
                </div>
                <div class="image-caption"></div>
            </figure>



<h3 id="实际开发中用的-原生Ajax请求"><a href="#实际开发中用的-原生Ajax请求" class="headerlink" title="实际开发中用的 原生Ajax请求"></a>实际开发中用的 原生Ajax请求</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">var</span> util = &#123;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//获取 ajax 请求之后的json</span></span><br><span class="line">util.json = <span class="function"><span class="keyword">function</span> (<span class="params">options</span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> opt = &#123;</span><br><span class="line">        url: <span class="string">''</span>,</span><br><span class="line">        type: <span class="string">'get'</span>,</span><br><span class="line">        data: &#123;&#125;,</span><br><span class="line">        success: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        &#125;,</span><br><span class="line">        error: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        &#125;,</span><br><span class="line"></span><br><span class="line">    &#125;;</span><br><span class="line">    util.extend(opt, options);</span><br><span class="line">    <span class="keyword">if</span> (opt.url) &#123;</span><br><span class="line">        <span class="comment">//IE兼容性处理：浏览器特征检查。检查该浏览器是否存在XMLHttpRequest这个api，没有的话，就用IE的api</span></span><br><span class="line">        <span class="keyword">var</span> xhr = XMLHttpRequest ? <span class="keyword">new</span> XMLHttpRequest() : <span class="keyword">new</span> <span class="built_in">window</span>.ActiveXObject(<span class="string">'Microsoft.XMLHTTP'</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> data = opt.data,</span><br><span class="line">            url = opt.url,</span><br><span class="line">            type = opt.type.toUpperCase();</span><br><span class="line">        dataArr = [];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> key <span class="keyword">in</span> data) &#123;</span><br><span class="line">        dataArr.push(key + <span class="string">'='</span> + data[key]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (type === <span class="string">'GET'</span>) &#123;</span><br><span class="line">        url = url + <span class="string">'?'</span> + dataArr.join(<span class="string">'&amp;'</span>);</span><br><span class="line">        xhr.open(type, url.replace(<span class="regexp">/\?$/g</span>, <span class="string">''</span>), <span class="literal">true</span>);</span><br><span class="line">        xhr.send();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (type === <span class="string">'POST'</span>) &#123;</span><br><span class="line">        xhr.open(type, url, <span class="literal">true</span>);</span><br><span class="line">        <span class="comment">// 如果想要使用post提交数据,必须添加此行</span></span><br><span class="line">        xhr.setRequestHeader(<span class="string">"Content-type"</span>, <span class="string">"application/x-www-form-urlencoded"</span>);</span><br><span class="line">        xhr.send(dataArr.join(<span class="string">'&amp;'</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    xhr.onload = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (xhr.status === <span class="number">200</span> || xhr.status === <span class="number">304</span>) &#123; <span class="comment">//304表示：用缓存即可。206表示获取媒体资源的前面一部分</span></span><br><span class="line">            <span class="keyword">var</span> res;</span><br><span class="line">            <span class="keyword">if</span> (opt.success &amp;&amp; opt.success <span class="keyword">instanceof</span> <span class="built_in">Function</span>) &#123;</span><br><span class="line">                res = xhr.responseText;</span><br><span class="line">                <span class="keyword">if</span> (<span class="keyword">typeof</span> res === <span class="string">'string'</span>) &#123;</span><br><span class="line">                    res = <span class="built_in">JSON</span>.parse(res);  <span class="comment">//将字符串转成json</span></span><br><span class="line">                    opt.success.call(xhr, res);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (opt.error &amp;&amp; opt.error <span class="keyword">instanceof</span> <span class="built_in">Function</span>) &#123;</span><br><span class="line">                opt.error.call(xhr, res);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>参考链接：</p>
<p><a href="http://www.runoob.com/ajax/ajax-tutorial.html" target="_blank" rel="noopener">http://www.runoob.com/ajax/ajax-tutorial.html</a></p>
<p><a href="http://3ms.huawei.com/km/blogs/details/5434911" target="_blank" rel="noopener">http://3ms.huawei.com/km/blogs/details/5434911</a></p>
<h2 id="4-json"><a href="#4-json" class="headerlink" title="4.json"></a>4.json</h2><h3 id="什么是-json"><a href="#什么是-json" class="headerlink" title="什么是 json"></a>什么是 json</h3><ul>
<li>JSON(JavaScript Object Notation) 是一种轻量级的数据交换格式</li>
<li>它是基于JavaScript的一个子集。数据格式简单, 易于读写, 占用带宽小</li>
<li>JSON字符串转换为JSON对象:</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">var obj =eval(&apos;(&apos;+ str +&apos;)&apos;);</span><br><span class="line">var obj = str.parseJSON();</span><br><span class="line">var obj = JSON.parse(str);</span><br></pre></td></tr></table></figure>

<ul>
<li>JSON对象转换为JSON字符串：</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">var last=obj.toJSONString();</span><br><span class="line">var last=JSON.stringify(obj);</span><br></pre></td></tr></table></figure>

<h3 id="json优点"><a href="#json优点" class="headerlink" title="json优点:"></a>json优点:</h3><ol>
<li>数据格式比较简单，易于读写，支持复合数据类型（数组、对象、字符串、数字）</li>
<li>轻量级，格式都是压缩的，占用带宽小</li>
<li>便于机器（JavaScript）解析, 客户端 javascript 可以简单的通过 eval()进行 JSON 数据的读取搜索</li>
<li>支持多种语言, 包括 ActionScript, C, C#, ColdFusion, Java, JavaScript, Perl, php, Python, Ruby 等语言服务器端语言, 便于服务器端的解析</li>
<li>在 PHP 世界, 已经有 PHP-JSON 和 JSON-PHP 出现了, 便于 PHP 序列化后的程序直接调用. PHP 服务器端的对象、数组等能够直接生 JSON 格式, 便于客户端的访问提取. 另外 PHP 的 PEAR 类已经提出了支持 (<a href="http://pear.php.net/pepr/pepr-proposal-show.php?id=198" target="_blank" rel="noopener">http://pear.php.net/pepr/pepr-proposal-show.php?id=198</a>)</li>
<li>因为 JSON 格式能够直接为服务器端代码使用, 大大简化了服务器端和客户端的代码开发量, 但是完成的任务不变, 且易于维护</li>
</ol>
<h3 id="json缺点"><a href="#json缺点" class="headerlink" title="json缺点:"></a>json缺点:</h3><ol>
<li>没有 XML 格式这么推广的深入人心和使用广泛, 没有 XML 那么通用性</li>
<li>JSON 格式目前在 Web Service 中推广还属于初级阶段 PS: 据说 Google 的 Ajax 是使用 JSON+模板 做的</li>
</ol>
<h3 id="XML和JSON的区别？"><a href="#XML和JSON的区别？" class="headerlink" title="XML和JSON的区别？"></a>XML和JSON的区别？</h3><ul>
<li>数据体积方面<ul>
<li>JSON相对于XML来讲，数据的体积小，传递的速度更快些。</li>
</ul>
</li>
<li>数据交互方面<ul>
<li>JSON与JavaScript的交互更加方便，更容易解析处理，更好的数据交互</li>
</ul>
</li>
<li>数据描述方面<ul>
<li>JSON对数据的描述性比XML较差</li>
</ul>
</li>
<li>传输速度方面<ul>
<li>JSON的速度要远远快于XML</li>
</ul>
</li>
</ul>
<h2 id="5-跨域"><a href="#5-跨域" class="headerlink" title="5.跨域"></a>5.跨域</h2><h3 id="如何解决跨域问题"><a href="#如何解决跨域问题" class="headerlink" title="如何解决跨域问题?"></a>如何解决跨域问题?</h3><p>jsonp、 iframe、window.name、window.postMessage、服务器上设置代理页面</p>
<h3 id="如何解决跨域问题-1"><a href="#如何解决跨域问题-1" class="headerlink" title="如何解决跨域问题?"></a>如何解决跨域问题?</h3><ol>
<li>jsonp ，允许 script 加载第三方资源</li>
<li>反向代理（nginx 服务内部配置 Access-Control-Allow-Origin *）</li>
<li>cors 前后端协作设置请求头部，Access-Control-Allow-Origin 等头部信息</li>
<li>iframe 嵌套通讯，postmessage</li>
</ol>
<p>解析：</p>
<p>理解跨域的概念：协议、域名、端口都相同才同域，否则都是跨域</p>
<p><a href="https://zhuanlan.zhihu.com/p/41479807" target="_blank" rel="noopener">参考</a><br><a href="http://www.ruanyifeng.com/blog/2016/04/cors.html" target="_blank" rel="noopener">跨域资源共享 CORS 阮一峰</a></p>
<h3 id="跨域通信的几种方式"><a href="#跨域通信的几种方式" class="headerlink" title="跨域通信的几种方式"></a>跨域通信的几种方式</h3><blockquote>
<p>方式如下：</p>
</blockquote>
<ol>
<li><code>JSONP</code></li>
<li><code>WebSocket</code></li>
<li><code>CORS</code></li>
<li><code>Hash</code></li>
<li><code>postMessage</code></li>
</ol>
<blockquote>
<p>上面这五种方式，在面试时，都要说出来。</p>
</blockquote>
<h3 id="5-1-JSONP"><a href="#5-1-JSONP" class="headerlink" title="5.1 JSONP"></a>5.1 JSONP</h3><blockquote>
<p>面试会问：<code>JSONP</code>的原理是什么？怎么实现的？</p>
</blockquote>
<ul>
<li>在<code>CORS</code>和<code>postMessage</code>以前，我们一直都是通过<code>JSONP</code>来做跨域通信的。</li>
</ul>
<blockquote>
<p><strong>JSONP的原理</strong>：通过<code>&lt;script&gt;</code>标签的异步加载来实现的。比如说，实际开发中，我们发现，<code>head</code>标签里，可以通过<code>&lt;script&gt;</code>标签的<code>src</code>，里面放<code>url</code>，加载很多在线的插件。这就是用到了<code>JSONP</code>。</p>
</blockquote>
<p><strong>JSONP的实现：</strong></p>
<blockquote>
<p>比如说，客户端这样写：</p>
</blockquote>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"http://www.smyhvae.com/?data=name&amp;callback=myjsonp"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>上面的<code>src</code>中，<code>data=name</code>是get请求的参数，<code>myjsonp</code>是和后台约定好的函数名。<br>服务器端这样写：</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">myjsonp(&#123;</span><br><span class="line">    data: &#123;&#125;</span><br><span class="line"></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>于是，本地要求创建一个<code>myjsonp</code> 的<strong>全局函数</strong>，才能将返回的数据执行出来。</p>
</blockquote>
<p><strong>实际开发中，前端的JSONP是这样实现的：</strong></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="actionscript">    <span class="keyword">var</span> util = &#123;&#125;;</span></span><br><span class="line"></span><br><span class="line"><span class="actionscript">    <span class="comment">//定义方法：动态创建 script 标签</span></span></span><br><span class="line">    /**</span><br><span class="line"><span class="javascript">     * [<span class="function"><span class="keyword">function</span> 在页面中注入<span class="title">js</span>脚本]</span></span></span><br><span class="line">     * @param  &#123;[type]&#125; url     [description]</span><br><span class="line">     * @param  &#123;[type]&#125; charset [description]</span><br><span class="line"><span class="actionscript">     * @<span class="keyword">return</span> &#123;[type]&#125;         [description]</span></span><br><span class="line">     */</span><br><span class="line"><span class="actionscript">    util.createScript = <span class="function"><span class="keyword">function</span> <span class="params">(url, charset)</span> </span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> script = <span class="built_in">document</span>.createElement(<span class="string">'script'</span>);</span></span><br><span class="line"><span class="actionscript">        script.setAttribute(<span class="string">'type'</span>, <span class="string">'text/javascript'</span>);</span></span><br><span class="line"><span class="actionscript">        charset &amp;&amp; script.setAttribute(<span class="string">'charset'</span>, charset);</span></span><br><span class="line"><span class="actionscript">        script.setAttribute(<span class="string">'src'</span>, url);</span></span><br><span class="line"><span class="actionscript">        script.async = <span class="literal">true</span>;</span></span><br><span class="line"><span class="actionscript">        <span class="keyword">return</span> script;</span></span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line"><span class="javascript">     * [<span class="function"><span class="keyword">function</span> 处理<span class="title">jsonp</span>]</span></span></span><br><span class="line">     * @param  &#123;[type]&#125; url      [description]</span><br><span class="line">     * @param  &#123;[type]&#125; onsucess [description]</span><br><span class="line">     * @param  &#123;[type]&#125; onerror  [description]</span><br><span class="line">     * @param  &#123;[type]&#125; charset  [description]</span><br><span class="line"><span class="actionscript">     * @<span class="keyword">return</span> &#123;[type]&#125;          [description]</span></span><br><span class="line">     */</span><br><span class="line"><span class="actionscript">    util.jsonp = <span class="function"><span class="keyword">function</span> <span class="params">(url, onsuccess, onerror, charset)</span> </span>&#123;</span></span><br><span class="line"><span class="actionscript">        <span class="keyword">var</span> callbackName = util.getName(<span class="string">'tt_player'</span>); <span class="comment">//事先约定好的 函数名</span></span></span><br><span class="line"><span class="javascript">        <span class="built_in">window</span>[callbackName] = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;      <span class="comment">//根据回调名称注册一个全局的函数</span></span></span><br><span class="line"><span class="actionscript">            <span class="keyword">if</span> (onsuccess &amp;&amp; util.isFunction(onsuccess)) &#123;</span></span><br><span class="line"><span class="javascript">                onsuccess(<span class="built_in">arguments</span>[<span class="number">0</span>]);</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line"><span class="actionscript">        <span class="keyword">var</span> script = util.createScript(url + <span class="string">'&amp;callback='</span> + callbackName, charset);   <span class="comment">//动态创建一个script标签</span></span></span><br><span class="line"><span class="actionscript">        script.onload = script.onreadystatechange = <span class="function"><span class="keyword">function</span> <span class="params">()</span> </span>&#123;   <span class="comment">//监听加载成功的事件，获取数据</span></span></span><br><span class="line"><span class="javascript">            <span class="keyword">if</span> (!script.readyState || <span class="regexp">/loaded|complete/</span>.test(script.readyState)) &#123;</span></span><br><span class="line"><span class="actionscript">                script.onload = script.onreadystatechange = <span class="literal">null</span>;</span></span><br><span class="line"><span class="actionscript">                <span class="comment">// 移除该script的 DOM 对象</span></span></span><br><span class="line"><span class="actionscript">                <span class="keyword">if</span> (script.parentNode) &#123;</span></span><br><span class="line">                    script.parentNode.removeChild(script);</span><br><span class="line">                &#125;</span><br><span class="line"><span class="actionscript">                <span class="comment">// 删除函数或变量</span></span></span><br><span class="line"><span class="javascript">                <span class="built_in">window</span>[callbackName] = <span class="literal">null</span>;  <span class="comment">//最后不要忘了删除</span></span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line"><span class="actionscript">        script.onerror = <span class="function"><span class="keyword">function</span> <span class="params">()</span> </span>&#123;</span></span><br><span class="line"><span class="actionscript">            <span class="keyword">if</span> (onerror &amp;&amp; util.isFunction(onerror)) &#123;</span></span><br><span class="line">                onerror();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line"><span class="javascript">        <span class="built_in">document</span>.getElementsByTagName(<span class="string">'head'</span>)[<span class="number">0</span>].appendChild(script); <span class="comment">//往html中增加这个标签，目的是把请求发送出去</span></span></span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="5-2-WebSocket"><a href="#5-2-WebSocket" class="headerlink" title="5.2 WebSocket"></a>5.2 WebSocket</h3><blockquote>
<p><code>WebSocket</code>的用法如下：</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> ws = <span class="keyword">new</span> WebSocket(<span class="string">'wss://echo.websocket.org'</span>); <span class="comment">//创建WebSocket的对象。参数可以是 ws 或 wss，后者表示加密。</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//把请求发出去</span></span><br><span class="line">ws.onopen = <span class="function"><span class="keyword">function</span> (<span class="params">evt</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'Connection open ...'</span>);</span><br><span class="line">    ws.send(<span class="string">'Hello WebSockets!'</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//对方发消息过来时，我接收</span></span><br><span class="line">ws.onmessage = <span class="function"><span class="keyword">function</span> (<span class="params">evt</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'Received Message: '</span>, evt.data);</span><br><span class="line">    ws.close();</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//关闭连接</span></span><br><span class="line">ws.onclose = <span class="function"><span class="keyword">function</span> (<span class="params">evt</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'Connection closed.'</span>);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>面试一般不会让你写这个代码，一般是考察你是否了解 <code>WebSocket</code>概念，知道有这么回事即可。</p>
</blockquote>
<h3 id="5-3-CORS"><a href="#5-3-CORS" class="headerlink" title="5.3 CORS"></a>5.3 CORS</h3><blockquote>
<p><code>CORS</code> 可以理解成是<strong>既可以同步、也可以异步</strong>的Ajax。</p>
</blockquote>
<ul>
<li>fetch<code>是一个比较新的</code>API<code>，用来实现</code>CORS`通信。用法如下：</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// url（必选），options（可选）</span></span><br><span class="line">fetch(<span class="string">'/some/url/'</span>, &#123;</span><br><span class="line">    method: <span class="string">'get'</span>,</span><br><span class="line">&#125;).then(<span class="function"><span class="keyword">function</span> (<span class="params">response</span>) </span>&#123;  <span class="comment">//类似于 ES6中的promise</span></span><br><span class="line"></span><br><span class="line">&#125;).catch(<span class="function"><span class="keyword">function</span> (<span class="params">err</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// 出错了，等价于 then 的第二个参数，但这样更好用更直观</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<blockquote>
<p>另外，如果面试官问：“CORS为什么支持跨域的通信？”</p>
</blockquote>
<blockquote>
<p>答案：跨域时，浏览器会拦截<code>Ajax</code>请求，并在<code>http</code>头中加<code>Origin</code>。</p>
</blockquote>
<h3 id="5-4-Hash"><a href="#5-4-Hash" class="headerlink" title="5.4 Hash"></a>5.4 Hash</h3><ul>
<li><code>url</code>的<code>#</code>后面的内容就叫<code>Hash</code>。<strong>Hash的改变，页面不会刷新</strong>。这就是用 <code>Hash</code> 做跨域通信的基本原理。</li>
</ul>
<blockquote>
<p>补充：<code>url</code>的<code>?</code>后面的内容叫<code>Search</code>。<code>Search</code>的改变，会导致页面刷新，因此不能做跨域通信。</p>
</blockquote>
<p><strong>使用举例：</strong></p>
<p><strong>场景</strong>：我的页面 <code>A</code> 通过<code>iframe</code>或<code>frame</code>嵌入了跨域的页面 <code>B</code>。</p>
<blockquote>
<p>现在，我这个<code>A</code>页面想给<code>B</code>页面发消息，怎么操作呢？</p>
</blockquote>
<ol>
<li>首先，在我的<code>A</code>页面中：</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//伪代码</span></span><br><span class="line"><span class="keyword">var</span> B = <span class="built_in">document</span>.getElementsByTagName(<span class="string">'iframe'</span>);</span><br><span class="line">B.src = B.src + <span class="string">'#'</span> + <span class="string">'jsonString'</span>;  <span class="comment">//我们可以把JS 对象，通过 JSON.stringify()方法转成 json字符串，发给 B</span></span><br></pre></td></tr></table></figure>

<ol start="2">
<li>然后，在<code>B</code>页面中：</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// B中的伪代码</span></span><br><span class="line"><span class="built_in">window</span>.onhashchange = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;  <span class="comment">//通过onhashchange方法监听，url中的 hash 是否发生变化</span></span><br><span class="line">    <span class="keyword">var</span> data = <span class="built_in">window</span>.location.hash;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h3 id="5-5-postMessage-方法"><a href="#5-5-postMessage-方法" class="headerlink" title="5.5 postMessage()方法"></a>5.5 postMessage()方法</h3><blockquote>
<p><code>H5</code>中新增的`postMessage()``方法，可以用来做跨域通信。既然是H5中新增的，那就一定要提到。</p>
</blockquote>
<p><strong>场景</strong>：窗口 A (<code>http:A.com</code>)向跨域的窗口 B (<code>http:B.com</code>)发送信息。步骤如下</p>
<ol>
<li>在<code>A</code>窗口中操作如下：向<code>B</code>窗口发送数据：</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 窗口A(http:A.com)向跨域的窗口B(http:B.com)发送信息</span></span><br><span class="line">	Bwindow.postMessage(<span class="string">'data'</span>, <span class="string">'http://B.com'</span>); <span class="comment">//这里强调的是B窗口里的window对象</span></span><br></pre></td></tr></table></figure>

<ol start="2">
<li>在<code>B</code>窗口中操作如下：</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 在窗口B中监听 message 事件</span></span><br><span class="line">Awindow.addEventListener(<span class="string">'message'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">event</span>) </span>&#123;   <span class="comment">//这里强调的是A窗口里的window对象</span></span><br><span class="line">    <span class="built_in">console</span>.log(event.origin);  <span class="comment">//获取 ：url。这里指：http://A.com</span></span><br><span class="line">    <span class="built_in">console</span>.log(event.source);  <span class="comment">//获取：A window对象</span></span><br><span class="line">    <span class="built_in">console</span>.log(event.data);    <span class="comment">//获取传过来的数据</span></span><br><span class="line">&#125;, <span class="literal">false</span>);</span><br></pre></td></tr></table></figure>

<h3 id="如何解决跨域问题-2"><a href="#如何解决跨域问题-2" class="headerlink" title="如何解决跨域问题"></a>如何解决跨域问题</h3><h6 id="JSONP："><a href="#JSONP：" class="headerlink" title="JSONP："></a><strong>JSONP：</strong></h6><ul>
<li>原理是：动态插入<code>script</code>标签，通过<code>script</code>标签引入一个<code>js</code>文件，这个<code>js</code>文件载入成功后会执行我们在<code>url</code>参数中指定的函数，并且会把我们需要的<code>json</code>数据作为参数传入</li>
<li>由于同源策略的限制，<code>XmlHttpRequest</code>只允许请求当前源（域名、协议、端口）的资源，为了实现跨域请求，可以通过<code>script</code>标签实现跨域请求，然后在服务端输出<code>JSON</code>数据并执行回调函数，从而解决了跨域的数据请求</li>
<li>优点是兼容性好，简单易用，支持浏览器与服务器双向通信。缺点是只支持GET请求</li>
<li><code>JSONP</code>：<code>json+padding</code>（内填充），顾名思义，就是把<code>JSON</code>填充到一个盒子里</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">createJs</span>(<span class="params">sUrl</span>)</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> oScript = <span class="built_in">document</span>.createElement(<span class="string">'script'</span>);</span><br><span class="line">    oScript.type = <span class="string">'text/javascript'</span>;</span><br><span class="line">    oScript.src = sUrl;</span><br><span class="line">    <span class="built_in">document</span>.getElementsByTagName(<span class="string">'head'</span>)[<span class="number">0</span>].appendChild(oScript);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">createJs(<span class="string">'jsonp.js'</span>);</span><br><span class="line"></span><br><span class="line">box(&#123;</span><br><span class="line">   <span class="string">'name'</span>: <span class="string">'test'</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">box</span>(<span class="params">json</span>)</span>&#123;</span><br><span class="line">    alert(json.name);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>CORS</strong></p>
<ul>
<li>服务器端对于<code>CORS</code>的支持，主要就是通过设置<code>Access-Control-Allow-Origin</code>来进行的。如果浏览器检测到相应的设置，就可以允许<code>Ajax</code>进行跨域的访问</li>
</ul>
<p><strong>通过修改document.domain来跨子域</strong></p>
<ul>
<li>将子域和主域的<code>document.domain</code>设为同一个主域.前提条件：这两个域名必须属于同一个基础域名!而且所用的协议，端口都要一致，否则无法利用<code>document.domain</code>进行跨域。主域相同的使用<code>document.domain</code></li>
</ul>
<p><strong>使用window.name来进行跨域</strong></p>
<ul>
<li><code>window</code>对象有个name属性，该属性有个特征：即在一个窗口(<code>window</code>)的生命周期内,窗口载入的所有的页面都是共享一个<code>window.name</code>的，每个页面对window.name都有读写的权限，<code>window.name</code>是持久存在一个窗口载入过的所有页面中的</li>
</ul>
<p><strong>使用HTML5中新引进的window.postMessage方法来跨域传送数据</strong></p>
<ul>
<li>还有<code>flash</code>、在服务器上设置代理页面等跨域方式。个人认为<code>window.name</code>的方法既不复杂，也能兼容到几乎所有浏览器，这真是极好的一种跨域方法</li>
</ul>
<p><strong>如何解决跨域问题?</strong></p>
<ul>
<li><code>jsonp</code>、 <code>iframe</code>、<code>window.name</code>、<code>window.postMessage</code>、服务器上设置代理页面</li>
<li>如何解决跨域问题?<ul>
<li><code>document.domain + iframe</code>：要求主域名相同 //只能跨子域</li>
<li><code>JSONP(JSON with Padding)``：</code>response: callback(data)`` //只支持 GET 请求</li>
<li>跨域资源共享<code>CORS(XHR2)``：</code>Access-Control-Allow` //兼容性 IE10+</li>
<li>跨文档消息传输(HTML5)：<code>postMessage + onmessage</code>  //兼容性 IE8+</li>
<li><code>WebSocket(HTML5)：new WebSocket(url) + onmessage</code> //兼容性 IE10+</li>
<li>服务器端设置代理请求：服务器端不受同源策略限制</li>
</ul>
</li>
</ul>
<h3 id="5-1-跨域"><a href="#5-1-跨域" class="headerlink" title="5.1 跨域"></a>5.1 跨域</h3><blockquote>
<p>很多种方法，但万变不离其宗，都是为了搞定同源策略。重用的有 <code>jsonp</code>、<code>iframe</code>、<code>cors</code>、<code>img</code>、H<code>TML5 postMessage</code>等等。其中用到 <code>html</code> 标签进行跨域的原理就是 <code>html</code> 不受同源策略影响。但只是接受 <code>Get</code> 的请求方式，这个得清楚。</p>
</blockquote>
<blockquote>
<p><strong>延伸1：img iframe script 来发送跨域请求有什么优缺点？</strong></p>
</blockquote>
<p><strong>1. <code>iframe</code></strong></p>
<ul>
<li>优点：跨域完毕之后<code>DOM</code>操作和互相之间的<code>JavaScript</code>调用都是没有问题的</li>
<li>缺点：1.若结果要以<code>URL</code>参数传递，这就意味着在结果数据量很大的时候需要分割传递，巨烦。2.还有一个是<code>iframe</code>本身带来的，母页面和<code>iframe</code>本身的交互本身就有安全性限制。</li>
</ul>
<p><strong>2. script</strong></p>
<ul>
<li>优点：可以直接返回<code>json</code>格式的数据，方便处理</li>
<li>缺点：只接受<code>GET</code>请求方式</li>
</ul>
<p><strong>3. 图片ping</strong></p>
<ul>
<li>优点：可以访问任何<code>url</code>，一般用来进行点击追踪，做页面分析常用的方法</li>
<li>缺点：不能访问响应文本，只能监听是否响应</li>
</ul>
<blockquote>
<p><strong>延伸2：配合 webpack 进行反向代理？</strong></p>
</blockquote>
<p><code>webpack</code> 在 <code>devServer</code> 选项里面提供了一个 <code>proxy</code> 的参数供开发人员进行反向代理</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">'/api'</span>: &#123;</span><br><span class="line">  target: <span class="string">'http://www.example.com'</span>, <span class="comment">// your target host</span></span><br><span class="line">  changeOrigin: <span class="literal">true</span>, <span class="comment">// needed for virtual hosted sites</span></span><br><span class="line">  pathRewrite: &#123;</span><br><span class="line">    <span class="string">'^/api'</span>: <span class="string">''</span>  <span class="comment">// rewrite path</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<blockquote>
<p>然后再配合 <code>http-proxy-middleware</code> 插件对 <code>api</code> 请求地址进行代理</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">'express'</span>);</span><br><span class="line"><span class="keyword">const</span> proxy = <span class="built_in">require</span>(<span class="string">'http-proxy-middleware'</span>);</span><br><span class="line"><span class="comment">// proxy api requests</span></span><br><span class="line"><span class="keyword">const</span> exampleProxy = proxy(options); <span class="comment">// 这里的 options 就是 webpack 里面的 proxy 选项对应的每个选项</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// mount `exampleProxy` in web server</span></span><br><span class="line"><span class="keyword">const</span> app = express();</span><br><span class="line">app.use(<span class="string">'/api'</span>, exampleProxy);</span><br><span class="line">app.listen(<span class="number">3000</span>);</span><br></pre></td></tr></table></figure>

<blockquote>
<p>然后再用 <code>nginx</code> 把允许跨域的源地址添加到报头里面即可</p>
</blockquote>
<blockquote>
<p>说到 <code>nginx</code> ，可以再谈谈 <code>CORS</code> 配置，大致如下</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">location / &#123;</span><br><span class="line">  <span class="keyword">if</span> ($request_method = <span class="string">'OPTIONS'</span>) &#123;</span><br><span class="line">    add_header <span class="string">'Access-Control-Allow-Origin'</span> <span class="string">'*'</span>;  </span><br><span class="line">    add_header <span class="string">'Access-Control-Allow-Methods'</span> <span class="string">'GET, POST, OPTIONS'</span>; </span><br><span class="line">    add_header <span class="string">'Access-Control-Allow-Credentials'</span> <span class="string">'true'</span>;</span><br><span class="line">    add_header <span class="string">'Access-Control-Allow-Headers'</span> <span class="string">'DNT, X-Mx-ReqToken, Keep-Alive, User-Agent, X-Requested-With, If-Modified-Since, Cache-Control, Content-Type'</span>;  </span><br><span class="line">    add_header <span class="string">'Access-Control-Max-Age'</span> <span class="number">86400</span>;  </span><br><span class="line">    add_header <span class="string">'Content-Type'</span> <span class="string">'text/plain charset=UTF-8'</span>;  </span><br><span class="line">    add_header <span class="string">'Content-Length'</span> <span class="number">0</span>;  </span><br><span class="line">    <span class="keyword">return</span> <span class="number">200</span>;  </span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="解释-jsonp-的原理，以及为什么不是真正的-ajax"><a href="#解释-jsonp-的原理，以及为什么不是真正的-ajax" class="headerlink" title="解释 jsonp 的原理，以及为什么不是真正的 ajax"></a>解释 jsonp 的原理，以及为什么不是真正的 ajax</h3><p>jsonp 是用来解决跨域获取数据的一种解决方案，具体是通过动态创建 script 标签，然后通过标签的 src 属性获取 js 文件中的 js 脚本，该脚本的内容是一个函数调用，参数就是服务器返回的数据，为了处理这些返回的数据，需要事先在页面定义好回调函数，本质上使用的并不是 ajax 技术</p>
<h3 id="jsonp-优缺点"><a href="#jsonp-优缺点" class="headerlink" title="jsonp 优缺点"></a>jsonp 优缺点</h3><p>优点</p>
<p>完美解决在测试或者开发中获取不同域下的数据,用户传递一个 callback 参数给服务端，然后服务端返回数据时会将这个 callback 参数作为函数名来包裹住 JSON 数据，这样客户端就可以随意定制自己的函数来自动处理<strong>返回数据了。简单来说数据的格式没有发生很大变化</strong></p>
<ul>
<li>它不像 XMLHttpRequest 对象实现的 Ajax 请求那样受到同源策略的限制，JSONP 可以跨越同源策略；</li>
<li>它的兼容性更好，在更加古老的浏览器中都可以运行，不需要 XMLHttpRequest 或 ActiveX 的支持</li>
<li>在请求完毕后可以通过调用 callback 的方式回传结果。将回调方法的权限给了调用方。这个就相当于将 controller 层和 view 层终于<em>分 开了。我提供的 jsonp 服务只提供纯服务的数据，至于提供服务以 后的页面渲染和后续 view 操作都由调用者来自己定义就好了。如果</em>有两个页面需要渲染同一份数据，你们只需要有不同的渲染逻辑就可以了，逻辑都可以使用同 一个 jsonp 服务。</li>
</ul>
<p>缺点</p>
<ul>
<li><p>它只支持 GET 请求而不支持 POST 等其它类型的 HTTP 请求，</p>
<p>也即是说如果想传给后台一个 json 格式的数据,此时问题就来了,浏览器会报一个 http 状态码 415 错误,告诉你请求格式不正确,这让我很蛋疼(在登录注册中需要给后台传一大串数据),如果都用参数的形式拼接在 url 后面的话不太现实,后台取值也会显得繁琐。</p>
</li>
<li><p>它只支持跨域 HTTP 请求这种情况，不能解决不同域的两个页面之间如何进行 JavaScript 调用的问题。</p>
</li>
<li><p>jsonp 在调用失败的时候不会返回各种 HTTP 状态码。</p>
</li>
<li><p>在登录模块中需要用到 session 来判断当前用户的登录状态,这时候由于是跨域的原因,前后台的取到的 session 是不一样的,那么就不能就行 session 来判断.</p>
</li>
<li><p>缺点是安全性。万一假如提供 jsonp 的服务存在页面注入漏洞，即它返回的 javascript 的内容被人控制的。那么结果是什么？所有调用这个 jsonp 的网站都会存在漏洞。于是无法把危险控制在一个域名下。所以在使用 jsonp 的时候必须要保证使用的 jsonp 服务必须是安全可信的</p>
<p>由于 jsonp 存在安全性问题(不知 qq 空间的跨域是怎么解决的,还是另有高招?)，后来考虑到上面的一系列问题,采用的是后台进行设置允许跨域请求(但还是存在缺陷的,实质上还是跨域,如上面说的 session 问题).Header set Access-Control-Allow-Origin</p>
<p>为了防止 XSS 攻击我们的服务器， 我们可以限制域，比如 Access-Control-Allow-Origin: <a href="http://blog.csdn.net" target="_blank" rel="noopener">http://blog.csdn.net</a></p>
</li>
</ul>
<h2 id="6-其他"><a href="#6-其他" class="headerlink" title="6.其他"></a>6.其他</h2><h3 id="同步和异步的区别"><a href="#同步和异步的区别" class="headerlink" title="同步和异步的区别?"></a>同步和异步的区别?</h3><p><strong>同步：阻塞的</strong></p>
<p>-张三叫李四去吃饭，李四一直忙得不停，张三一直等着，直到李四忙完两个人一块去吃饭</p>
<p>=浏览器向服务器请求数据，服务器比较忙，浏览器一直等着（页面白屏），直到服务器返回数据，浏览器才能显示页面</p>
<p><strong>异步：非阻塞的</strong></p>
<p>-张三叫李四去吃饭，李四在忙，张三说了一声然后自己就去吃饭了，李四忙完后自己去吃</p>
<p>=浏览器向服务器请求数据，服务器比较忙，浏览器可以自如的干原来的事情（显示页面），服务器返回数据的时候通知浏览器一声，浏览器把返回的数据再渲染到页面，局部更新</p>
<h3 id="异步加载和延迟加载"><a href="#异步加载和延迟加载" class="headerlink" title="异步加载和延迟加载"></a>异步加载和延迟加载</h3><p>1.异步加载的方案： 动态插入 script 标签</p>
<p>2.通过 ajax 去获取 js 代码，然后通过 eval 执行</p>
<p>3.script 标签上添加 defer 或者 async 属性</p>
<p>4.创建并插入 iframe，让它异步执行 js</p>
<p>5.延迟加载：有些 js 代码并不是页面初始化的时候就立刻需要的，而稍后的某些情况才需要的。</p>
<h3 id="一个页面从输入-URL-到页面加载显示完成，这个过程中都发生了什么？"><a href="#一个页面从输入-URL-到页面加载显示完成，这个过程中都发生了什么？" class="headerlink" title="一个页面从输入 URL 到页面加载显示完成，这个过程中都发生了什么？"></a>一个页面从输入 URL 到页面加载显示完成，这个过程中都发生了什么？</h3><p>1.浏览器地址栏输入 url</p>
<p>2.浏览器会先查看浏览器缓存–系统缓存–路由缓存，如有存在缓存，就直接显示。如果没有，接着第三步</p>
<p>3.域名解析（DNS）获取相应的 ip</p>
<p>4.浏览器向服务器发起 tcp 连接，与浏览器建立 tcp 三次握手</p>
<p>5.握手成功，浏览器向服务器发送 http 请求，请求数据包</p>
<p>6.服务器请求数据，将数据返回到浏览器</p>
<p>7.浏览器接收响应，读取页面内容，解析 html 源码，生成 DOm 树</p>
<p>8.解析 css 样式.浏览器渲染，js 交互绑定多个域名，数量不限；</p>
<h3 id="页面编码和被请求的资源编码如果不一致如何处理？"><a href="#页面编码和被请求的资源编码如果不一致如何处理？" class="headerlink" title="页面编码和被请求的资源编码如果不一致如何处理？"></a>页面编码和被请求的资源编码如果不一致如何处理？</h3><p>答案：get 请求中的中文需要 encodeURIComponent 编码处理，post 请求不需要进行编码</p>
<h3 id="Ajax-和-Fetch-区别"><a href="#Ajax-和-Fetch-区别" class="headerlink" title="Ajax 和 Fetch 区别"></a>Ajax 和 Fetch 区别</h3><ul>
<li>ajax 是使用 XMLHttpRequest 对象发起的，但是用起来很麻烦，所以 ES6 新规范就有了 fetch，fetch 发一个请求不用像 ajax 那样写一大堆代码。</li>
<li>使用 fetch 无法取消一个请求，这是因为 fetch 基于 Promise，而 Promise 无法做到这一点。</li>
<li>在默认情况下，fetch 不会接受或者发送 cookies</li>
<li>fetch 没有办法原生监测请求的进度，而 XMLHttpRequest 可以</li>
<li>fetch 只对网络请求报错，对 400，500 都当做成功的请求，需要封装去处理</li>
<li>fetch 由于是 ES6 规范，兼容性上比不上 XMLHttpRequest</li>
</ul>
<h3 id="XML-和-JSON-的区别？"><a href="#XML-和-JSON-的区别？" class="headerlink" title="XML 和 JSON 的区别？"></a>XML 和 JSON 的区别？</h3><ul>
<li>数据体积方面：JSON 相对于 XML 来讲，数据的体积小，传递的速度更快些。</li>
<li>数据交互方面：JSON 与 JavaScript 的交互更加方便，更容易解析处理，更好的数据交互。</li>
<li>数据描述方面：JSON 对数据的描述性比 XML 较差。</li>
<li>传输速度方面：JSON 的速度要远远快于 XML。</li>
</ul>
<h3 id="RESTful"><a href="#RESTful" class="headerlink" title="RESTful"></a>RESTful</h3><p>REST 指的是<strong>一组架构约束条件和原则</strong>。满足这些约束条件和原则的应用程序或设计就是 RESTful。</p>
<ul>
<li><p><strong>GET</strong></p>
<p>get 方法在 Rest 中主要用于获取资源，能够发送参数，不过有限制，且参数都会以?开头的形 式附加在 URL 尾部。<br>规范的 get 方法处理器应该是幂等的，也就是说对一个资源不论发送多少次 get 请求都不会更改数据或造成破坏。</p>
</li>
<li><p><strong>POST</strong><br>post 方法在 Rest 请求中主要用于添加资源，参数信息存放在请求报文的消息体中相对安全，且可发送较大信息</p>
</li>
<li><p><strong>PUT</strong><br>put 方法在 Rest 中主要用于更新资源，因为大多数浏览器不支持 put 和 delete，会自动将 put 和 delete 请求转化为 get 和 post. 因此为了使用 put 和 delete 方法,<br>需要以 post 发送请求，在表单中使用隐藏域发送真正的请求。<br>put 方法的参数是同 post 一样是存放在消息中的，同样具有安全性，可发送较大信息。<br>put 方法是幂等的，对同一 URL 资源做出的同一数据的任意次 put 请求其对数据的改变都是一致的。</p>
</li>
<li><p><strong>DELETE</strong><br>Delete 在 Rest 请求中主要用于删除资源，因为大多数浏览器不支持 put 和 delete，会自动将 put 和 delete 请求转化为 get 和 post。<br>因此为了使用 put 和 delete 方法,需要以 post 发送请求，在表单中使用隐藏域发送真正的请求。<br>Delete 方法的参数同 post 一样存放在消息体中,具有安全性，可发送较大信息 Delete 方法是幂等的，不论对同一个资源进行多少次 delete 请求都不会破坏数据</p>
</li>
</ul>
<p>解析：<a href="https://blog.csdn.net/jnshu_it/article/details/80203696" target="_blank" rel="noopener">参考</a></p>
<h3 id="withCredentials详细介绍"><a href="#withCredentials详细介绍" class="headerlink" title="withCredentials详细介绍"></a>withCredentials详细介绍</h3><p>withCredentials是一个布尔值，用于指定是否在跨域请求中发送身份凭据（如cookie，HTTP认证和客户端SSL证明），默认为false。</p>
<p>跨域请求通常被浏览器限制，因为它们可能会引发安全风险。浏览器将通常只向同域发送身份凭据。然而，有时候我们需要在跨域请求中发送身份凭据，以实现认证、授权或其他相关功能。</p>
<p>当withCredentials设置为true时，浏览器在发送跨域请求时会包含身份凭据。服务器必须正确配置CORS（跨域资源共享）以接受带有身份凭据的请求。如果服务器没有正确配置CORS，浏览器将拒绝响应。</p>
<p>下面是一个使用withCredentials的示例：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> xhr = <span class="keyword">new</span> XMLHttpRequest();</span><br><span class="line">xhr.withCredentials = <span class="literal">true</span>;</span><br><span class="line">xhr.open(<span class="string">'POST'</span>, <span class="string">'https://api.example.com/login'</span>, <span class="literal">true</span>);</span><br><span class="line">xhr.onreadystatechange = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (xhr.readyState === <span class="number">4</span> &amp;&amp; xhr.status === <span class="number">200</span>) &#123;</span><br><span class="line">    <span class="comment">// 处理响应</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line">xhr.send();</span><br></pre></td></tr></table></figure>

<p>在这个示例中，我们创建了一个XMLHttpRequest对象，并将withCredentials设置为true。然后，我们打开一个跨域请求，并监听xhr对象的onreadystatechange事件。当请求完成并成功时（readyState为4且status为200），我们可以处理响应。</p>
<p>请注意，在跨域请求中发送身份凭据可能会导致安全风险。确保只在必要的情况下使用withCredentials，并在服务器端正确配置CORS以确保安全性。</p>

        </div>

        <blockquote class="post-copyright">
    
    <div class="content">
        
<span class="post-time">
    最后更新时间：<time datetime="2023-12-25T08:44:40.000Z" itemprop="dateUpdated">2023-12-25 16:44:40</time>
</span><br>


        
        感谢您的阅读，欢迎评论(*^▽^*) 转载请附上本文链接：<a href="/qw8/knowledges/qian-duan-tong-xin.html" target="_blank" rel="external">https://qw8.github.io/qw8/knowledges/qian-duan-tong-xin.html</a>
        
    </div>
    
    <footer>
        <a href="https://qw8.github.io/qw8">
            <img src="/qw8/img/avatar.jpg" alt="秦伟">
            秦伟
        </a>
    </footer>
</blockquote>

        
<div class="page-reward">
    <a id="rewardBtn" href="javascript:;" class="page-reward-btn waves-effect waves-circle waves-light">赏</a>
</div>



        <div class="post-footer">
            
	<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/qw8/tags/Ajax/">Ajax</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/qw8/tags/JSON/">JSON</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/qw8/tags/同源策略/">同源策略</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/qw8/tags/异步/">异步</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/qw8/tags/跨域通信/">跨域通信</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/qw8/tags/通信方式/">通信方式</a></li></ul>


            
<div class="page-share-wrap">
    

<div class="page-share" id="pageShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://qw8.github.io/qw8/knowledges/qian-duan-tong-xin.html&title=《前端通信》 — 秦伟博客&pic=https://qw8.github.io/qw8/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://qw8.github.io/qw8/knowledges/qian-duan-tong-xin.html&title=《前端通信》 — 秦伟博客&source=前端、全栈、SEO的知识点、面试题与学习链接的整理" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://qw8.github.io/qw8/knowledges/qian-duan-tong-xin.html" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《前端通信》 — 秦伟博客&url=https://qw8.github.io/qw8/knowledges/qian-duan-tong-xin.html&via=https://qw8.github.io/qw8" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://qw8.github.io/qw8/knowledges/qian-duan-tong-xin.html" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>



    <a href="javascript:;" id="shareFab" class="page-share-fab waves-effect waves-circle">
        <i class="icon icon-share-alt icon-lg"></i>
    </a>
</div>



        </div>
    </div>

    
<nav class="post-nav flex-row flex-justify-between">
  
    <div class="waves-block waves-effect prev">
      <a href="/qw8/interview/qian-duan-jian-li.html" id="post-prev" class="post-nav-link">
        <div class="tips"><i class="icon icon-angle-left icon-lg icon-pr"></i> Prev</div>
        <h4 class="title">前端简历</h4>
      </a>
    </div>
  

  
    <div class="waves-block waves-effect next">
      <a href="/qw8/knowledges/qian-duan-xin-ji-zhu.html" id="post-next" class="post-nav-link">
        <div class="tips">Next <i class="icon icon-angle-right icon-lg icon-pl"></i></div>
        <h4 class="title">前端新技术</h4>
      </a>
    </div>
  
</nav>



    











    <!-- Valine Comments -->
    <div class="comments vcomment" id="comments"></div>
    <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
    <script src="//unpkg.com/valine@latest/dist/Valine.min.js"></script>
    <!-- Valine Comments script -->
    <script>
        var GUEST_INFO = ['nick','mail','link'];
        var guest_info = 'nick,mail,link'.split(',').filter(function(item){
          return GUEST_INFO.indexOf(item) > -1
        });
        new Valine({
            el: '#comments',
            notify: 'false' == 'true',
            verify: 'false' == 'true',
            appId: "TJ17Ax10JrfIIljlO8qkwGvz-gzGzoHsz",
            appKey: "jDGQKdWT9hlzsTLRAbInE4bK",
            avatar: "mm",
            placeholder: "说点什么吧(*╹▽╹*)",
            guest_info: guest_info.length == 0 ? GUEST_INFO : guest_info,
            pageSize: "10"
        })
    </script>
    <!-- Valine Comments end -->










</article>

<div id="reward" class="page-modal reward-lay">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <h3 class="reward-title">
        <i class="icon icon-quote-left"></i>
        谢谢您，我会继续努力哒(*^▽^*)
        <i class="icon icon-quote-right"></i>
    </h3>
    <div class="reward-content">
        
        <div class="reward-code">
            <img id="rewardCode" src="/qw8/img/wechat.png" alt="打赏二维码">
        </div>
        
        <label class="reward-toggle">
            <input id="rewardToggle" type="checkbox" class="reward-toggle-check"
                data-wechat="/qw8/img/wechat.png" data-alipay="/qw8/img/alipay.jpg">
            <div class="reward-toggle-ctrol">
                <span class="reward-toggle-item wechat">微信</span>
                <span class="reward-toggle-label"></span>
                <span class="reward-toggle-item alipay">支付宝</span>
            </div>
        </label>
        
    </div>
</div>



</div>

    <footer class="footer">
    <div class="top">
        <div class="map">
            <!--地球信息-->
<script type="text/javascript" src="/js/jquery-3.4.1.js"></script>
<script type="text/javascript">
    var windowWidth = $(window).width();
    if (windowWidth > 480) {
        document.write('<script type="text/javascript" src="//rf.revolvermaps.com/0/0/8.js?i=5mz4gy0w2d8&amp;m=0&amp;c=ff0000&amp;cr1=ffffff&amp;f=arial&amp;l=33" async="async">  <\/script>');
    }
</script>
        </div>
        <p>
<p>
    <span id="busuanzi_container_site_uv" style='display:none'>
        站点总访客数：<span id="busuanzi_value_site_uv"></span>
    </span>
    <span id="busuanzi_container_site_pv" style='display:none'>
        站点总访问量：<span id="busuanzi_value_site_pv"></span>
    </span>
</p>

</p>
        <p>
            <span>本网站总字数：832.3k</span>
            <span id="sitetime"></span>
        </p>
        <p>部分内容来源于互联网，用于个人知识的总结，如有侵权还请联系删除</p>
        <p>
            
            <span><a href="/qw8/atom.xml" target="_blank" class="rss" title="rss"><i
                    class="icon icon-lg icon-rss"></i></a></span>
            
            <span>博客内容遵循 <a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh">知识共享 署名 - 非商业性 - 相同方式共享 4.0 国际协议</a></span>
        </p>
    </div>

    <div class="bottom">
        <p>
            <span>Copyright &copy; 2019 - 2024 <a
                href="http://pdouyin.com/" target="_blank">秦伟的个人博客</a> All Rights Reserved.</span>
            <!-- <span>
                
                
            </span> -->
        </p>
    </div>
</footer>

<script language=javascript>
    function siteTime() {
        window.setTimeout("siteTime()", 1000);
        var seconds = 1000;
        var minutes = seconds * 60;
        var hours = minutes * 60;
        var days = hours * 24;
        var years = days * 365;
        var today = new Date();
        var todayYear = today.getFullYear();
        var todayMonth = today.getMonth() + 1;
        var todayDate = today.getDate();
        var todayHour = today.getHours();
        var todayMinute = today.getMinutes();
        var todaySecond = today.getSeconds();
        /* Date.UTC() -- 返回date对象距世界标准时间(UTC)1970年1月1日午夜之间的毫秒数(时间戳)
        year - 作为date对象的年份，为4位年份值
        month - 0-11之间的整数，做为date对象的月份
        day - 1-31之间的整数，做为date对象的天数
        hours - 0(午夜24点)-23之间的整数，做为date对象的小时数
        minutes - 0-59之间的整数，做为date对象的分钟数
        seconds - 0-59之间的整数，做为date对象的秒数
        microseconds - 0-999之间的整数，做为date对象的毫秒数 */
        var t1 = Date.UTC(2019, 8, 25, 18, 0, 0); // 北京时间
        var t2 = Date.UTC(todayYear, todayMonth, todayDate, todayHour, todayMinute, todaySecond);
        var diff = t2 - t1;
        var diffYears = Math.floor(diff / years);
        var diffDays = Math.floor((diff / days) - diffYears * 365);
        var diffHours = Math.floor((diff - (diffYears * 365 + diffDays) * days) / hours);
        var diffMinutes = Math.floor((diff - (diffYears * 365 + diffDays) * days - diffHours * hours) / minutes);
        var diffSeconds = Math.floor((diff - (diffYears * 365 + diffDays) * days - diffHours * hours - diffMinutes * minutes) / seconds);
        document.getElementById("sitetime").innerHTML = "已安全运行 " + diffYears + "年 " + diffDays + "天 " + diffHours + "小时 " + diffMinutes + "分钟 " + diffSeconds + "秒";
    }
    siteTime();
</script>
</main>
<div class="mask" id="mask"></div>
<a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a>



<div class="global-share" id="globalShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://qw8.github.io/qw8/knowledges/qian-duan-tong-xin.html&title=《前端通信》 — 秦伟博客&pic=https://qw8.github.io/qw8/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://qw8.github.io/qw8/knowledges/qian-duan-tong-xin.html&title=《前端通信》 — 秦伟博客&source=前端、全栈、SEO的知识点、面试题与学习链接的整理" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://qw8.github.io/qw8/knowledges/qian-duan-tong-xin.html" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《前端通信》 — 秦伟博客&url=https://qw8.github.io/qw8/knowledges/qian-duan-tong-xin.html&via=https://qw8.github.io/qw8" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://qw8.github.io/qw8/knowledges/qian-duan-tong-xin.html" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>


<div class="page-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>扫一扫，分享到微信</p>
    <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMYAAADGCAAAAACs8KCBAAACLklEQVR42u3aQa7bMAwFwNz/0um6KOy+J6YfDT1aBUEsa7IgSIqvV7zewfrz9/e7XX2+f3a0MDAwvpaRHC75vj30/dvzs2FgYDyH0b7+inH1TRsz87NhYGBgJAncGeZ+fwwMDIx5wL1P8vJS9ixYY2BgPJORFJOTl9035n60FsfAwPhCRl5e/vznf3K/gYGB8VWMd7mSS4LkLfOT/LYbBgbGakYe4NrkbJJctufBwMB4GqMNuDnyrGGXP4uBgbGbcb9Fvl3b6J8Xt3/pHWJgYKxgtIdIAnQexNuRjss/HQMDYzVj0hr71CVoW8pG5S4GBsY6xmcbZ21mehb0o7wVAwNjHaMdt8qvCtow2v6JGBgYT2MksLaT145ZtMkoBgbGbkbb3soP2l5ztn9HNGaBgYGxjtEWnMXA1lEgLoYtMDAwVjPacjRvkLUpYNvCi2pxDAyMFYwkXZsMSXw4pF49hYGBsZqRjz7Mhy3apLBu9mFgYKxmTK4qJy87a9vVAAwMjBWMSRp3NvKVpJJtOY2BgfEExlmSl7fS2jZcnVxiYGA8gJGPSiSBNb8keJXr8ikMDIyljHe58hJ30iZrryIwMDB2MyZNtzauT4Y5JtecGBgYOxhJ0MwbZ2ctuWT/oojFwMBYypgHvvw3+WBHXYtjYGBgHB3x7EK0pmJgYGCUzbLDo5R7fjg1xMDA+O8ZSerWtvvbUbOzITMMDIwnMOYhb94sa1PP0f0GBgbGNzF+AYQyk2F2WkHfAAAAAElFTkSuQmCC" alt="微信分享二维码">
</div>




<script src="//cdn.bootcss.com/node-waves/0.7.4/waves.min.js"></script>
<script>
var BLOG = { ROOT: '/qw8/', SHARE: true, REWARD: true };


</script>

<script src="/qw8/js/main.min.js?v=1.7.2"></script>


<div class="search-panel" id="search-panel">
    <ul class="search-result" id="search-result"></ul>
</div>
<template id="search-tpl">
<li class="item">
    <a href="{path}" class="waves-block waves-effect">
        <div class="title ellipsis" title="{title}">{title}</div>
        <div class="flex-row flex-middle">
            <div class="tags ellipsis">
                {tags}
            </div>
            <time class="flex-col time">{date}</time>
        </div>
    </a>
</li>
</template>

<script src="/qw8/js/search.min.js?v=1.7.2" async></script>



<!-- mathjax config similar to math.stackexchange -->

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';
    }
});
</script>

<script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" async></script>




<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>



<script>
(function() {
    var OriginTitile = document.title, titleTime;
    document.addEventListener('visibilitychange', function() {
        if (document.hidden) {
            document.title = '(つェ⊂)咦!跑去哪里了';
            clearTimeout(titleTime);
        } else {
            document.title = '欢迎回来━(*｀∀´*)ノ';
            titleTime = setTimeout(function() {
                document.title = OriginTitile;
            },2000);
        }
    });
})();
</script>




<!-- 点击特效 -->
<script type="text/javascript" src="/js/clicklove.js"></script>
<!--动态线条背景-->
<script type="text/javascript"
        color="220,220,220" opacity='0.7' zIndex="-2" count="200"
        src="//cdn.bootcss.com/canvas-nest.js/1.0.0/canvas-nest.min.js">
</script>
<!-- 雪花特效 -->
<script type="text/javascript" src="/js/jquery-3.4.1.js"></script>
<script type="text/javascript">
    var windowWidth = $(window).width();
    if (windowWidth > 480) {
        document.write('<script type="text/javascript" src="/js/snow.js"><\/script>');
    }
</script>

<script>!function(e){var r=Array.prototype.slice.call(document.querySelectorAll("img[data-original]"));function t(){for(var c=0;c<r.length;c++)t=r[c],void 0,0<=(n=t.getBoundingClientRect()).top&&0<=n.left&&n.top<=(e.innerHeight||document.documentElement.clientHeight)&&function(){var t,n,e,i,o=r[c];t=o,n=function(){r=r.filter(function(t){return o!==t})},e=new Image,i=t.getAttribute("data-original"),e.onload=function(){t.src=i,n&&n()},e.src=i}();var t,n}t(),e.addEventListener("scroll",function(){!function(t,n){clearTimeout(t.tId),t.tId=setTimeout(function(){t.call(n)},500)}(t,e)})}(this);</script><script src="/qw8/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"model":{"scale":1,"hHeadPos":0.5,"vHeadPos":0.618,"jsonPath":"/qw8/live2dw/assets/tororo.model.json"},"display":{"superSample":2,"position":"right","width":150,"height":300,"hOffset":-25,"vOffset":30},"mobile":{"show":false,"scale":1.2},"react":{"opacityDefault":0.7,"opacityOnHover":0.2},"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script></body>
</html>
