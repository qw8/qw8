<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.9.0">
    

    

    



    <meta charset="utf-8">
    
    
    
    
    <title>uniapp | 秦伟博客 | 前端、全栈、SEO的知识点、面试题与学习链接的整理</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    <meta name="theme-color" content="#3F51B5">
    
    
    <meta name="keywords" content="uni-app,小程序">
    <meta name="description" content="小技巧右击“新建页面“可以直接创建xx文件夹和xx.vue并配置好pages.json，可以自定义模板如下： 123456789101112131415161718192021&amp;lt;template&amp;gt;    &amp;lt;view&amp;gt;    &amp;lt;/view&amp;gt;&amp;lt;/template&amp;gt;&amp;lt;script&amp;gt;export default &amp;#123;    data()">
<meta name="keywords" content="uni-app,小程序">
<meta property="og:type" content="article">
<meta property="og:title" content="uniapp">
<meta property="og:url" content="https://qw8.github.io/knowledges/uniapp.html">
<meta property="og:site_name" content="秦伟博客">
<meta property="og:description" content="小技巧右击“新建页面“可以直接创建xx文件夹和xx.vue并配置好pages.json，可以自定义模板如下： 123456789101112131415161718192021&amp;lt;template&amp;gt;    &amp;lt;view&amp;gt;    &amp;lt;/view&amp;gt;&amp;lt;/template&amp;gt;&amp;lt;script&amp;gt;export default &amp;#123;    data()">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="https://qw8.github.io/img/loading.gif">
<meta property="og:updated_time" content="2024-03-31T16:10:54.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="uniapp">
<meta name="twitter:description" content="小技巧右击“新建页面“可以直接创建xx文件夹和xx.vue并配置好pages.json，可以自定义模板如下： 123456789101112131415161718192021&amp;lt;template&amp;gt;    &amp;lt;view&amp;gt;    &amp;lt;/view&amp;gt;&amp;lt;/template&amp;gt;&amp;lt;script&amp;gt;export default &amp;#123;    data()">
<meta name="twitter:image" content="https://qw8.github.io/img/loading.gif">
    
        <link rel="alternate" type="application/atom+xml" title="秦伟博客" href="/atom.xml">
    
    <link rel="shortcut icon" href="/img/qw.ico">
    <link rel="stylesheet" href="/css/style.css?v=1.7.2">
    <script>window.lazyScripts=[]</script>

    <!-- custom head -->
    

</head>

<body>
<div id="loading" class="active"></div>

<aside id="menu" class="hide" >
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-close"></i>
    </a>
    <div class="brand-wrap" style="background-image:url(/img/brand.jpg)">
      <div class="brand">
        <a href="/" class="avatar waves-effect waves-circle waves-light">
          <img src="/img/avatar.jpg">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname">秦伟</h5>
          <a href="mailto:124729081@qq.com" title="124729081@qq.com" class="mail">124729081@qq.com</a>
        </hgroup>
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
            <li class="waves-block waves-effect">
              <a href="/"  >
                <i class="icon icon-lg icon-home"></i>
                主页
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/categories"  >
                <i class="icon icon-lg icon-th-list"></i>
                分类
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/tags"  >
                <i class="icon icon-lg icon-tags"></i>
                标签
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/archives"  >
                <i class="icon icon-lg icon-hourglass"></i>
                时光
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="http://wpa.qq.com/msgrd?v=3&uin=124729081&site=qq&menu=yes" target="_blank" >
                <i class="icon icon-lg icon-qq"></i>
                聊天
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&email=124729081@qq.com"  >
                <i class="icon icon-lg icon-envelope-o"></i>
                邮箱
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/user"  >
                <i class="icon icon-lg icon-user"></i>
                简介
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://gitee.com/qw66" target="_blank" >
                <i class="icon icon-lg icon-code"></i>
                Gitee
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://github.com/qw8" target="_blank" >
                <i class="icon icon-lg icon-github"></i>
                Github
              </a>
            </li>
        
      </ul>
    </div>
  </div>
</aside>

<main id="main">
    <header class="top-header" id="header">
    <div class="flex-row">
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">uniapp</div>
        
        <div class="search-wrap" id="search-wrap">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="back">
                <i class="icon icon-lg icon-chevron-left"></i>
            </a>
            <input type="text" id="key" class="search-input" autocomplete="off" placeholder="输入感兴趣的关键字">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="search">
                <i class="icon icon-lg icon-search"></i>
            </a>
        </div>
        
        
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menuShare">
            <i class="icon icon-lg icon-share-alt"></i>
        </a>
        
    </div>
</header>
<header class="content-header post-header">

    <div class="container fade-scale">
        <h1 class="title">uniapp</h1>
        <h5 class="subtitle">
            
                <time datetime="2023-04-25T10:03:10.000Z" itemprop="datePublished" class="page-time">
  2023-04-25
</time>


	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/前端知识点/">前端知识点</a></li></ul>

            
        </h5>
    </div>

    


</header>


<div class="container body-wrap">
    
    <aside class="post-widget">
        <nav class="post-toc-wrap post-toc-shrink" id="post-toc">
            <h4>TOC</h4>
            <ol class="post-toc"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#小技巧"><span class="post-toc-number">1.</span> <span class="post-toc-text">小技巧</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#小问题"><span class="post-toc-number">2.</span> <span class="post-toc-text">小问题</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#uniapp创建步骤"><span class="post-toc-number">3.</span> <span class="post-toc-text">uniapp创建步骤</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#uniapp运行步骤"><span class="post-toc-number">4.</span> <span class="post-toc-text">uniapp运行步骤</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#uniapp公共图片路径封装及使用"><span class="post-toc-number">5.</span> <span class="post-toc-text">uniapp公共图片路径封装及使用</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#方法1-使用Vue-prototype，每个页改动代码较少，推荐使用"><span class="post-toc-number">5.1.</span> <span class="post-toc-text">方法1.使用Vue.prototype，每个页改动代码较少，推荐使用</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#方法2-只使用config，缺点：每个页改动代码较多"><span class="post-toc-number">5.2.</span> <span class="post-toc-text">方法2.只使用config，缺点：每个页改动代码较多</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#success内部不写-this简化代码"><span class="post-toc-number">6.</span> <span class="post-toc-text">success内部不写_this简化代码</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#await可以获取函数返回值"><span class="post-toc-number">7.</span> <span class="post-toc-text">await可以获取函数返回值</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#uniapp中使用calc计算的坑"><span class="post-toc-number">8.</span> <span class="post-toc-text">uniapp中使用calc计算的坑</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#uni-app-部署-H5-到相对路径（含file协议打开）"><span class="post-toc-number">9.</span> <span class="post-toc-text">uni-app 部署 H5 到相对路径（含file协议打开）</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#使用方式"><span class="post-toc-number">9.1.</span> <span class="post-toc-text">使用方式</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#注意事项"><span class="post-toc-number">9.2.</span> <span class="post-toc-text">注意事项</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#uniapp阻止遮罩滚动穿透"><span class="post-toc-number">10.</span> <span class="post-toc-text">uniapp阻止遮罩滚动穿透</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#填入字符不能包含-lt-gt-（防止xss攻击）"><span class="post-toc-number">11.</span> <span class="post-toc-text">填入字符不能包含&lt;&gt;/（防止xss攻击）</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#全屏播放视频"><span class="post-toc-number">12.</span> <span class="post-toc-text">全屏播放视频</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#每日登录领红包"><span class="post-toc-number">13.</span> <span class="post-toc-text">每日登录领红包</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#防止多次提交或点击"><span class="post-toc-number">14.</span> <span class="post-toc-text">防止多次提交或点击</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#返回顶部按钮"><span class="post-toc-number">15.</span> <span class="post-toc-text">返回顶部按钮</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#跳转页面传对象"><span class="post-toc-number">16.</span> <span class="post-toc-text">跳转页面传对象</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#uniapp保存网络图片"><span class="post-toc-number">17.</span> <span class="post-toc-text">uniapp保存网络图片</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#gitignore文件忽略提交unpackage包到github仓库（uni-app）"><span class="post-toc-number">18.</span> <span class="post-toc-text">.gitignore文件忽略提交unpackage包到github仓库（uni-app）</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#uni-app把canvas的px像素使用rpx表示"><span class="post-toc-number">19.</span> <span class="post-toc-text">uni-app把canvas的px像素使用rpx表示</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#canvas绘制多行文本自动换行"><span class="post-toc-number">20.</span> <span class="post-toc-text">canvas绘制多行文本自动换行</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#canvas设置字间距（真机不生效）、文字加粗"><span class="post-toc-number">21.</span> <span class="post-toc-text">canvas设置字间距（真机不生效）、文字加粗</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#文字地址使用微信内置地图查看位置"><span class="post-toc-number">22.</span> <span class="post-toc-text">文字地址使用微信内置地图查看位置</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#开启小程序在前后台时均可接收位置消息"><span class="post-toc-number">23.</span> <span class="post-toc-text">开启小程序在前后台时均可接收位置消息</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#js计算两个经纬度点之间距离"><span class="post-toc-number">24.</span> <span class="post-toc-text">js计算两个经纬度点之间距离</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#js计算多个经纬度点之间距离"><span class="post-toc-number">25.</span> <span class="post-toc-text">js计算多个经纬度点之间距离</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#小程序地图画路线测试结果"><span class="post-toc-number">26.</span> <span class="post-toc-text">小程序地图画路线测试结果</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#小程序其他样式需覆盖地图"><span class="post-toc-number">27.</span> <span class="post-toc-text">小程序其他样式需覆盖地图</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#地图选点"><span class="post-toc-number">28.</span> <span class="post-toc-text">地图选点</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#地图高度动态调整"><span class="post-toc-number">29.</span> <span class="post-toc-text">地图高度动态调整</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#小程序拖拽排序"><span class="post-toc-number">30.</span> <span class="post-toc-text">小程序拖拽排序</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#uniapp小程序用deep重写组件样式不生效"><span class="post-toc-number">31.</span> <span class="post-toc-text">uniapp小程序用deep重写组件样式不生效</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#去掉按钮默认边框"><span class="post-toc-number">32.</span> <span class="post-toc-text">去掉按钮默认边框</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#input组件样式问题"><span class="post-toc-number">33.</span> <span class="post-toc-text">input组件样式问题</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#v-for循环将index带入class属性中"><span class="post-toc-number">34.</span> <span class="post-toc-text">v-for循环将index带入class属性中</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#自定义导航"><span class="post-toc-number">35.</span> <span class="post-toc-text">自定义导航</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#getSavedFileList返回fileList为空"><span class="post-toc-number">36.</span> <span class="post-toc-text">getSavedFileList返回fileList为空</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#小程序使用downloadFile和saveFile-保存文件在本机找不到文件？"><span class="post-toc-number">37.</span> <span class="post-toc-text">小程序使用downloadFile和saveFile()保存文件在本机找不到文件？</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#文件下载"><span class="post-toc-number">38.</span> <span class="post-toc-text">文件下载</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#微信小程序预览文件"><span class="post-toc-number">39.</span> <span class="post-toc-text">微信小程序预览文件</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#uniapp-子组件监听页面onShow"><span class="post-toc-number">40.</span> <span class="post-toc-text">uniapp 子组件监听页面onShow</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#组件中从本地目录文件判断列表文件是否已下载"><span class="post-toc-number">41.</span> <span class="post-toc-text">组件中从本地目录文件判断列表文件是否已下载</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#JS中find方法"><span class="post-toc-number">42.</span> <span class="post-toc-text">JS中find方法</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#小程序onShareTimeline-分享朋友圈"><span class="post-toc-number">43.</span> <span class="post-toc-text">小程序onShareTimeline()分享朋友圈</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#无法通过自己的按钮触发“分享到朋友圈”和“收藏”"><span class="post-toc-number">44.</span> <span class="post-toc-text">无法通过自己的按钮触发“分享到朋友圈”和“收藏”</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#标签切换"><span class="post-toc-number">45.</span> <span class="post-toc-text">标签切换</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#搜索历史保存"><span class="post-toc-number">46.</span> <span class="post-toc-text">搜索历史保存</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#图片懒加载"><span class="post-toc-number">47.</span> <span class="post-toc-text">图片懒加载</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#关键词精准匹配高亮"><span class="post-toc-number">48.</span> <span class="post-toc-text">关键词精准匹配高亮</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#uniapp获取元素高度"><span class="post-toc-number">49.</span> <span class="post-toc-text">uniapp获取元素高度</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#滚动到指定元素"><span class="post-toc-number">50.</span> <span class="post-toc-text">滚动到指定元素</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#监听用户滑动页面事件，判断当前页码"><span class="post-toc-number">51.</span> <span class="post-toc-text">监听用户滑动页面事件，判断当前页码</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#微信小程序单独设置右上角胶囊颜色"><span class="post-toc-number">52.</span> <span class="post-toc-text">微信小程序单独设置右上角胶囊颜色</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#判断是在朋友圈打开"><span class="post-toc-number">53.</span> <span class="post-toc-text">判断是在朋友圈打开</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#分包机制"><span class="post-toc-number">54.</span> <span class="post-toc-text">分包机制</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#小程序自动更新"><span class="post-toc-number">55.</span> <span class="post-toc-text">小程序自动更新</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#uniapp-request中post传递数组值的时候，数组没有正确的被传递"><span class="post-toc-number">56.</span> <span class="post-toc-text">uniapp request中post传递数组值的时候，数组没有正确的被传递</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#自定义导航栏透明渐变色"><span class="post-toc-number">57.</span> <span class="post-toc-text">自定义导航栏透明渐变色</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#页面最小高度各平台保持一致"><span class="post-toc-number">58.</span> <span class="post-toc-text">页面最小高度各平台保持一致</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#节流函数（防止重复提交）"><span class="post-toc-number">59.</span> <span class="post-toc-text">节流函数（防止重复提交）</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#思路2-前端：不允许二次或多次点击"><span class="post-toc-number">59.0.1.</span> <span class="post-toc-text">思路2. 前端：不允许二次或多次点击</span></a></li></ol></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#uniapp弹窗蒙层禁止滚动穿透滚动底层页面"><span class="post-toc-number">60.</span> <span class="post-toc-text">uniapp弹窗蒙层禁止滚动穿透滚动底层页面</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#setInterval"><span class="post-toc-number">61.</span> <span class="post-toc-text">setInterval</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#小程序首页onUnload中无法请求接口"><span class="post-toc-number">62.</span> <span class="post-toc-text">小程序首页onUnload中无法请求接口</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#原生微信小程序转uniapp每个页面修改步骤"><span class="post-toc-number">63.</span> <span class="post-toc-text">原生微信小程序转uniapp每个页面修改步骤</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#vue移动端转uniapp每个页面修改步骤"><span class="post-toc-number">64.</span> <span class="post-toc-text">vue移动端转uniapp每个页面修改步骤</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#uniapp使用toast提示进行表单校验"><span class="post-toc-number">65.</span> <span class="post-toc-text">uniapp使用toast提示进行表单校验</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#控制输入框是否自动聚焦"><span class="post-toc-number">66.</span> <span class="post-toc-text">控制输入框是否自动聚焦</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#输入框聚焦页面置顶"><span class="post-toc-number">67.</span> <span class="post-toc-text">输入框聚焦页面置顶</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#使用JSON-stringify遇到特殊字符如：-amp-会报错"><span class="post-toc-number">68.</span> <span class="post-toc-text">使用JSON.stringify遇到特殊字符如：&amp; 会报错</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#1-通过编码解码的方式处理"><span class="post-toc-number">68.1.</span> <span class="post-toc-text">1.通过编码解码的方式处理</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#2-使用vuex，不容易出问题"><span class="post-toc-number">68.2.</span> <span class="post-toc-text">2.使用vuex，不容易出问题</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#数组深拷贝"><span class="post-toc-number">69.</span> <span class="post-toc-text">数组深拷贝</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#微信小程序textarea组件-输入字数-＞-限制字数-的bug"><span class="post-toc-number">70.</span> <span class="post-toc-text">微信小程序textarea组件 输入字数 ＞ 限制字数 的bug</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#套div防止图片被挤压变形"><span class="post-toc-number">71.</span> <span class="post-toc-text">套div防止图片被挤压变形</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#小程序不支持table标签"><span class="post-toc-number">72.</span> <span class="post-toc-text">小程序不支持table标签</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#uniapp中的textarea文本框设置长度限制"><span class="post-toc-number">73.</span> <span class="post-toc-text">uniapp中的textarea文本框设置长度限制</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#打开另一个小程序"><span class="post-toc-number">74.</span> <span class="post-toc-text">打开另一个小程序</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#跳转回上一个小程序"><span class="post-toc-number">74.1.</span> <span class="post-toc-text">跳转回上一个小程序</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#跳转到E证通小程序进行人脸识别"><span class="post-toc-number">75.</span> <span class="post-toc-text">跳转到E证通小程序进行人脸识别</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#常用返回值记录"><span class="post-toc-number">76.</span> <span class="post-toc-text">常用返回值记录</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#uniapp视频选择uni-chooseVideo返回值"><span class="post-toc-number">76.1.</span> <span class="post-toc-text">uniapp视频选择uni.chooseVideo返回值</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#uniapp监听实时地理位置变化事件uni-onLocationChange返回值"><span class="post-toc-number">76.2.</span> <span class="post-toc-text">uniapp监听实时地理位置变化事件uni.onLocationChange返回值</span></a></li></ol></li></ol>
        </nav>
    </aside>


<article id="post-knowledges/uniapp"
  class="post-article article-type-post fade" itemprop="blogPost">

    <div class="post-card">
        <h1 class="post-card-title">uniapp</h1>
        <div class="post-meta">
            <time class="post-time" title="2023-04-25 18:03:10" datetime="2023-04-25T10:03:10.000Z"  itemprop="datePublished">2023-04-25</time>

            
	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/前端知识点/">前端知识点</a></li></ul>



            
<span id="busuanzi_container_page_pv" title="文章总阅读量" style='display:none'>
    <i class="icon icon-eye icon-pr"></i><span id="busuanzi_value_page_pv"></span>
</span>


        </div>
        <div class="post-content" id="post-content" itemprop="postContent">
            <h3 id="小技巧"><a href="#小技巧" class="headerlink" title="小技巧"></a>小技巧</h3><p>右击“新建页面“可以直接创建xx文件夹和xx.vue并配置好pages.json，可以自定义模板如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;view&gt;</span><br><span class="line"></span><br><span class="line">    &lt;/view&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">    data() &#123;</span><br><span class="line">        return &#123;&#125;;</span><br><span class="line">    &#125;,</span><br><span class="line">    components: &#123;&#125;,</span><br><span class="line">    onLoad(options) &#123;&#125;,</span><br><span class="line">    onShow() &#123;&#125;,</span><br><span class="line">    methods: &#123;&#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot; scoped&gt;</span><br><span class="line"></span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<h3 id="小问题"><a href="#小问题" class="headerlink" title="小问题"></a>小问题</h3><ul>
<li><p>uniapp登录并不会执行App.vue中的onlunch，因为onlunch是进入小程序执行一次，onlunch后才能看到登录页</p>
</li>
<li><p>switch、delete等是关键词，不能用作方法名，不然打死也找不到为什么报错o(╥﹏╥)o</p>
</li>
<li><p>在小程序中尽量避免使用cursor: pointer;会导致点击时会出现淡蓝色背景，打死找不到原因o(╥﹏╥)o</p>
</li>
<li><p>刚配置完pages.json里的页面后跳转该页不显示？在Hbuilder中重新运行一下项目就好了</p>
</li>
<li><p>固定尺寸图标不能只设置宽度用mode=”widthFix”，这样真机首次进入会闪烁（高度拉伸），只能同时设置宽高</p>
</li>
<li><p>微信小程序底部tabBar一般通过switchTab进行跳转，但该api无法传参； 可以使用reLaunch进行跳转，它也可以跳转到tabBar，且可以传参，当然注意它会关闭其他页面</p>
</li>
<li><p>iPhoneX等机型安全区高度都是34</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">:style=&quot;&#123; &apos;padding-bottom&apos;: systemInfo.safeAreaInsets.bottom + &apos;px&apos;&#125;&quot;</span><br></pre></td></tr></table></figure>
</li>
<li><p>缺少平台 h5 插件（一定要cnpm安装）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cnpm install @dcloudio/uni-h5 --save</span><br></pre></td></tr></table></figure>
</li>
<li><p>:style 不支持模板字符串如 <code>top:${headerHeight}px</code> 的语法</p>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">单字符如top可写为</span><br><span class="line">:style=&quot;&#123; top: headerHeight + &apos;px&apos; &#125;</span><br><span class="line">双字符padding-bottom不加引号会报错，可写为</span><br><span class="line">:style=&quot;&#123; &apos;padding-bottom&apos;: safeAreaHeight + &apos;px&apos;, height: calc(100% - navHeight+&apos;px&apos;) &#125;&quot;</span><br><span class="line">:style=&quot;&#123;&apos;padding-top&apos;:160+systemInfo.statusBarHeight+&apos;px&apos;,&apos;padding-bottom&apos;:envType===4?&apos;60px&apos;:&apos;0&apos;&#125;&quot;</span><br></pre></td></tr></table></figure>

<h3 id="uniapp创建步骤"><a href="#uniapp创建步骤" class="headerlink" title="uniapp创建步骤"></a>uniapp创建步骤</h3><p>1.新建-项目-选择模板-创建</p>
<p>2.manifest.json中</p>
<p>基础配置-填写名称、描述</p>
<p>web配置-基础路径填“./”，部署H5到相对路径（本地可以打开）</p>
<p>微信小程序配置-填写appid、勾选样式补全和自动压缩</p>
<h3 id="uniapp运行步骤"><a href="#uniapp运行步骤" class="headerlink" title="uniapp运行步骤"></a>uniapp运行步骤</h3><ol>
<li>项目拖动到HBuilderX打开</li>
<li>HBuilderX插件市场安装sass、less</li>
<li>打开微信开发者工具扫码登录（微信开发者平台需要加入项目组），在左上角选择设置 &gt; 安全设置， 开启服务端口即可</li>
<li>HBuilderX打开首页代码，点击“运行”–“运行到小程序模拟器”–“微信开发者工具”</li>
<li>等待微信开发者工具启动，点击项目，等待加载完成即可看到页面</li>
<li>h5：点击“运行”–“运行到浏览器”–“chome”</li>
<li>h5打包：点击“发行”–“网站-PC”</li>
</ol>
<h3 id="uniapp公共图片路径封装及使用"><a href="#uniapp公共图片路径封装及使用" class="headerlink" title="uniapp公共图片路径封装及使用"></a>uniapp公共图片路径封装及使用</h3><p>config.js</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">imgUrl: &apos;https://xxx.xxx.com/xxx/images/&apos;, // 服务器图片路径</span><br></pre></td></tr></table></figure>

<h4 id="方法1-使用Vue-prototype，每个页改动代码较少，推荐使用"><a href="#方法1-使用Vue-prototype，每个页改动代码较少，推荐使用" class="headerlink" title="方法1.使用Vue.prototype，每个页改动代码较少，推荐使用"></a>方法1.使用Vue.prototype，每个页改动代码较少，推荐使用</h4><p>main.js</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">// 返回公共图片路径</span><br><span class="line">Vue.prototype.getSrc = function (img) &#123;</span><br><span class="line">  return Config.imgUrl + img;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>页面中</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;image :src=&quot;getSrc(&apos;account_checked@2x.png&apos;)&quot; /&gt;</span><br></pre></td></tr></table></figure>

<h4 id="方法2-只使用config，缺点：每个页改动代码较多"><a href="#方法2-只使用config，缺点：每个页改动代码较多" class="headerlink" title="方法2.只使用config，缺点：每个页改动代码较多"></a>方法2.只使用config，缺点：每个页改动代码较多</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;image :src=&quot;imgUrl+&apos;login-bg@2x.png&apos;&quot;&gt;&lt;/image&gt;</span><br><span class="line"></span><br><span class="line">import Config from &apos;@/config&apos;</span><br><span class="line"></span><br><span class="line">data() &#123;</span><br><span class="line">        return &#123;</span><br><span class="line">            imgUrl: Config.imgUrl, // 图片地址</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br></pre></td></tr></table></figure>

<h3 id="success内部不写-this简化代码"><a href="#success内部不写-this简化代码" class="headerlink" title="success内部不写_this简化代码"></a>success内部不写_this简化代码</h3><p>官网示例</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">uni.removeStorage(&#123;</span><br><span class="line">	key: &apos;storage_key&apos;,</span><br><span class="line">	success: function (res) &#123;</span><br><span class="line">		console.log(&apos;success&apos;);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>实际使用因为success函数内部无法获取this.historicalLocation报错，只能let _this = this</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">let _this = this</span><br><span class="line">         uni.removeStorage(&#123;</span><br><span class="line">             key: &apos;historicalLocation&apos;,</span><br><span class="line">             success(res) &#123;</span><br><span class="line">                 _this.historicalLocation = []</span><br><span class="line">             &#125;</span><br><span class="line">         &#125;)</span><br></pre></td></tr></table></figure>

<p>优化：将success函数改为箭头函数，就不需要再let _this = this了</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">uni.removeStorage(&#123;</span><br><span class="line">             key: &apos;historicalLocation&apos;,</span><br><span class="line">             success: (res) =&gt; &#123;</span><br><span class="line">                 this.historicalLocation = []</span><br><span class="line">             &#125;</span><br><span class="line">         &#125;)</span><br></pre></td></tr></table></figure>

<p>很简单，但很实用！官网所有success的函数都可以这样使用。</p>
<h3 id="await可以获取函数返回值"><a href="#await可以获取函数返回值" class="headerlink" title="await可以获取函数返回值"></a>await可以获取函数返回值</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">async function echo(arg) &#123;  </span><br><span class="line">	return arg;</span><br><span class="line">&#125;</span><br><span class="line">async function getValue() &#123;</span><br><span class="line">	const res = await echo(5);</span><br><span class="line">    console.log(res);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">getValue();</span><br></pre></td></tr></table></figure>

<h3 id="uniapp中使用calc计算的坑"><a href="#uniapp中使用calc计算的坑" class="headerlink" title="uniapp中使用calc计算的坑"></a>uniapp中使用calc计算的坑</h3><p>错误写法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">height: calc(100vh-100rpx)</span><br></pre></td></tr></table></figure>

<p>正确写法:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">height: calc(100vh - 100rpx)</span><br></pre></td></tr></table></figure>

<p>睁大眼睛找不同，有没有发现在calc中“100vh”和“100rpx”与中间“-”加了个空格，对，就是这么坑，我之前以为uniapp不支持calc计算不同单位呢，后来才发现这个坑。</p>
<h3 id="uni-app-部署-H5-到相对路径（含file协议打开）"><a href="#uni-app-部署-H5-到相对路径（含file协议打开）" class="headerlink" title="uni-app 部署 H5 到相对路径（含file协议打开）"></a>uni-app 部署 H5 到相对路径（含file协议打开）</h3><p>自 HBuilderX 2.6.6 版本开始，uni-app 支持部署 H5 到相对路径，部署到服务端或在本地（使用file协议）打开均可。</p>
<h4 id="使用方式"><a href="#使用方式" class="headerlink" title="使用方式"></a>使用方式</h4><p>配置 manifest.json 配置 h5-&gt;router-&gt;base 值为 “./“ 部署到相对路径</p>
<h4 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h4><p>按相对路径发行时路由模式强制为hash模式，不支持history模式（两者相悖）。</p>
<h3 id="uniapp阻止遮罩滚动穿透"><a href="#uniapp阻止遮罩滚动穿透" class="headerlink" title="uniapp阻止遮罩滚动穿透"></a>uniapp阻止遮罩滚动穿透</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;view class=&quot;mask&quot; @touchmove.stop.prevent=&quot;moveHandle&quot;&gt;</span><br><span class="line"></span><br><span class="line">methods:&#123;</span><br><span class="line">    moveHandle()&#123;</span><br><span class="line">		return</span><br><span class="line">	&#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="填入字符不能包含-lt-gt-（防止xss攻击）"><a href="#填入字符不能包含-lt-gt-（防止xss攻击）" class="headerlink" title="填入字符不能包含&lt;&gt;/（防止xss攻击）"></a>填入字符不能包含&lt;&gt;/（防止xss攻击）</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">//main.js中</span><br><span class="line">Vue.prototype.inputFilter = function(text) &#123;</span><br><span class="line">	// 规则对象(reg)</span><br><span class="line">	let reg = new RegExp(&quot;[&lt;&gt;/]&quot;)</span><br><span class="line">	if (reg.test(text)) &#123;</span><br><span class="line">		uni.showToast(&#123;</span><br><span class="line">			icon: &apos;none&apos;,</span><br><span class="line">			duration: 3000,</span><br><span class="line">			title: &apos;填入字符不能包含&lt;&gt;/&apos;</span><br><span class="line">		&#125;)</span><br><span class="line">		return true;</span><br><span class="line">	&#125;</span><br><span class="line">	return false;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 页面中函数内使用</span><br><span class="line">// 填入字符不能包含&lt;&gt;/</span><br><span class="line">if (this.inputFilter(this.value)) &#123;</span><br><span class="line">	return false</span><br><span class="line">&#125;</span><br><span class="line">//如果要验证数组对象中多个值</span><br><span class="line">let flag = false</span><br><span class="line">bodyList.forEach(item =&gt; &#123;</span><br><span class="line">	if (this.inputFilter(item.memo)) &#123;</span><br><span class="line">		flag = true</span><br><span class="line">	&#125;</span><br><span class="line">&#125;)</span><br><span class="line">if (flag) &#123;</span><br><span class="line">	return</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="全屏播放视频"><a href="#全屏播放视频" class="headerlink" title="全屏播放视频"></a>全屏播放视频</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;video id=&quot;myVideo&quot; class=&quot;home_video&quot; loop autoplay show-center-play-btn :src=&quot;articleData.content&quot;</span><br><span class="line">			:controls=&quot;false&quot; :object-fit=&quot;fit&quot; @loadedmetadata=&quot;getSize&quot;&gt;&lt;/video&gt;</span><br><span class="line"></span><br><span class="line">data中</span><br><span class="line">fit: &apos;fill&apos;, // 默认竖屏播放（填充）</span><br><span class="line"></span><br><span class="line">// 获取视频宽高时长</span><br><span class="line">getSize(e) &#123;</span><br><span class="line">	const &#123; width, height, duration &#125; = e.detail</span><br><span class="line">	// 如果宽大于高，横屏播放（包含）</span><br><span class="line">	if (width &gt; height) &#123;</span><br><span class="line">		this.fit = &apos;contain&apos;</span><br><span class="line">	&#125;</span><br><span class="line">	// console.log(width, height, duration, this.fit)</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<h3 id="每日登录领红包"><a href="#每日登录领红包" class="headerlink" title="每日登录领红包"></a>每日登录领红包</h3><p>父组件中</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 签到弹窗组件 --&gt;</span><br><span class="line">&lt;popup v-if=&quot;signIn&quot; :isShowDialog=&quot;isShowDialog&quot; :operation=&quot;operation&quot; @sonClose=&quot;close&quot; @sonReceive=&quot;receive&quot;&gt;&lt;/popup&gt;</span><br></pre></td></tr></table></figure>

<p>弹窗组件中</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">methods: &#123;</span><br><span class="line">			// 关闭弹窗后今日不再提醒</span><br><span class="line">			dialogClose() &#123;</span><br><span class="line">				this.$emit(&quot;sonClose&quot;, false); //其中function为父组件定义函数，param为需要传递参数</span><br><span class="line">				try &#123;</span><br><span class="line">					uni.setStorageSync(&apos;signInDate&apos;, new Date().toLocaleDateString());</span><br><span class="line">				&#125; catch (e) &#123;</span><br><span class="line">					console.log(e)</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;,</span><br><span class="line">			// 登录领取福利</span><br><span class="line">			async receive() &#123;</span><br><span class="line">				const &#123; data &#125; = await signInRedPacket()</span><br><span class="line">				try &#123;</span><br><span class="line">					uni.setStorageSync(&apos;signInDate&apos;, new Date().toLocaleDateString());</span><br><span class="line">				&#125; catch (e) &#123;</span><br><span class="line">					console.log(e)</span><br><span class="line">				&#125;</span><br><span class="line">				console.log(data)</span><br><span class="line">				if (data) &#123;</span><br><span class="line">					this.credit = data.credit;</span><br><span class="line">					setTimeout(() =&gt; &#123;</span><br><span class="line">						this.operation = 2;</span><br><span class="line">						this.$emit(&quot;sonReceive&quot;, this.operation); //其中function为父组件定义函数，param为需要传递参数</span><br><span class="line">					&#125;, 100);</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;,</span><br><span class="line">		&#125;,</span><br></pre></td></tr></table></figure>

<p>在App.vue中onLaunch生命周期函数中</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">// 每日签到判断</span><br><span class="line">everydaySignIn() &#123;</span><br><span class="line">	try &#123;</span><br><span class="line">		const signInDate = uni.getStorageSync(&apos;signInDate&apos;);</span><br><span class="line">		if (signInDate) &#123;</span><br><span class="line">			const today = new Date().toLocaleDateString()</span><br><span class="line">			if (today &lt;= signInDate) &#123;</span><br><span class="line">				console.log(signInDate, today, &quot;不可以签到&quot;);</span><br><span class="line">				this.$store.commit(&apos;everydaySignIn&apos;, false)</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125; catch (e) &#123;</span><br><span class="line">		console.log(e)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="防止多次提交或点击"><a href="#防止多次提交或点击" class="headerlink" title="防止多次提交或点击"></a>防止多次提交或点击</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">if (this.noClick) &#123;</span><br><span class="line">	// 第一次点击</span><br><span class="line">    this.noClick = false;</span><br><span class="line">    console.log(this.noClick)</span><br><span class="line">    const res = await saveReceiver(this.form)</span><br><span class="line">    if (res.code === 0) &#123;</span><br><span class="line">    	uni.navigateBack()</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        uni.showToast(&#123;</span><br><span class="line">            icon: &apos;none&apos;,</span><br><span class="line">            title: &apos;添加失败&apos;</span><br><span class="line">    	&#125;)</span><br><span class="line">	&#125;</span><br><span class="line">    setTimeout(() =&gt; &#123;</span><br><span class="line">        this.noClick = true;</span><br><span class="line">        console.log(this.noClick)</span><br><span class="line">    &#125;, 2000)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="返回顶部按钮"><a href="#返回顶部按钮" class="headerlink" title="返回顶部按钮"></a>返回顶部按钮</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">   &lt;view class=&quot;toTop&quot; @tap=&quot;toTop&quot; :style=&quot;&#123;&apos;display&apos;:(flag? &apos;block&apos;:&apos;none&apos;)&#125;&quot;&gt;</span><br><span class="line">			&lt;image src=&quot;../../static/icon/toTop.png&quot; mode=&quot;widthFix&quot;&gt;&lt;/image&gt;</span><br><span class="line">		&lt;/view&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">    export default &#123;</span><br><span class="line">        data() &#123;</span><br><span class="line">            return &#123;</span><br><span class="line">                flag: false // 是否显示回顶按钮</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        methods: &#123;</span><br><span class="line">           // 返回顶部</span><br><span class="line">			toTop() &#123;</span><br><span class="line">				uni.pageScrollTo(&#123;</span><br><span class="line">					scrollTop: 0</span><br><span class="line">				&#125;);</span><br><span class="line">			&#125;,</span><br><span class="line">			// 当距离大于800时显示回到顶部按钮</span><br><span class="line">			onPageScroll(e) &#123;</span><br><span class="line">				if (e.scrollTop &gt; 800) &#123;</span><br><span class="line">					this.flag = true</span><br><span class="line">				&#125; else &#123;</span><br><span class="line">					this.flag = false</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style&gt;</span><br><span class="line">    .toTop &#123;</span><br><span class="line">		position: fixed;</span><br><span class="line">		z-index: 999;</span><br><span class="line">		right: 20rpx;</span><br><span class="line">		bottom: 200rpx;</span><br><span class="line">		transition: transform 0.8s ease-in;</span><br><span class="line"></span><br><span class="line">		image &#123;</span><br><span class="line">			width: 80rpx;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<h3 id="跳转页面传对象"><a href="#跳转页面传对象" class="headerlink" title="跳转页面传对象"></a>跳转页面传对象</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">// 传递</span><br><span class="line">goSystemNotice(content) &#123;</span><br><span class="line">	uni.navigateTo(&#123;</span><br><span class="line">		url: `/pages/message/systemNotice?content=$&#123;JSON.stringify(content)&#125;`</span><br><span class="line">	&#125;)</span><br><span class="line">&#125;</span><br><span class="line">// 接收</span><br><span class="line">onLoad(option) &#123;</span><br><span class="line">	this.content = JSON.parse(option.content)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="uniapp保存网络图片"><a href="#uniapp保存网络图片" class="headerlink" title="uniapp保存网络图片"></a>uniapp保存网络图片</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">// 预览长按保存到相册</span><br><span class="line">			preview(pic) &#123;</span><br><span class="line">				uni.previewImage(&#123;</span><br><span class="line">					urls: [pic],</span><br><span class="line">					// 长按图片显示操作菜单</span><br><span class="line">					longPressActions: &#123;</span><br><span class="line">						itemList: [&apos;保存图片&apos;],</span><br><span class="line">						success: (data) =&gt; &#123;</span><br><span class="line">							//先下载到本地获取临时路径</span><br><span class="line">							uni.downloadFile(&#123;</span><br><span class="line">								url: pic,</span><br><span class="line">								success: (res) =&gt; &#123;</span><br><span class="line">									console.log(&apos;下载成功&apos;, res.tempFilePath)</span><br><span class="line">									//将临时路径保存到相册，即可在相册中查看图片</span><br><span class="line">									uni.saveImageToPhotosAlbum(&#123;</span><br><span class="line">										filePath: res.tempFilePath, //不支持网络地址</span><br><span class="line">										success: function() &#123;</span><br><span class="line">											uni.showToast(&#123;</span><br><span class="line">												title: &apos;保存图片到相册成功&apos;,</span><br><span class="line">												position: &apos;bottom&apos;</span><br><span class="line">											&#125;);</span><br><span class="line">										&#125;</span><br><span class="line">									&#125;);</span><br><span class="line">								&#125;,</span><br><span class="line">								fail: (err) =&gt; &#123;</span><br><span class="line">									console.log(&apos;下载失败&apos;, err)</span><br><span class="line">								&#125;</span><br><span class="line">							&#125;)</span><br><span class="line">						&#125;,</span><br><span class="line">						fail: function(err) &#123;</span><br><span class="line">							console.log(err.errMsg);</span><br><span class="line">						&#125;</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;)</span><br><span class="line">			&#125;</span><br></pre></td></tr></table></figure>

<h3 id="gitignore文件忽略提交unpackage包到github仓库（uni-app）"><a href="#gitignore文件忽略提交unpackage包到github仓库（uni-app）" class="headerlink" title=".gitignore文件忽略提交unpackage包到github仓库（uni-app）"></a>.gitignore文件忽略提交unpackage包到github仓库（uni-app）</h3><p>pull代码下来，然而unpackage文件一直说有东西重复了，让我删除掉先，应该是同事提交了unpackage包上去了，所以我们就来解决这个问题。</p>
<p>1、要怎么样把远程分支上的unpackage包给删除掉？</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git rm -r --cached unpackage</span><br></pre></td></tr></table></figure>

<p>（本地的目录还在，直接关闭软件删除unpackage目录）</p>
<p>2、要怎么要每次提交都忽略unpackage等文件？</p>
<p>根目录新建.gitignore文件</p>
<p>然后记事本打开，复制粘贴以下内容进去就完事了</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">node_modules/</span><br><span class="line">.project</span><br><span class="line">unpackage/</span><br><span class="line">.DS_Store</span><br></pre></td></tr></table></figure>

<p>3、git提交，push一下即可。</p>
<h3 id="uni-app把canvas的px像素使用rpx表示"><a href="#uni-app把canvas的px像素使用rpx表示" class="headerlink" title="uni-app把canvas的px像素使用rpx表示"></a>uni-app把canvas的px像素使用rpx表示</h3><p>小程序，移动端在设置canvas的位置的时候，因为cnavas默认是px像素，对于位置的设置很不方便，所以要把px转换为用rpx表示</p>
<p>1、获取设备宽度</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">const system = uni.getSystemInfoSync()</span><br></pre></td></tr></table></figure>

<p>2、单位换算，算出1rpx = 多少px</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">const w = system.windowWidth / 750</span><br></pre></td></tr></table></figure>

<p>3、使用</p>
<p>比如我要设置30rpx，则可以表为 30*w</p>
<h3 id="canvas绘制多行文本自动换行"><a href="#canvas绘制多行文本自动换行" class="headerlink" title="canvas绘制多行文本自动换行"></a>canvas绘制多行文本自动换行</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 绘制多行文本自动换行</span></span><br><span class="line"><span class="comment">	 * ctx canvas对象</span></span><br><span class="line"><span class="comment">	 * text 文本内容</span></span><br><span class="line"><span class="comment">	 * leftWidth 距离左侧的距离</span></span><br><span class="line"><span class="comment">	 * initHeight 距离顶部的距离</span></span><br><span class="line"><span class="comment">	 * textWidth 文本的宽度</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	drawText (text, leftWidth, initHeight, ctx, textWidth) &#123;</span><br><span class="line">	    <span class="keyword">let</span> lineWidth = <span class="number">0</span>;</span><br><span class="line">	    <span class="keyword">let</span> lastSubStrIndex = <span class="number">0</span>; <span class="comment">//每次开始截取的字符串的索引</span></span><br><span class="line">		<span class="keyword">const</span> rpx = <span class="keyword">this</span>.windowWidth / <span class="number">750</span>;</span><br><span class="line">	    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; text.length; i++) &#123;</span><br><span class="line">	        lineWidth += ctx.measureText(text[i]).width;</span><br><span class="line">	        <span class="comment">//16是一个中文宽度，为了解决偶尔夹有数字或英文时，文字长度超出设置宽度的bug</span></span><br><span class="line">	        <span class="keyword">if</span> (lineWidth &gt; textWidth - <span class="number">16</span>) &#123;</span><br><span class="line">	            ctx.fillText(text.substring(lastSubStrIndex, i + <span class="number">1</span>), leftWidth, initHeight); <span class="comment">//绘制截取部分</span></span><br><span class="line">	            initHeight += <span class="number">48</span> * rpx;</span><br><span class="line">	            lineWidth = <span class="number">0</span>;</span><br><span class="line">	            lastSubStrIndex = i + <span class="number">1</span>;</span><br><span class="line">	        &#125;</span><br><span class="line">	        <span class="keyword">if</span> (i === text.length - <span class="number">1</span>) &#123;</span><br><span class="line">	            ctx.fillText(text.substring(lastSubStrIndex, i + <span class="number">1</span>), leftWidth, initHeight); <span class="comment">//绘制剩余部分</span></span><br><span class="line">	        &#125;</span><br><span class="line">	    &#125;</span><br><span class="line">		ctx.fillText(<span class="string">"谢谢。"</span>, <span class="number">40</span> * rpx, initHeight + <span class="number">48</span> * rpx);</span><br><span class="line">	&#125;,</span><br></pre></td></tr></table></figure>

<h3 id="canvas设置字间距（真机不生效）、文字加粗"><a href="#canvas设置字间距（真机不生效）、文字加粗" class="headerlink" title="canvas设置字间距（真机不生效）、文字加粗"></a>canvas设置字间距（真机不生效）、文字加粗</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;canvas</span><br><span class="line">        class=&quot;my-canvas&quot;</span><br><span class="line">        canvas-id=&quot;myCanvas&quot;</span><br><span class="line">        @click=&quot;saveSharePic(&apos;canvas&apos;)&quot;</span><br><span class="line">&gt;&lt;/canvas&gt;</span><br><span class="line"></span><br><span class="line">context.font = &quot;bold 16px PingFangSC-Medium, PingFang SC&quot;;</span><br><span class="line"></span><br><span class="line">.my-canvas &#123;</span><br><span class="line">	letter-spacing: 2rpx;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="文字地址使用微信内置地图查看位置"><a href="#文字地址使用微信内置地图查看位置" class="headerlink" title="文字地址使用微信内置地图查看位置"></a>文字地址使用微信内置地图查看位置</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">import Config from &quot;@/config.js&quot;;</span><br><span class="line">import QQMapWX from &quot;@/utils/qqmap-wx-jssdk.min.js&quot;</span><br><span class="line"></span><br><span class="line">//点击查看地址</span><br><span class="line">   viewAddress(address) &#123;</span><br><span class="line">	// 实例化腾讯地图API核心类</span><br><span class="line">	const tMap = new QQMapWX(&#123;</span><br><span class="line">		key: Config.mapKey // 开发者密钥</span><br><span class="line">	&#125;);</span><br><span class="line">	// 调用地址解析接口</span><br><span class="line">	tMap.geocoder(&#123;</span><br><span class="line">		address, //地址参数，例：address: &apos;北京市海淀区彩和坊路海淀西大街74号&apos;</span><br><span class="line">		success: function(res) &#123;</span><br><span class="line">			// console.log(res);</span><br><span class="line">			uni.openLocation(&#123;</span><br><span class="line">				latitude: res.result.location.lat, // 纬度，范围为-90~90，负数表示南纬</span><br><span class="line">				longitude: res.result.location.lng, // 经度，范围为-180~180，负数表示西经</span><br><span class="line">				name: res.result.title, // 位置名</span><br><span class="line">				address, // 地址的详细说明</span><br><span class="line">				scale: 17, // 缩放比例，范围5~18，默认为18</span><br><span class="line">				success: function(res)&#123;</span><br><span class="line">					// success</span><br><span class="line">				&#125;,</span><br><span class="line">				fail: function() &#123;</span><br><span class="line">					// fail</span><br><span class="line">				&#125;,</span><br><span class="line">			&#125;)</span><br><span class="line">		&#125;,</span><br><span class="line">		fail: function(res) &#123;</span><br><span class="line">			// console.log(res);</span><br><span class="line">			uni.showToast(&#123;</span><br><span class="line">				title: &quot;该地址无法定位&quot;,</span><br><span class="line">				icon: &quot;none&quot;,</span><br><span class="line">				duration: 2000</span><br><span class="line">			&#125;);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;);</span><br><span class="line">   &#125;,</span><br></pre></td></tr></table></figure>

<p>在manifest.json中添加以下代码，并在小程序后台申请getLocation权限（审核1-2天）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&quot;mp-weixin&quot; : &#123;</span><br><span class="line">        &quot;permission&quot; : &#123;</span><br><span class="line">            &quot;scope.userLocation&quot; : &#123;</span><br><span class="line">                &quot;desc&quot; : &quot;将获取您的位置信息，用于查看地址功能&quot;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">		&quot;requiredPrivateInfos&quot; : [ &quot;getLocation&quot; ]</span><br><span class="line">    &#125;,</span><br></pre></td></tr></table></figure>

<h3 id="开启小程序在前后台时均可接收位置消息"><a href="#开启小程序在前后台时均可接收位置消息" class="headerlink" title="开启小程序在前后台时均可接收位置消息"></a>开启小程序在前后台时均可接收位置消息</h3><p>开发工具需要清除全部缓存，重新编译，才能获取权限</p>
<p>真机需要到小程序设置中位置信息选择“使用小程序时和离开后”</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&quot;requiredBackgroundModes&quot;: [</span><br><span class="line">          &quot;location&quot;</span><br><span class="line">      ],</span><br><span class="line">      &quot;requiredPrivateInfos&quot;: [</span><br><span class="line">          &quot;getLocation&quot;,</span><br><span class="line">          &quot;onLocationChange&quot;,</span><br><span class="line">          &quot;startLocationUpdate&quot;,</span><br><span class="line">          &quot;startLocationUpdateBackground&quot;</span><br><span class="line">      ]</span><br></pre></td></tr></table></figure>

<h3 id="js计算两个经纬度点之间距离"><a href="#js计算两个经纬度点之间距离" class="headerlink" title="js计算两个经纬度点之间距离"></a>js计算两个经纬度点之间距离</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">// 计算两点之间直线距离</span><br><span class="line">      algorithm(point1, point2) &#123;</span><br><span class="line">          let &#123; latitude: x1, longitude: y1 &#125; = point1</span><br><span class="line">          let &#123; latitude: x2, longitude: y2 &#125; = point2</span><br><span class="line">          console.log(x1, y1, x2, y2)</span><br><span class="line">          // 纬度</span><br><span class="line">          let Lat1 = this.rad(x1)</span><br><span class="line">          let Lat2 = this.rad(x2)</span><br><span class="line">          let a = Lat1 - Lat2 // 两点纬度之差</span><br><span class="line">          let b = this.rad(y1) - this.rad(y2) // 经度之差</span><br><span class="line">          let s =</span><br><span class="line">              2 *</span><br><span class="line">              Math.asin(</span><br><span class="line">                  Math.sqrt(</span><br><span class="line">                      Math.pow(Math.sin(a / 2), 2) +</span><br><span class="line">                          Math.cos(Lat1) *</span><br><span class="line">                              Math.cos(Lat2) *</span><br><span class="line">                              Math.pow(Math.sin(b / 2), 2)</span><br><span class="line">                  )</span><br><span class="line">              )</span><br><span class="line">          // 计算两点距离的公式</span><br><span class="line">          // 弧长等于弧度乘地球半径（半径为米）</span><br><span class="line">          s = s * 6378137.0</span><br><span class="line">          // 精确距离的数值</span><br><span class="line">          s = Math.round(s * 10000) / 10000</span><br><span class="line">          return s</span><br><span class="line">      &#125;,</span><br><span class="line">      // 角度转换成弧度</span><br><span class="line">      rad(d) &#123;</span><br><span class="line">          return (d * Math.PI) / 180.0</span><br><span class="line">      &#125;,</span><br></pre></td></tr></table></figure>

<p>自己与腾讯地图分别计算两点距离，8km，自己计算比腾讯多了10m</p>
<h3 id="js计算多个经纬度点之间距离"><a href="#js计算多个经纬度点之间距离" class="headerlink" title="js计算多个经纬度点之间距离"></a>js计算多个经纬度点之间距离</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">// 计算实时路径总距离</span><br><span class="line">      calculateDistance() &#123;</span><br><span class="line">          let sum = 0,</span><br><span class="line">              points = this.points</span><br><span class="line">          // let points = [</span><br><span class="line">          //     &#123; latitude: 40.040452, longitude: 116.273486 &#125;,</span><br><span class="line">          //     &#123; latitude: 40.00654, longitude: 116.303695 &#125;,</span><br><span class="line">          //     &#123; latitude: 39.8664564344618, longitude: 116.3070187717014 &#125;</span><br><span class="line">          // ]</span><br><span class="line">          if (points.length &gt;= 2) &#123;</span><br><span class="line">              for (let i = 0; i &lt; points.length - 1; i++) &#123;</span><br><span class="line">                  sum += this.algorithm(points[i], points[i + 1])</span><br><span class="line">              &#125;</span><br><span class="line">          &#125;</span><br><span class="line">          this.sum = sum</span><br><span class="line">      &#125;,</span><br></pre></td></tr></table></figure>

<h3 id="小程序地图画路线测试结果"><a href="#小程序地图画路线测试结果" class="headerlink" title="小程序地图画路线测试结果"></a>小程序地图画路线测试结果</h3><p>北京到深圳2000km，最多10w个点的话，可以设置20m一个点<br>距离：都可以计算，7w多km<br>真机本地存储：最多15185个，石家庄站到喀什站-2次<br>画图，10w个耗时10秒左右，不过存在有性能问题-8次<br>14w个可以画图-12次<br>17w个可以画图-14次<br>（n次表示漠河站到喀什站路径规划，返回值push的循环次数）</p>
<p>比例尺是根据图上距离*比例尺计算实际距离，图上距离和比例尺都无法获取，无法计算实际距离<br>比例尺1:1000000，图上的距离是12.5厘米<br>实际距离12.5cm x 1000000 = 12500000cm = 125000m = 125km</p>
<p>开发工具57980个，setData数据传输长度为 8322KB，8.12MB，存在有性能问题！-5次<br>漠河站到喀什站5898002/3=1966000个数组，腾讯23611个，距离误差15km<br>北京到吕梁672178/3=224059个数组，腾讯3860个</p>
<h3 id="小程序其他样式需覆盖地图"><a href="#小程序其他样式需覆盖地图" class="headerlink" title="小程序其他样式需覆盖地图"></a>小程序其他样式需覆盖地图</h3><p>根据实际情况，使用position的三个属性。（使用z-index不生效）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">position: relative;</span><br><span class="line">position: absolute;</span><br><span class="line">position: fixed;</span><br></pre></td></tr></table></figure>

<h3 id="地图选点"><a href="#地图选点" class="headerlink" title="地图选点"></a>地图选点</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&lt;map id=&quot;myMap&quot;</span><br><span class="line">    :latitude=&quot;location.latitude&quot;</span><br><span class="line">    :longitude=&quot;location.longitude&quot;</span><br><span class="line">    scale=&quot;17&quot;</span><br><span class="line">    show-location</span><br><span class="line">    @regionchange=&quot;regionchange&quot;&gt;</span><br><span class="line">&lt;/map&gt;</span><br><span class="line">    </span><br><span class="line">// 视野发生变化</span><br><span class="line">regionchange(e) &#123;</span><br><span class="line">    console.log(&apos;视野发生变化&apos;, e)</span><br><span class="line">    if (e.type === &apos;end&apos;) &#123;</span><br><span class="line">        this.mapCtx.getCenterLocation(&#123;</span><br><span class="line">            success: (res) =&gt; &#123;</span><br><span class="line">                console.log(&apos;地图中心的经纬度&apos;, res)</span><br><span class="line">                this.getAddress(res.latitude, res.longitude)</span><br><span class="line">            &#125;,</span><br><span class="line">            fail: (err) =&gt; &#123;</span><br><span class="line">                console.log(err)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<h3 id="地图高度动态调整"><a href="#地图高度动态调整" class="headerlink" title="地图高度动态调整"></a>地图高度动态调整</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br></pre></td><td class="code"><pre><span class="line">			&lt;!-- 地图 --&gt;</span><br><span class="line">            &lt;map id=&quot;myMap&quot;</span><br><span class="line">                :latitude=&quot;latitude&quot;</span><br><span class="line">                :longitude=&quot;longitude&quot;</span><br><span class="line">                :markers=&quot;markers&quot;</span><br><span class="line">                :polyline=&quot;polyline&quot;</span><br><span class="line">                scale=&quot;17&quot;</span><br><span class="line">                show-location</span><br><span class="line">                style=&quot;width: 100%;&quot;</span><br><span class="line">                :style=&quot;&#123; height: mapHeight + &apos;px&apos; &#125;&quot;&gt;</span><br><span class="line">            &lt;/map&gt;</span><br><span class="line"></span><br><span class="line">		&lt;view :class=&quot;envType === 4?&apos;operation operation-web&apos;:&apos;operation operation-mp&apos;&quot;</span><br><span class="line">                v-else</span><br><span class="line">                id=&quot;operation&quot;&gt;</span><br><span class="line">                &lt;view class=&quot;back&quot;</span><br><span class="line">                    @click=&quot;goBack&quot;&gt;</span><br><span class="line">                    &lt;image class=&quot;back-img&quot;</span><br><span class="line">                        src=&quot;/static/images/index_icon12.png&quot; /&gt;</span><br><span class="line">                &lt;/view&gt;</span><br><span class="line">                &lt;view class=&quot;input-area&quot;&gt;</span><br><span class="line">                    &lt;view class=&quot;button&quot;</span><br><span class="line">                        @click=&quot;reverse&quot;&gt;</span><br><span class="line">                        &lt;image src=&quot;/static/images/index_icon1.png&quot; /&gt;</span><br><span class="line">                    &lt;/view&gt;</span><br><span class="line">                    &lt;view class=&quot;input-content&quot;&gt;</span><br><span class="line">                        &lt;view class=&quot;input-item&quot;</span><br><span class="line">                            v-for=&quot;(item, index) in tripList&quot;</span><br><span class="line">                            :key=&quot;index&quot;&gt;</span><br><span class="line">                            &lt;view class=&quot;prefix&quot;</span><br><span class="line">                                v-if=&quot;index === 0&quot;&gt;</span><br><span class="line">                                &lt;view class=&quot;kong&quot;&gt;&lt;/view&gt;</span><br><span class="line">                                &lt;view class=&quot;cricle start&quot;&gt;&lt;/view&gt;</span><br><span class="line">                                &lt;view class=&quot;line&quot;&gt;&lt;/view&gt;</span><br><span class="line">                            &lt;/view&gt;</span><br><span class="line">                            &lt;view class=&quot;prefix&quot;</span><br><span class="line">                                v-else-if=&quot;index === tripList.length - 1&quot;&gt;</span><br><span class="line">                                &lt;view class=&quot;line&quot;&gt;&lt;/view&gt;</span><br><span class="line">                                &lt;view class=&quot;cricle end&quot;&gt;&lt;/view&gt;</span><br><span class="line">                                &lt;view class=&quot;kong&quot;&gt;&lt;/view&gt;</span><br><span class="line">                            &lt;/view&gt;</span><br><span class="line">                            &lt;view class=&quot;prefix&quot;</span><br><span class="line">                                v-else&gt;</span><br><span class="line">                                &lt;view class=&quot;line&quot;&gt;&lt;/view&gt;</span><br><span class="line">                                &lt;view class=&quot;index&quot;&gt;&#123;&#123; index &#125;&#125;&lt;/view&gt;</span><br><span class="line">                                &lt;view class=&quot;line&quot;&gt;&lt;/view&gt;</span><br><span class="line">                            &lt;/view&gt;</span><br><span class="line">                            &lt;view :class=&quot;item ? &apos;input&apos; : &apos;input placeholder&apos;&quot;</span><br><span class="line">                                @click=&quot;onClick&quot;</span><br><span class="line">                                v-if=&quot;index === 0&quot;&gt;</span><br><span class="line">                                &#123;&#123; item?item: &quot;请输入起点&quot; &#125;&#125;&lt;/view&gt;</span><br><span class="line">                            &lt;view :class=&quot;item ? &apos;input&apos; : &apos;input placeholder&apos;&quot;</span><br><span class="line">                                @click=&quot;onClick&quot;</span><br><span class="line">                                v-else-if=&quot;index === tripList.length - 1&quot;&gt;&#123;&#123; item?item: &quot;请输入终点&quot; &#125;&#125;&lt;/view&gt;</span><br><span class="line">                            &lt;view :class=&quot;item ? &apos;input&apos; : &apos;input placeholder&apos;&quot;</span><br><span class="line">                                @click=&quot;onClick&quot;</span><br><span class="line">                                v-else&gt;&#123;&#123; item?item: &quot;请输入途径点&quot; &#125;&#125;</span><br><span class="line">                            &lt;/view&gt;</span><br><span class="line">                        &lt;/view&gt;</span><br><span class="line">                    &lt;/view&gt;</span><br><span class="line">                    &lt;view class=&quot;button&quot;</span><br><span class="line">                        @click=&quot;onClick(1)&quot;&gt;</span><br><span class="line">                        &lt;image src=&quot;/static/images/index_icon2.png&quot; /&gt;</span><br><span class="line">                    &lt;/view&gt;</span><br><span class="line">                &lt;/view&gt;</span><br><span class="line">                &lt;view class=&quot;add-trip&quot;</span><br><span class="line">                    @click=&quot;onClick&quot;&gt;添加行程&lt;/view&gt;</span><br><span class="line">            &lt;/view&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        mapHeight: 400, // 地图高度响应式</span><br><span class="line"></span><br><span class="line">        // 设置地图高度</span><br><span class="line">        this.setMapHeight()</span><br><span class="line">		// 设置地图高度</span><br><span class="line">        setMapHeight() &#123;</span><br><span class="line">            if (this.token &amp;&amp; this.userInfo.travel_type !== 0) &#123;</span><br><span class="line">                // 设备模式/仪表盘模式/手机GPS模式</span><br><span class="line">                this.mapHeight = this.systemInfo.windowHeight</span><br><span class="line">            &#125; else &#123;</span><br><span class="line">                const query = uni.createSelectorQuery()</span><br><span class="line">                query.select(&apos;#operation&apos;).boundingClientRect()</span><br><span class="line">                query.selectViewport().scrollOffset()</span><br><span class="line">                query.exec((res) =&gt; &#123;</span><br><span class="line">                    console.log(&apos;操作区dom&apos;, res)</span><br><span class="line">                    if (res[0]) &#123;</span><br><span class="line">                        // 防止切换到设备模式没有操作区dom报错</span><br><span class="line">                        if (this.envType === 3) &#123;</span><br><span class="line">                            // 钉钉无法隐藏地图水印</span><br><span class="line">                            this.mapHeight =</span><br><span class="line">                                this.systemInfo.windowHeight - res[0].height</span><br><span class="line">                        &#125; else &#123;</span><br><span class="line">                            // 地图高度=可使用窗口高度-输入框区域高度+地图水印高度</span><br><span class="line">                            this.mapHeight =</span><br><span class="line">                                this.systemInfo.windowHeight -</span><br><span class="line">                                res[0].height +</span><br><span class="line">                                22</span><br><span class="line">                        &#125;</span><br><span class="line">                        console.log(</span><br><span class="line">                            this.systemInfo.windowHeight,</span><br><span class="line">                            res[0].height,</span><br><span class="line">                            this.mapHeight</span><br><span class="line">                        )</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        // 数组反转</span><br><span class="line">        reverse() &#123;</span><br><span class="line">            this.tripList = this.tripList.reverse()</span><br><span class="line">            this.$store.commit(&apos;setAddTripList&apos;, this.tripList)</span><br><span class="line">            console.log(this.tripList)</span><br><span class="line">        &#125;,</span><br><span class="line">        // 点击添加行程</span><br><span class="line">        onClick: Utils.throttle(function (isAdd) &#123;</span><br><span class="line">            console.log(&apos;点击事件随机值&apos; + Math.random())</span><br><span class="line">            this.addTrip(isAdd)</span><br><span class="line">        &#125;, 2000),</span><br><span class="line">        // 添加行程</span><br><span class="line">        async addTrip(isAdd) &#123;</span><br><span class="line">        		// 如果点击+号，添加一个途经点</span><br><span class="line">                const url =</span><br><span class="line">                    isAdd === 1</span><br><span class="line">                        ? `/sub_trip/trip/SetTrip?isAdd=$&#123;isAdd&#125;`</span><br><span class="line">                        : &apos;/sub_trip/trip/SetTrip&apos;</span><br><span class="line">                uni.navigateTo(&#123;</span><br><span class="line">                    url</span><br><span class="line">                &#125;)</span><br><span class="line">        &#125;,</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// pc样式</span><br><span class="line">.pc &#123;</span><br><span class="line">    .operation &#123;</span><br><span class="line">        .add-trip &#123;</span><br><span class="line">            width: calc(100% - 16px);</span><br><span class="line">        &#125;</span><br><span class="line">        .input-area &#123;</span><br><span class="line">            .input-content &#123;</span><br><span class="line">                width: 100%;</span><br><span class="line">                .input-item .input &#123;</span><br><span class="line">                    width: 100%;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">.operation-web &#123;</span><br><span class="line">    bottom: 50px;</span><br><span class="line">&#125;</span><br><span class="line">.operation-mp &#123;</span><br><span class="line">    bottom: 0;</span><br><span class="line">&#125;</span><br><span class="line">.operation &#123;</span><br><span class="line">    width: 100%;</span><br><span class="line">    min-height: 222rpx;</span><br><span class="line">    padding: 32rpx;</span><br><span class="line">    box-sizing: border-box;</span><br><span class="line">    position: absolute;</span><br><span class="line">    background: #f5f7fa;</span><br><span class="line">    box-shadow: 0 0 80rpx 0 rgba(0, 0, 0, 0.08);</span><br><span class="line">    border-radius: 24rpx 24rpx 0 0;</span><br><span class="line"></span><br><span class="line">    .input-area &#123;</span><br><span class="line">        border-radius: 16rpx;</span><br><span class="line">        display: flex;</span><br><span class="line">        align-items: center;</span><br><span class="line">        background: #fff;</span><br><span class="line"></span><br><span class="line">        // 扩大点击热区</span><br><span class="line">        .button &#123;</span><br><span class="line">            width: 88rpx;</span><br><span class="line">            min-height: 88rpx;</span><br><span class="line">            padding: 0 16rpx;</span><br><span class="line">            box-sizing: border-box;</span><br><span class="line">            display: flex;</span><br><span class="line">            align-items: center;</span><br><span class="line">            image &#123;</span><br><span class="line">                width: 40rpx;</span><br><span class="line">                height: 40rpx;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        .input-content &#123;</span><br><span class="line">            width: 558rpx;</span><br><span class="line">            padding: 0 8rpx;</span><br><span class="line">            box-sizing: border-box;</span><br><span class="line">            display: flex;</span><br><span class="line">            flex-direction: column;</span><br><span class="line"></span><br><span class="line">            .input-item &#123;</span><br><span class="line">                height: 90rpx;</span><br><span class="line">                display: flex;</span><br><span class="line">                align-items: center;</span><br><span class="line"></span><br><span class="line">                .input &#123;</span><br><span class="line">                    width: 486rpx;</span><br><span class="line">                    height: 88rpx;</span><br><span class="line">                    line-height: 88rpx;</span><br><span class="line">                    border-bottom: solid 2rpx #f0f2f5;</span><br><span class="line">                    white-space: nowrap;</span><br><span class="line">                    overflow: hidden;</span><br><span class="line">                    text-overflow: ellipsis;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            .kong &#123;</span><br><span class="line">                width: 2rpx;</span><br><span class="line">                height: 37rpx;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            .line &#123;</span><br><span class="line">                height: 37rpx;</span><br><span class="line">                border-left: dashed 2rpx #e6e8eb;</span><br><span class="line">                box-shadow: 0 0 80rpx 0 rgba(0, 0, 0, 0.08);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            .index &#123;</span><br><span class="line">                width: 24rpx;</span><br><span class="line">                height: 24rpx;</span><br><span class="line">                line-height: 24rpx;</span><br><span class="line">                font-size: 18rpx;</span><br><span class="line">                border-radius: 50%;</span><br><span class="line">                text-align: center;</span><br><span class="line">                color: #fff;</span><br><span class="line">                background: #c9ccd1;</span><br><span class="line">                box-shadow: 0 0 80rpx 0 rgba(0, 0, 0, 0.08);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .back &#123;</span><br><span class="line">        /* 去掉水印高度 */</span><br><span class="line">        top: -104rpx;</span><br><span class="line">    &#125;</span><br><span class="line">    .add-trip &#123;</span><br><span class="line">        width: 686rpx;</span><br><span class="line">        margin-top: 32rpx;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="小程序拖拽排序"><a href="#小程序拖拽排序" class="headerlink" title="小程序拖拽排序"></a>小程序拖拽排序</h3><p>页面</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line">&lt;view class=&quot;trip-list&quot;&gt;</span><br><span class="line">                   &lt;!-- 克隆当前拖拽的项 --&gt;</span><br><span class="line">                   &lt;view class=&quot;trip-item kelong&quot;</span><br><span class="line">                       v-if=&quot;showkelong&quot;</span><br><span class="line">                       :style=&quot;&#123; top: top + &apos;px&apos; &#125;&quot;&gt;</span><br><span class="line">                       &lt;view class=&quot;trip-input-area&quot;&gt;</span><br><span class="line">                           &lt;view class=&quot;cricle channel&quot;&gt;&lt;/view&gt;</span><br><span class="line">                           &lt;input v-model=&quot;kelong&quot;</span><br><span class="line">                               placeholder=&quot;请输入地点&quot; /&gt;</span><br><span class="line">                           &lt;image class=&quot;small img&quot;</span><br><span class="line">                               src=&quot;/static/images/index_icon3.png&quot;&gt;&lt;/image&gt;</span><br><span class="line">                       &lt;/view&gt;</span><br><span class="line">                   &lt;/view&gt;</span><br><span class="line">                   &lt;!-- 原来各项 --&gt;</span><br><span class="line">                   &lt;view class=&quot;trip-item&quot;</span><br><span class="line">                       v-for=&quot;(item, index) in tripList&quot;</span><br><span class="line">                       :key=&quot;index&quot;&gt;</span><br><span class="line">                       &lt;view class=&quot;trip-input-area&quot;&gt;</span><br><span class="line">                           &lt;view v-if=&quot;index === 0&quot;</span><br><span class="line">                               class=&quot;cricle start&quot;&gt;&lt;/view&gt;</span><br><span class="line">                           &lt;view v-else-if=&quot;index === tripList.length - 1&quot;</span><br><span class="line">                               class=&quot;cricle end&quot;&gt;&lt;/view&gt;</span><br><span class="line">                           &lt;view v-else</span><br><span class="line">                               class=&quot;cricle channel&quot;&gt;&lt;/view&gt;</span><br><span class="line">                           &lt;input v-if=&quot;index === 0&quot;</span><br><span class="line">                               :value=&quot;item&quot;</span><br><span class="line">                               @input=&quot;getsuggest&quot;</span><br><span class="line">                               @focus=&quot;focus(index)&quot;</span><br><span class="line">                               placeholder=&quot;请输入起点&quot;</span><br><span class="line">                               maxlength=&quot;32&quot;</span><br><span class="line">                               :auto-focus=&quot;autoFocus[0]&quot; /&gt;</span><br><span class="line">                           &lt;input v-else-if=&quot;index === tripList.length - 1&quot;</span><br><span class="line">                               :value=&quot;item&quot;</span><br><span class="line">                               @input=&quot;getsuggest&quot;</span><br><span class="line">                               @focus=&quot;focus(index)&quot;</span><br><span class="line">                               placeholder=&quot;请输入终点&quot;</span><br><span class="line">                               maxlength=&quot;32&quot;</span><br><span class="line">                               :auto-focus=&quot;autoFocus[1]&quot; /&gt;</span><br><span class="line">                           &lt;input v-else</span><br><span class="line">                               :value=&quot;item&quot;</span><br><span class="line">                               @input=&quot;getsuggest&quot;</span><br><span class="line">                               @focus=&quot;focus(index)&quot;</span><br><span class="line">                               placeholder=&quot;请输入途径点&quot;</span><br><span class="line">                               maxlength=&quot;32&quot; /&gt;</span><br><span class="line">                           &lt;!-- 拖拽节点 --&gt;</span><br><span class="line">                           &lt;view class=&quot;drag&quot;</span><br><span class="line">                               :id=&quot;index&quot;</span><br><span class="line">                               @touchstart=&apos;dragStart&apos;</span><br><span class="line">                               @touchmove=&apos;dragMove&apos;</span><br><span class="line">                               @touchend=&apos;dragEnd&apos;&gt;</span><br><span class="line">                               &lt;image class=&quot;small img&quot;</span><br><span class="line">                                   src=&quot;/static/images/index_icon3.png&quot;&gt;&lt;/image&gt;</span><br><span class="line">                           &lt;/view&gt;</span><br><span class="line">                       &lt;/view&gt;</span><br><span class="line">                       &lt;view class=&quot;del&quot;</span><br><span class="line">                           v-if=&quot;tripList.length &gt; 2&quot;</span><br><span class="line">                           @click=&quot;delSpot(index)&quot;&gt;</span><br><span class="line">                           &lt;image class=&quot;small &quot;</span><br><span class="line">                               src=&quot;/static/images/index_icon4.png&quot;&gt;&lt;/image&gt;</span><br><span class="line">                       &lt;/view&gt;</span><br><span class="line">                   &lt;/view&gt;</span><br><span class="line">               &lt;/view&gt;</span><br></pre></td></tr></table></figure>

<p>js</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br></pre></td><td class="code"><pre><span class="line">      kelong: &apos;&apos;, // 当前拖拽项的克隆</span><br><span class="line">      mkelong: &#123;&#125;, // 当前拖拽项的克隆(标记点)</span><br><span class="line">      startTop: 0, //拖拽开始时克隆项距离class=tripList节点顶部边界的值</span><br><span class="line">      top: 0, // 当前拖拽项的top</span><br><span class="line">      selectedIndex: -1, //被选择拖拽的项的index</span><br><span class="line">      showkelong: false, //是否显示克隆项</span><br><span class="line">          </span><br><span class="line">// 拖拽开始</span><br><span class="line">      dragStart(e) &#123;</span><br><span class="line">          // 当前拖拽项的索引index</span><br><span class="line">          let index = e.currentTarget.id</span><br><span class="line">          // 把当前拖拽项的内容复制给kelong</span><br><span class="line">          this.kelong = this.tripList[index]</span><br><span class="line">          this.mkelong = this.markers[index]</span><br><span class="line">          this.selectedIndex = index</span><br><span class="line">          this.showkelong = true</span><br><span class="line">          console.log(&apos;拖拽开始index=&apos;, index, &apos;kelong=&apos;, this.kelong, e)</span><br><span class="line">          let query = uni.createSelectorQuery() // 创建节点查询器 quer</span><br><span class="line">          //选择class=tripList的节点，获取节点位置信息的查询请求</span><br><span class="line">          query</span><br><span class="line">              .select(&apos;.trip-list&apos;)</span><br><span class="line">              .boundingClientRect((rect) =&gt; &#123;</span><br><span class="line">                  console.log(rect)</span><br><span class="line">                  this.top = e.changedTouches[0].clientY - rect.top - 22</span><br><span class="line">                  this.startTop = this.top</span><br><span class="line">              &#125;)</span><br><span class="line">              .exec()</span><br><span class="line">      &#125;,</span><br><span class="line">      // 拖拽移动</span><br><span class="line">      dragMove(e) &#123;</span><br><span class="line">          // console.log(&quot;拖拽移动&quot;, e);</span><br><span class="line">          let query = uni.createSelectorQuery()</span><br><span class="line">          let top = this.top</span><br><span class="line">          query</span><br><span class="line">              .select(&apos;.trip-list&apos;)</span><br><span class="line">              .boundingClientRect((rect) =&gt; &#123;</span><br><span class="line">                  top = e.changedTouches[0].clientY - rect.top - 22</span><br><span class="line">                  if (top &lt; 0) &#123;</span><br><span class="line">                      // 顶部边界控制：控制克隆项不会拖拽出class=tripList节点的顶部边界</span><br><span class="line">                      top = 0</span><br><span class="line">                  &#125;</span><br><span class="line">                  this.top = top</span><br><span class="line">              &#125;)</span><br><span class="line">              .exec()</span><br><span class="line">      &#125;,</span><br><span class="line">      // 拖拽结束</span><br><span class="line">      dragEnd(e) &#123;</span><br><span class="line">          console.log(&apos;拖拽结束&apos;, e)</span><br><span class="line">          let i = e.currentTarget.id</span><br><span class="line">          let query = uni.createSelectorQuery()</span><br><span class="line">          let kelong = this.kelong</span><br><span class="line">          let mkelong = this.mkelong</span><br><span class="line">          let tripList = this.tripList</span><br><span class="line">          let markers = this.markers</span><br><span class="line">          query</span><br><span class="line">              .select(&apos;.trip-list&apos;)</span><br><span class="line">              .boundingClientRect((rect) =&gt; &#123;</span><br><span class="line">                  let top = e.changedTouches[0].clientY - rect.top - 22</span><br><span class="line">                  if (top &gt; rect.height) &#123;</span><br><span class="line">                      // 底部边界控制：控制克隆项拖拽结束时不会出class=tripList节点的底部边界</span><br><span class="line">                      top = rect.height - 44</span><br><span class="line">                  &#125; else if (top &lt; 0) &#123;</span><br><span class="line">                      // 顶部边界控制：控制克隆项拖拽结束时不会出class=tripList节点的顶部边界</span><br><span class="line">                      top = 0</span><br><span class="line">                  &#125;</span><br><span class="line">                  this.top = top</span><br><span class="line">                  let target = parseInt(top / 44)</span><br><span class="line">                  let list = [] //用于备份数据</span><br><span class="line">                  let mlist = [] //用于备份数据</span><br><span class="line">                  if (this.startTop &gt; top) &#123;</span><br><span class="line">                      //  往上方位置拖拽</span><br><span class="line">                      for (let k = 0; k &lt;= i - target; k++) &#123;</span><br><span class="line">                          //  备份插入位置target开始的下方数据，除了拖拽数据项</span><br><span class="line">                          if (tripList[target + k] != kelong) &#123;</span><br><span class="line">                              list.push(tripList[target + k])</span><br><span class="line">                          &#125;</span><br><span class="line">                          if (markers[target + k] != mkelong) &#123;</span><br><span class="line">                              mlist.push(markers[target + k])</span><br><span class="line">                          &#125;</span><br><span class="line">                      &#125;</span><br><span class="line">                      console.log(&apos;往上拖拽 list=======&apos;, list)</span><br><span class="line">                      if (list.lenghth != 0) &#123;</span><br><span class="line">                          tripList[target] = kelong</span><br><span class="line">                          markers[target] = mkelong</span><br><span class="line">                          for (</span><br><span class="line">                              let m = target + 1, n = 0;</span><br><span class="line">                              n &lt; list.length;</span><br><span class="line">                              m++, n++</span><br><span class="line">                          ) &#123;</span><br><span class="line">                              tripList[m] = list[n]</span><br><span class="line">                              markers[m] = mlist[n]</span><br><span class="line">                          &#125;</span><br><span class="line">                      &#125;</span><br><span class="line">                  &#125; else &#123;</span><br><span class="line">                      // 往下边位置拖拽</span><br><span class="line">                      for (let k = 1; k &lt;= target - i; k++) &#123;</span><br><span class="line">                          //  备份插入位置target开始的上方数据，除了拖拽数据项</span><br><span class="line">                          if (tripList[i + k] != kelong) &#123;</span><br><span class="line">                              list.push(tripList[i + k])</span><br><span class="line">                          &#125;</span><br><span class="line">                          if (markers[i + k] != mkelong) &#123;</span><br><span class="line">                              mlist.push(markers[i + k])</span><br><span class="line">                          &#125;</span><br><span class="line">                      &#125;</span><br><span class="line">                      console.log(&apos;往下拖拽 list=======&apos;, list)</span><br><span class="line">                      if (list.length != 0) &#123;</span><br><span class="line">                          tripList[target] = kelong</span><br><span class="line">                          markers[target] = mkelong</span><br><span class="line">                          for (let m = i, n = 0; n &lt; list.length; m++, n++) &#123;</span><br><span class="line">                              tripList[m] = list[n]</span><br><span class="line">                              markers[m] = mlist[n]</span><br><span class="line">                          &#125;</span><br><span class="line">                      &#125;</span><br><span class="line">                  &#125;</span><br><span class="line">                  console.log(tripList, markers)</span><br><span class="line">                  this.tripList = tripList</span><br><span class="line">                  this.markers = markers</span><br><span class="line">                  this.selectedIndex = -1</span><br><span class="line">                  this.showkelong = false</span><br><span class="line">              &#125;)</span><br><span class="line">              .exec()</span><br><span class="line">      &#125;</span><br></pre></td></tr></table></figure>

<p>css</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line">.trip-list &#123;</span><br><span class="line">    position: relative;</span><br><span class="line">    .trip-item &#123;</span><br><span class="line">        margin: 0rpx auto;</span><br><span class="line">        width: 100%;</span><br><span class="line">        /* height: 60px; */</span><br><span class="line">        height: 44px;</span><br><span class="line">        background-color: #fff;</span><br><span class="line">        position: relative;</span><br><span class="line">        display: flex;</span><br><span class="line">        align-items: center;</span><br><span class="line">        .trip-input-area &#123;</span><br><span class="line">            width: 526rpx;</span><br><span class="line">            height: 80rpx;</span><br><span class="line">            padding-left: 16rpx;</span><br><span class="line">            margin: 4rpx 0;</span><br><span class="line">            box-sizing: border-box;</span><br><span class="line">            border-radius: 8rpx;</span><br><span class="line">            display: flex;</span><br><span class="line">            align-items: center;</span><br><span class="line">            position: relative;</span><br><span class="line">            background: #f5f7fa;</span><br><span class="line">            border: solid 1rpx #f0f2f5;</span><br><span class="line">            .cricle &#123;</span><br><span class="line">                width: 16rpx;</span><br><span class="line">                height: 16rpx;</span><br><span class="line">                margin-right: 16rpx;</span><br><span class="line">                border-radius: 50%;</span><br><span class="line">                box-shadow: 0 0 80rpx 0 rgba(0, 0, 0, 0.08);</span><br><span class="line">            &#125;</span><br><span class="line">            .start &#123;</span><br><span class="line">                background: #00cc88;</span><br><span class="line">                border: solid 2rpx #00cc88;</span><br><span class="line">            &#125;</span><br><span class="line">            .channel &#123;</span><br><span class="line">                background: #c9ccd1;</span><br><span class="line">                border: solid 2rpx #c9ccd1;</span><br><span class="line">            &#125;</span><br><span class="line">            .end &#123;</span><br><span class="line">                background: #f25041;</span><br><span class="line">                border: solid 2rpx #f25041;</span><br><span class="line">            &#125;</span><br><span class="line">            input &#123;</span><br><span class="line">                width: 420rpx;</span><br><span class="line">                background: #f5f7fa;</span><br><span class="line">            &#125;</span><br><span class="line">            .drag &#123;</span><br><span class="line">                width: 40rpx;</span><br><span class="line">                height: 56rpx;</span><br><span class="line">                /* 为了扩大可拖拽区域 */</span><br><span class="line">                padding: 16rpx 16rpx 16rpx 0;</span><br><span class="line">            &#125;</span><br><span class="line">            .small &#123;</span><br><span class="line">                width: 24rpx;</span><br><span class="line">                height: 24rpx;</span><br><span class="line">            &#125;</span><br><span class="line">            .img &#123;</span><br><span class="line">                position: absolute;</span><br><span class="line">                right: 16rpx;</span><br><span class="line">                top: 28rpx;</span><br><span class="line">                z-index: 2;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        // 扩大点击热区</span><br><span class="line">        .del &#123;</span><br><span class="line">            height: 44px;</span><br><span class="line">            padding-left: 24rpx;</span><br><span class="line">            display: flex;</span><br><span class="line">            align-items: center;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    .kelong &#123;</span><br><span class="line">        width: 526rpx;</span><br><span class="line">        height: 80rpx;</span><br><span class="line">        background: #f5f7fa;</span><br><span class="line">        z-index: 99;</span><br><span class="line">        position: absolute;</span><br><span class="line">        box-shadow: 1px 1px 5px #ccc;</span><br><span class="line">        .trip-input-area &#123;</span><br><span class="line">            border: 0;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="uniapp小程序用deep重写组件样式不生效"><a href="#uniapp小程序用deep重写组件样式不生效" class="headerlink" title="uniapp小程序用deep重写组件样式不生效"></a>uniapp小程序用deep重写组件样式不生效</h3><p>deep只在h5中生效，但是在小程序中不生效</p>
<p>解决办法：在method同级下添加：</p>
<pre><code>methods: {
},
options: {
    styleIsolation: &apos;shared&apos;
}</code></pre><p>然后再使用deep就可以了，如：</p>
<pre><code>/deep/ .u-modal__title {
    color: red
}</code></pre><h3 id="去掉按钮默认边框"><a href="#去掉按钮默认边框" class="headerlink" title="去掉按钮默认边框"></a>去掉按钮默认边框</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">button::after &#123;</span><br><span class="line">  border: none;</span><br><span class="line">  outline: none;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="input组件样式问题"><a href="#input组件样式问题" class="headerlink" title="input组件样式问题"></a>input组件样式问题</h3><ul>
<li>input组件placeholder-class样式未生效，</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">/deep/.placeholder &#123;</span><br><span class="line">	color: #b0b3b8 !important;</span><br><span class="line">&#125;</span><br><span class="line">/deep/.err &#123;</span><br><span class="line">	color: #f25041 !important;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>input字体大小及样式修改（直接在input里写font-size不生效）</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;view class=&quot;alert&quot;&gt;</span><br><span class="line">	&lt;input v-model=&quot;formData.imei&quot;</span><br><span class="line">		placeholder-class=&quot;placeholder&quot;</span><br><span class="line">		placeholder=&quot;请输入设备号&quot; /&gt;</span><br><span class="line">&lt;/view&gt;</span><br><span class="line"></span><br><span class="line">.alert &#123;</span><br><span class="line">    font-size: 28rpx;</span><br><span class="line">    input &#123;</span><br><span class="line">        padding: 16rpx;</span><br><span class="line">        border-radius: 8rpx;</span><br><span class="line">        background: #f5f7fa;</span><br><span class="line">    &#125;</span><br><span class="line">    /deep/ .placeholder &#123;</span><br><span class="line">        font-size: 28rpx !important;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="v-for循环将index带入class属性中"><a href="#v-for循环将index带入class属性中" class="headerlink" title="v-for循环将index带入class属性中"></a>v-for循环将index带入class属性中</h3><p>使用绑定数组写法 </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;view :class=&quot;[&apos;item&apos;, `img$&#123;index + 1&#125;`]&quot; v-for=&quot;(item,index) in list&quot; :key=&quot;item&quot; @click=&quot;previewImage(index)&quot;&gt;</span><br><span class="line">	&lt;image :src=&quot;item&quot; mode=&quot;widthFix&quot;&gt;&lt;/image&gt;</span><br><span class="line">&lt;/view&gt;</span><br></pre></td></tr></table></figure>

<h3 id="自定义导航"><a href="#自定义导航" class="headerlink" title="自定义导航"></a>自定义导航</h3><p>优点：样式和功能可以自定义，文字可居中（官方居左）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">// 页面级别使用</span><br><span class="line">&#123;</span><br><span class="line">	&quot;path&quot;: &quot;file_detail/file_detail&quot;,</span><br><span class="line">	&quot;style&quot;: &#123;</span><br><span class="line">		&quot;navigationBarTitleText&quot;: &quot;文件详情&quot;,</span><br><span class="line">		&quot;navigationBarTextStyle&quot;: &quot;black&quot;,</span><br><span class="line">		&quot;navigationBarBackgroundColor&quot;: &quot;#ffffff&quot;,</span><br><span class="line">		&quot;navigationStyle&quot;: &quot;custom&quot;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line">// 全局使用</span><br><span class="line">&quot;globalStyle&quot;: &#123;</span><br><span class="line">          &quot;navigationBarTextStyle&quot;: &quot;white&quot;,</span><br><span class="line">          &quot;navigationBarTitleText&quot;: &quot;首页&quot;,</span><br><span class="line">          &quot;navigationBarBackgroundColor&quot;: &quot;#287eff&quot;,</span><br><span class="line">          &quot;backgroundColor&quot;: &quot;#F8F8F8&quot;,</span><br><span class="line">          &quot;navigationStyle&quot;: &quot;custom&quot; //导航栏样式，仅支持 default/custom。</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<p>官方原生的效果肯定比较好好，全局使用自定义导航不太好</p>
<p>比如：页面多了的话，每个页面都需要写导航组件，代码重复；滚动条通顶；塌陷的高度还需要额外处理等缺点。</p>
<h3 id="getSavedFileList返回fileList为空"><a href="#getSavedFileList返回fileList为空" class="headerlink" title="getSavedFileList返回fileList为空"></a>getSavedFileList返回fileList为空</h3><p>wx.getSavedFileList() 是获取【缓存文件】，而 saveFile 存文件操作的是【用户文件】，这是两个不同的文件区划。</p>
<p><a href="https://developers.weixin.qq.com/miniprogram/dev/framework/ability/file-system.html" target="_blank" rel="noopener">https://developers.weixin.qq.com/miniprogram/dev/framework/ability/file-system.html</a></p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="/img/loading.gif" data-original="http://mmbiz.qpic.cn/mmbiz_png/qThSw5b3h8S0fFsh9jB0JFA938QfMrQx5DLNdau88XJCaGc2LMWJemF4DQxKWelbPsFcwASxN2e7yKaaDRACtw/0?wx_fmt=png" alt="img" title>
                </div>
                <div class="image-caption">img</div>
            </figure>

<p>所以应该访问【用户文件】</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">let fs = wx.getFileSystemManager()</span><br><span class="line">fs.readdir(wx.env.USER_DATA_PATH)</span><br></pre></td></tr></table></figure>

<h3 id="小程序使用downloadFile和saveFile-保存文件在本机找不到文件？"><a href="#小程序使用downloadFile和saveFile-保存文件在本机找不到文件？" class="headerlink" title="小程序使用downloadFile和saveFile()保存文件在本机找不到文件？"></a>小程序使用downloadFile和saveFile()保存文件在本机找不到文件？</h3><p>downloadFile和saveFile调用成功后返回的地址都是以wxfile://开头的，这是微信自己的内部存储空间。但是android是可以在本地查询到的：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">内部存储/Android/data/com.tencent.mm/MicroMsg/wxanewfiles/***/文件名，</span><br></pre></td></tr></table></figure>

<p>中间那个***·是个长字符串，不知道是什么规则生成的；ios是无法查询到具体的文件的。</p>
<h3 id="文件下载"><a href="#文件下载" class="headerlink" title="文件下载"></a>文件下载</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br></pre></td><td class="code"><pre><span class="line">&lt;view class=&quot;item&quot; @click=&quot;download&quot; v-if=&quot;!isDownload&quot;&gt;</span><br><span class="line">    &lt;image src=&quot;/static/img/icon_download@3x.png&quot; mode=&quot;widthFix&quot;&gt;&lt;/image&gt;</span><br><span class="line">    &lt;text&gt;下载&lt;/text&gt;</span><br><span class="line">&lt;/view&gt;</span><br><span class="line">&lt;view class=&quot;item&quot; @click=&quot;viewFile&quot; v-if=&quot;isDownload&quot;&gt;</span><br><span class="line">    &lt;image src=&quot;/static/img/icon_downloaded@3x.png&quot; mode=&quot;widthFix&quot;&gt;&lt;/image&gt;</span><br><span class="line">    &lt;text&gt;已下载&lt;/text&gt;</span><br><span class="line">&lt;/view&gt;</span><br><span class="line">            </span><br><span class="line">data() &#123;</span><br><span class="line">        return &#123;</span><br><span class="line">            fs: null, // 文件管理器</span><br><span class="line">            filePath: `$&#123;wx.env.USER_DATA_PATH&#125;/my/2021_PDF.pdf`, // 文件存放路径</span><br><span class="line">            isDownload: false, // 该文件是否已下载</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;,</span><br><span class="line">    </span><br><span class="line">onLoad(options) &#123;</span><br><span class="line">        console.log(options);</span><br><span class="line">        // 获取FileSystemManger的全局唯一文件管理器</span><br><span class="line">        this.fs = uni.getFileSystemManager();</span><br><span class="line">        this.judgeDownload();</span><br><span class="line">    &#125;,</span><br><span class="line">    </span><br><span class="line">		// 判断文件是否已下载</span><br><span class="line">        judgeDownload() &#123;</span><br><span class="line">            const _this = this;</span><br><span class="line">            // 检查本地文件夹是否存在</span><br><span class="line">            this.fs.access(&#123;</span><br><span class="line">                path: `$&#123;wx.env.USER_DATA_PATH&#125;/my`,</span><br><span class="line">                success(res) &#123;</span><br><span class="line">                    console.log(&quot;有my文件夹&quot;, res);</span><br><span class="line">                    // 检查本地该文件是否存在</span><br><span class="line">                    _this.fs.access(&#123;</span><br><span class="line">                        path: _this.filePath,</span><br><span class="line">                        success(res) &#123;</span><br><span class="line">                            console.log(&quot;有该文件&quot;, res);</span><br><span class="line">                            _this.isDownload = true;</span><br><span class="line">                        &#125;,</span><br><span class="line">                        fail(err) &#123;</span><br><span class="line">                            console.log(&quot;没有该文件&quot;, err);</span><br><span class="line">                        &#125;,</span><br><span class="line">                    &#125;);</span><br><span class="line">                    // 文件列表中可以用这个判断</span><br><span class="line">                    // _this.fs.readdir(&#123;</span><br><span class="line">                    //     dirPath: `$&#123;wx.env.USER_DATA_PATH&#125;/my`,</span><br><span class="line">                    //     success(res) &#123;</span><br><span class="line">                    //         console.log(res, &quot;用户本地my目录文件列表&quot;);</span><br><span class="line">                    //     &#125;,</span><br><span class="line">                    //     fail(res) &#123;</span><br><span class="line">                    //         console.error(res);</span><br><span class="line">                    //     &#125;,</span><br><span class="line">                    // &#125;);</span><br><span class="line">                &#125;,</span><br><span class="line">                fail(err) &#123;</span><br><span class="line">                    console.log(&quot;没my有文件夹&quot;, err);</span><br><span class="line">                    // 不存在执行创建文件夹，便于后续下载</span><br><span class="line">                    _this.mkdir();</span><br><span class="line">                &#125;,</span><br><span class="line">            &#125;);</span><br><span class="line">            console.log(wx.env.USER_DATA_PATH);</span><br><span class="line">        &#125;,</span><br><span class="line">        // 创建文件夹，便于区分本小程序下载的文件</span><br><span class="line">        mkdir() &#123;</span><br><span class="line">            this.fs.mkdir(&#123;</span><br><span class="line">                dirPath: `$&#123;wx.env.USER_DATA_PATH&#125;/my`,</span><br><span class="line">                success(res) &#123;</span><br><span class="line">                    console.log(&quot;创建文件夹成功&quot;, res);</span><br><span class="line">                &#125;,</span><br><span class="line">                fail(err) &#123;</span><br><span class="line">                    console.log(&quot;创建文件夹失败&quot;, err);</span><br><span class="line">                &#125;,</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;,</span><br><span class="line">        </span><br><span class="line">		// 下载文件</span><br><span class="line">        download() &#123;</span><br><span class="line">            const downloadTask = uni.downloadFile(&#123;</span><br><span class="line">                url: &quot;http://www.gov.cn/zhengce/pdfFile/2021_PDF.pdf&quot;,</span><br><span class="line">                success: (res) =&gt; &#123;</span><br><span class="line">                    console.log(res);</span><br><span class="line">                    if (res.statusCode === 200) &#123;</span><br><span class="line">                        uni.showToast(&#123;</span><br><span class="line">                            title: &quot;下载成功&quot;,</span><br><span class="line">                            icon: &quot;none&quot;,</span><br><span class="line">                        &#125;);</span><br><span class="line">                        console.log(res.tempFilePath);</span><br><span class="line">                        // res.filePath和res.tempFilePath路径一致，这样做是为了防止IOS中报错：No tempFilePath</span><br><span class="line">                        const tempFilePath = res.tempFilePath || res.filePath;</span><br><span class="line">                        this.fs.saveFile(&#123;</span><br><span class="line">                            tempFilePath,</span><br><span class="line">                            // 临时文件保存到用户本地并且重命名，不加文件名的话会导致下载的文件没有后缀打不开</span><br><span class="line">                            filePath: this.filePath,</span><br><span class="line">                            success: (res) =&gt; &#123;</span><br><span class="line">                                console.log(res, &quot;本地路径&quot;);</span><br><span class="line">                                this.isDownload = true;</span><br><span class="line">                                // 下载后跳转查看</span><br><span class="line">                                this.viewFile();</span><br><span class="line">                            &#125;,</span><br><span class="line">                            fail: (res) =&gt; &#123;</span><br><span class="line">                                console.log(res);</span><br><span class="line">                            &#125;,</span><br><span class="line">                        &#125;);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;,</span><br><span class="line">                fail: (res) =&gt; &#123;</span><br><span class="line">                    uni.showToast(&#123;</span><br><span class="line">                        title: &quot;下载失败，请重试&quot;,</span><br><span class="line">                        icon: &quot;none&quot;,</span><br><span class="line">                        duration: 2000,</span><br><span class="line">                    &#125;);</span><br><span class="line">                    console.log(res);</span><br><span class="line">                &#125;,</span><br><span class="line">                // 接口调用结束</span><br><span class="line">                complete: () =&gt; &#123;</span><br><span class="line">                    // 关闭进度提示</span><br><span class="line">                    uni.hideLoading();</span><br><span class="line">                    // 取消监听加载进度</span><br><span class="line">                    downloadTask.offProgressUpdate();</span><br><span class="line">                &#125;,</span><br><span class="line">            &#125;);</span><br><span class="line">            downloadTask.onProgressUpdate((res) =&gt; &#123;</span><br><span class="line">                console.log(&quot;下载进度&quot; + res.progress);</span><br><span class="line">                uni.showLoading(&#123;</span><br><span class="line">                    mask: true, // 显示透明蒙层，防止触摸穿透</span><br><span class="line">                    title: &quot;下载中...&quot; + res.progress + &quot;%&quot;,</span><br><span class="line">                &#125;);</span><br><span class="line">                // console.log(&quot;已经下载的数据长度&quot; + res.totalBytesWritten);</span><br><span class="line">                // console.log(</span><br><span class="line">                //     &quot;预期需要下载的数据总长度&quot; + res.totalBytesExpectedToWrite</span><br><span class="line">                // );</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;,</span><br><span class="line">        // 查看原文件</span><br><span class="line">        viewFile() &#123;</span><br><span class="line">            uni.openDocument(&#123;</span><br><span class="line">                filePath: this.filePath,</span><br><span class="line">                showMenu: true,</span><br><span class="line">                success: (res) =&gt; &#123;</span><br><span class="line">                    console.log(&quot;打开文档成功&quot;, res);</span><br><span class="line">                &#125;,</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;,</span><br></pre></td></tr></table></figure>

<p>小bug：</p>
<p>文件下载名称不能过长，官方会提示太长导致下载失败；不超过80字可以正常下载，90字就下载失败了</p>
<p>关闭console调试下载失败问题：需要在小程序后台配置downloadFile合法域名（测试、正式两个地址）</p>
<h3 id="微信小程序预览文件"><a href="#微信小程序预览文件" class="headerlink" title="微信小程序预览文件"></a>微信小程序预览文件</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">// 微信小程序预览文件</span><br><span class="line">      openDocument(url) &#123;</span><br><span class="line">          uni.downloadFile(&#123;</span><br><span class="line">              url, // 要预览的PDF的地址</span><br><span class="line">              // 保存到用户本地并且重命名，不加文件名的话会导致下载的文件没有后缀打不开</span><br><span class="line">              filePath: `$&#123;wx.env.USER_DATA_PATH&#125;/$&#123;this.protoName&#125;.pdf`, // 文件存放路径</span><br><span class="line">              success(res) &#123;</span><br><span class="line">                  console.log(res)</span><br><span class="line">                  if (res.statusCode === 200) &#123;</span><br><span class="line">                      // 成功</span><br><span class="line">                      uni.openDocument(&#123;</span><br><span class="line">                          filePath: res.filePath, // 要打开的文件路径</span><br><span class="line">                          showMenu: true, // 是否显示右上角菜单</span><br><span class="line">                          success(res) &#123;</span><br><span class="line">                              // console.log(&quot;打开成功&quot;);</span><br><span class="line">                          &#125;,</span><br><span class="line">                          fail(res) &#123;</span><br><span class="line">                              // console.log(&quot;打开失败&quot;);</span><br><span class="line">                          &#125;</span><br><span class="line">                      &#125;)</span><br><span class="line">                  &#125;</span><br><span class="line">              &#125;,</span><br><span class="line">              fail(res) &#123;</span><br><span class="line">                  console.log(res) //失败</span><br><span class="line">              &#125;</span><br><span class="line">          &#125;)</span><br><span class="line">      &#125;,</span><br></pre></td></tr></table></figure>

<h3 id="uniapp-子组件监听页面onShow"><a href="#uniapp-子组件监听页面onShow" class="headerlink" title="uniapp 子组件监听页面onShow"></a>uniapp 子组件监听页面onShow</h3><p>uniapp 开发的时候，需要子组件监听onShow事件，但是子组件没有办法直接监听onShow，我们可以通过页面监听，当页面监听到以后发送通知，子组件监听通知，收到通知后触发事件就可以了。</p>
<p>页面代码 </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">onShow() &#123;</span><br><span class="line">    // 触发全局的自定义事件，用于子组件监听onShow</span><br><span class="line">	uni.$emit(&apos;onShow&apos;, 1);</span><br><span class="line">&#125;,</span><br><span class="line">//触底监听</span><br><span class="line">onReachBottom() &#123;</span><br><span class="line">	uni.$emit(&apos;onReachBottom&apos;, 1);</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<p>子组件监听</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">mounted() &#123;</span><br><span class="line">	// 监听主页面onShow事件</span><br><span class="line">	uni.$on(&apos;onShow&apos;, function(data) &#123;</span><br><span class="line">		console.log(data);</span><br><span class="line">	&#125;);</span><br><span class="line">	uni.$on(&apos;onReachBottom&apos;, function(data) &#123;</span><br><span class="line">		console.log(data);</span><br><span class="line">	&#125;);</span><br><span class="line">&#125;</span><br><span class="line">// 为了避免重复监听，在组件销毁前，关闭监听</span><br><span class="line">beforeDestroy()&#123;</span><br><span class="line">	uni.$off(&apos;onReachBottom&apos;)</span><br><span class="line">	uni.$off(&apos;onShow&apos;)</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<h3 id="组件中从本地目录文件判断列表文件是否已下载"><a href="#组件中从本地目录文件判断列表文件是否已下载" class="headerlink" title="组件中从本地目录文件判断列表文件是否已下载"></a>组件中从本地目录文件判断列表文件是否已下载</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line">mounted() &#123;</span><br><span class="line">	// 获取FileSystemManger的全局唯一文件管理器</span><br><span class="line">	this.fs = uni.getFileSystemManager();</span><br><span class="line">	// 首次监听不到onShow，所以需调用一次</span><br><span class="line">	this.readdir()</span><br><span class="line">	const _that = this;</span><br><span class="line">	// 监听主页面onShow事件</span><br><span class="line">	uni.$on(&apos;onShow&apos;, function(data) &#123;</span><br><span class="line">		console.log(data);</span><br><span class="line">		// 如果用户切换到文件管理去删除文件或目录，也能实时判断</span><br><span class="line">		_that.readdir()</span><br><span class="line">	&#125;);</span><br><span class="line">&#125;</span><br><span class="line">beforeDestroy()&#123;</span><br><span class="line">	// 为了避免重复监听，在组件销毁前，关闭监听</span><br><span class="line">	uni.$off(&apos;onShow&apos;)</span><br><span class="line">&#125;,</span><br><span class="line"></span><br><span class="line">// 读取本地目录内文件列表</span><br><span class="line">	readdir()&#123;</span><br><span class="line">		const _this = this</span><br><span class="line">		this.fs.readdir(&#123;</span><br><span class="line">			dirPath: `$&#123;wx.env.USER_DATA_PATH&#125;/my`,</span><br><span class="line">			success(res) &#123;</span><br><span class="line">				console.log(res, &quot;用户本地my目录文件列表&quot;);</span><br><span class="line">				_this.downloadFiles = res.files</span><br><span class="line">				_this.judgeDownload()</span><br><span class="line">			&#125;,</span><br><span class="line">			fail(res) &#123;</span><br><span class="line">				console.error(res);</span><br><span class="line">			&#125;,</span><br><span class="line">		&#125;);</span><br><span class="line">	&#125;,</span><br><span class="line">	// 判断文件是否已下载(首次data为空不影响，第一次获取到数据，查看更多时只判断新加载的数据，onShow触发时重新实时判断)</span><br><span class="line">      	judgeDownload(data = this.profileList) &#123;</span><br><span class="line">      		data.forEach(item =&gt; &#123;</span><br><span class="line">			let res = this.downloadFiles.find( it =&gt; it === item.title)</span><br><span class="line">			console.log(res)</span><br><span class="line">			if(res)&#123;</span><br><span class="line">				item.isDown = true</span><br><span class="line">			&#125; else &#123;</span><br><span class="line">				// 避免本地删除后不更新状态</span><br><span class="line">				item.isDown = false</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;);</span><br><span class="line">		// 下面这种看似正常，但在else时存在问题，记录一下（有bug禁用）</span><br><span class="line">		this.downloadFiles.forEach(item =&gt; &#123;</span><br><span class="line">			data.forEach(it =&gt; &#123;</span><br><span class="line">				if(item === it.title)&#123;</span><br><span class="line">					it.isDown = true</span><br><span class="line">				&#125; else &#123;</span><br><span class="line">					// 避免本地删除后不更新状态</span><br><span class="line">					it.isDown = false</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;);</span><br><span class="line">		&#125;);</span><br><span class="line">	&#125;,</span><br></pre></td></tr></table></figure>

<h3 id="JS中find方法"><a href="#JS中find方法" class="headerlink" title="JS中find方法"></a>JS中find方法</h3><ul>
<li>find() 方法返回通过测试（函数内判断）的数组的第一个元素的值。</li>
<li>如果没有符合条件的元素返回 undefined</li>
<li>find() 对于空数组，函数是不会执行的。</li>
<li>find() 并没有改变数组的原始值。</li>
<li>array.find(function(currentValue, index, arr),thisValue)，其中currentValue为当前项，index为当前索引，arr为当前数组</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">let test = [1, 2, 3, 4, 5];</span><br><span class="line">let a = test.find(item =&gt; item &gt; 3);</span><br><span class="line">console.log(a); //4</span><br><span class="line"> </span><br><span class="line">let b = test.find(item =&gt; item == 0);</span><br><span class="line">console.log(b); //undefined</span><br></pre></td></tr></table></figure>

<h3 id="小程序onShareTimeline-分享朋友圈"><a href="#小程序onShareTimeline-分享朋友圈" class="headerlink" title="小程序onShareTimeline()分享朋友圈"></a>小程序onShareTimeline()分享朋友圈</h3><p>只写onShareTimeline不生效，有点坑，有两种方法：</p>
<p>1.onLoad或者onReady中使用wx.showShareMenu，必须两个菜单都写上朋友圈才生效</p>
<p>2.写个onShareAppMessage空函数里面啥也不写也行</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">	data:&#123;</span><br><span class="line">	&#125;,</span><br><span class="line">	// 生命周期函数--监听页面加载</span><br><span class="line">    onLoad: function(options) &#123;</span><br><span class="line">    	// 要先在这里设置menus的两个参数,才可以分享朋友圈</span><br><span class="line">    	wx.showShareMenu(&#123;</span><br><span class="line">	      withShareTicket: true,</span><br><span class="line">	      menus: [&apos;shareAppMessage&apos;, &apos;shareTimeline&apos;]</span><br><span class="line">	    &#125;)</span><br><span class="line">    &#125;,</span><br><span class="line">	// 用户点击右上角分享给好友</span><br><span class="line">	onShareAppMessage: function() &#123;</span><br><span class="line">		</span><br><span class="line">	&#125;,</span><br><span class="line">	// 用户点击右上角分享朋友圈</span><br><span class="line">	onShareTimeline: function () &#123;</span><br><span class="line">		return &#123;</span><br><span class="line">	      title: &apos;&apos;,</span><br><span class="line">	      query: &#123;</span><br><span class="line">	        key: value</span><br><span class="line">	      &#125;,</span><br><span class="line">	      imageUrl: &apos;&apos;</span><br><span class="line">	    &#125;</span><br><span class="line">	&#125;,</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="无法通过自己的按钮触发“分享到朋友圈”和“收藏”"><a href="#无法通过自己的按钮触发“分享到朋友圈”和“收藏”" class="headerlink" title="无法通过自己的按钮触发“分享到朋友圈”和“收藏”"></a>无法通过自己的按钮触发“分享到朋友圈”和“收藏”</h3><p>转发到朋友圈、收藏到微信收藏 只能通过点击右上角三个点操作，无法通过自己写的按钮触发，可以用类似于分享到企微的引导弹窗实现</p>
<p>不过可以监听右上角菜单“分享到朋友圈”、“收藏”按钮的点击行为，并可以自定义标题和图片<br><a href="https://developers.weixin.qq.com/community/develop/doc/0002c42d65c4401925cef764c58c00" target="_blank" rel="noopener">https://developers.weixin.qq.com/community/develop/doc/0002c42d65c4401925cef764c58c00</a></p>
<h3 id="标签切换"><a href="#标签切换" class="headerlink" title="标签切换"></a>标签切换</h3><p>常规写法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">&lt;view class=&quot;tags-list&quot;&gt;</span><br><span class="line">            &lt;view :class=&quot;item.checked?&apos;active tags-item&apos;:&apos;tags-item&apos;&quot; v-for=&quot;(item,index) in tagsList&quot; :key=&quot;item.name&quot; @click=&quot;switchTags(index)&quot;&gt;&#123;&#123; item.name &#125;&#125;</span><br><span class="line">            &lt;/view&gt;</span><br><span class="line">        &lt;/view&gt;</span><br><span class="line">        </span><br><span class="line">				tagsList: [</span><br><span class="line">                    &#123;</span><br><span class="line">                        name: &quot;全部&quot;,</span><br><span class="line">                        checked: true,</span><br><span class="line">                    &#125;,</span><br><span class="line">                    &#123;</span><br><span class="line">                        name: &quot;分类1&quot;,</span><br><span class="line">                        checked: false,</span><br><span class="line">                    &#125;,</span><br><span class="line">                    &#123;</span><br><span class="line">                        name: &quot;分类2&quot;,</span><br><span class="line">                        checked: false,</span><br><span class="line">                    &#125;,</span><br><span class="line">                    &#123;</span><br><span class="line">                        name: &quot;分类3&quot;,</span><br><span class="line">                        checked: false,</span><br><span class="line">                    &#125;,</span><br><span class="line">            	],</span><br><span class="line">            	</span><br><span class="line">		// 切换分类</span><br><span class="line">        switchTags(ind) &#123;</span><br><span class="line">            // 重新判断是否选中</span><br><span class="line">            this.tagsList.forEach((item, index) =&gt; &#123;</span><br><span class="line">                item.checked = false;</span><br><span class="line">                if (ind === index) &#123;</span><br><span class="line">                    item.checked = true;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">            if (ind === 0) &#123;</span><br><span class="line">                console.log(ind);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        </span><br><span class="line"> 	.active &#123;</span><br><span class="line">        font-weight: bold;</span><br><span class="line">        position: relative;</span><br><span class="line">        transition: all 0.2s;</span><br><span class="line">    &#125;</span><br><span class="line">    .active::after &#123;</span><br><span class="line">        content: &quot;&quot;;</span><br><span class="line">        width: 62.5%;</span><br><span class="line">        height: 6rpx;</span><br><span class="line">        border-radius: 3rpx;</span><br><span class="line">        position: absolute;</span><br><span class="line">        left: 18.75%; // 50-62.5/2</span><br><span class="line">        bottom: 0;</span><br><span class="line">        background: #247bff;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>通过selectedIndex来控制选中项更加简单：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">&lt;view class=&quot;tags-list&quot;&gt;</span><br><span class="line">            &lt;view :class=&quot;checked===index?&apos;active tags-item&apos;:&apos;tags-item&apos;&quot; v-for=&quot;(item,index) in tagsList&quot; :key=&quot;item.name&quot; @click=&quot;switchTags(index)&quot;&gt;&#123;&#123; item.name &#125;&#125;</span><br><span class="line">            &lt;/view&gt;</span><br><span class="line">        &lt;/view&gt;</span><br><span class="line">        </span><br><span class="line">			// 分类列表</span><br><span class="line">            tagsList: [</span><br><span class="line">                &#123;</span><br><span class="line">                    name: &quot;全部&quot;,</span><br><span class="line">                &#125;,</span><br><span class="line">                &#123;</span><br><span class="line">                    name: &quot;分类1&quot;,</span><br><span class="line">                &#125;,</span><br><span class="line">                &#123;</span><br><span class="line">                    name: &quot;分类2&quot;,</span><br><span class="line">                &#125;,</span><br><span class="line">                &#123;</span><br><span class="line">                    name: &quot;分类3&quot;,</span><br><span class="line">                &#125;,</span><br><span class="line">            ],</span><br><span class="line">            checked: 0, // 选中项</span><br><span class="line">            </span><br><span class="line">            // 切换分类</span><br><span class="line">        switchTags(index) &#123;</span><br><span class="line">            this.checked = index; // 选中当前项</span><br><span class="line">            if (index === 0) &#123;</span><br><span class="line">                console.log(index);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br></pre></td></tr></table></figure>

<h3 id="搜索历史保存"><a href="#搜索历史保存" class="headerlink" title="搜索历史保存"></a>搜索历史保存</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">// 点击完成按钮时触发</span><br><span class="line">      confirm() &#123;</span><br><span class="line">          console.log(this.value, this.historicalFiles);</span><br><span class="line">          // 如果缓存中有此记录，就先删除再加入</span><br><span class="line">          this.historicalFiles.forEach((item, index) =&gt; &#123;</span><br><span class="line">              if (item === this.value) &#123;</span><br><span class="line">                  this.historicalFiles.splice(index, 1);</span><br><span class="line">              &#125;</span><br><span class="line">          &#125;);</span><br><span class="line">          this.historicalFiles.unshift(this.value);</span><br><span class="line">          if (this.historicalFiles.length &gt;= 15) &#123;</span><br><span class="line">              this.historicalFiles.length = 15; // 限制数组长度</span><br><span class="line">          &#125;</span><br><span class="line">          this.$store.commit(&quot;setHistoricalFiles&quot;, this.historicalFiles);</span><br><span class="line">      &#125;,</span><br></pre></td></tr></table></figure>

<h3 id="图片懒加载"><a href="#图片懒加载" class="headerlink" title="图片懒加载"></a>图片懒加载</h3><p>我们在用 <code>uni-app</code> 开发微信小程序时，一般都离不开图片组件 <code>image</code>，如果图片多的时候，为了提升用户体验，都会做懒加载处理。那么，我们应该如何实现图片懒加载呢？</p>
<p>通过查看 <a href="https://uniapp.dcloud.io/component/image.html" target="_blank" rel="noopener">uni-app 相关文档</a> 和 <a href="https://developers.weixin.qq.com/miniprogram/dev/component/image.html" target="_blank" rel="noopener">微信小程序相关文档</a>，有如下属性：</p>
<table>
<thead>
<tr>
<th align="left">属性名</th>
<th align="left">类型</th>
<th align="left">默认值</th>
<th align="left">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="left">lazy-load</td>
<td align="left">Boolean</td>
<td align="left">false</td>
<td align="left">图片懒加载，在即将进入一定范围（上下三屏）时才开始加载</td>
</tr>
</tbody></table>
<p>因此，我们只需在 <code>image</code> 属性中增加该属性就可以了，具体如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;image lazy-load :src=&quot;item.pic&quot; /&gt;</span><br></pre></td></tr></table></figure>

<p>小伙伴们可能会感觉加入 <code>lazy-load</code> 属性后，好像懒加载没有生效。其实这只是个错觉，因为按文档所述，小程序会提前加载上下三屏的图片，导致无法感知懒加载的存在。其实 <code>image</code> 组件还有个如下隐藏的属性，官方文档里面没有标出来（可以在开发文档搜索“<a href="https://developers.weixin.qq.com/community/develop/doc/000a4ce83905e06823589c90651414" target="_blank" rel="noopener">image 组件支持设置预加载屏数</a>”查看）</p>
<p>默认情况下， image 组件 lazy-load 的阈值是 2 屏，也就是当图片距当前屏幕边界为 2 屏之外，图片会马上加载。不同场景可能对该阈值有不同要求，因此计划新增一个属性可以设置该阈值。文档没更新，但是可以使用了。</p>
<p>lazy-load-margin 值指代阈值，如lazy-load-margin=”0.5”，是距离视口0.5屏时再开始加载资源</p>
<table>
<thead>
<tr>
<th align="left">属性名</th>
<th align="left">类型</th>
<th align="left">默认值</th>
<th align="left">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="left">lazy-load-margin</td>
<td align="left">Number</td>
<td align="left">—</td>
<td align="left">图片懒加载屏数阈值，在即将进入设置的屏数才开始加载</td>
</tr>
</tbody></table>
<p>为了能更清楚的确认懒加载是否生效，我们通过将 <code>lazy-load-margin</code> 设置为 <code>0</code>，再看效果，代码如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;image :src=&quot;item&quot; mode=&quot;widthFix&quot; lazy-load=&quot;true&quot; lazy-load-margin=&quot;0&quot; @load=&quot;load&quot;&gt;&lt;/image&gt;</span><br><span class="line"></span><br><span class="line">// 只需查看本事件触发即可知道image的加载情况</span><br><span class="line">load(e) &#123;</span><br><span class="line">	console.log(e);</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<p>通过设置 <code>lazy-load-margin</code>，并结合 <code>微信开发者工具</code> 调试器中的 <code>Network</code>，我们可以很清楚的观察到懒加载的效果了。</p>
<p>另外，可以通过 <code>lazy-load-margin</code> 灵活设置懒加载屏数阈值。</p>
<p><strong>注意：</strong>图片懒加载只针对 <code>page</code> 与 <code>scroll-view</code> 下的 <code>image</code> 有效。</p>
<p>所有的<strong>注册页面</strong>讲道理都在page 之下，注意这个是<strong>注册页面</strong>，而不是组件等。不过通常情况下组件也会在页面上被使用，里面的image自然也会在page之下</p>
<h3 id="关键词精准匹配高亮"><a href="#关键词精准匹配高亮" class="headerlink" title="关键词精准匹配高亮"></a>关键词精准匹配高亮</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * 关键词精准匹配高亮</span><br><span class="line"> * @param &#123;String&#125; keyword 关键词</span><br><span class="line"> * @param &#123;String&#125; target 原数据</span><br><span class="line"> * */</span><br><span class="line">utils.highLight = (keyword, target) =&gt; &#123;</span><br><span class="line">    const reg1 = new RegExp(&quot;-&quot;, &quot;gi&quot;);</span><br><span class="line">    const keywords = keyword.replace(reg1, &quot;\\-&quot;)</span><br><span class="line">    const reg = new RegExp(keywords, &quot;gi&quot;);</span><br><span class="line">    // 对原数据中的每一项都做正则匹配，得到高亮之后的字符串</span><br><span class="line">    const hLight = target.replace(</span><br><span class="line">        reg,</span><br><span class="line">        (val) =&gt; `&lt;span style=&quot;color:#FEAA00&quot;&gt;$&#123;val&#125;&lt;/span&gt;`</span><br><span class="line">    )</span><br><span class="line">    return hLight</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">computed: &#123;</span><br><span class="line">        // 精准匹配</span><br><span class="line">        highLight() &#123;</span><br><span class="line">            return (data) =&gt; &#123;</span><br><span class="line">                return utils.highLight(this.keyword, data);</span><br><span class="line">            &#125;;</span><br><span class="line">        &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">   </span><br><span class="line">&lt;view class=&quot;name&quot; v-html=&quot;highLight(item.title)&quot;&gt;&lt;/view&gt;</span><br></pre></td></tr></table></figure>

<h3 id="uniapp获取元素高度"><a href="#uniapp获取元素高度" class="headerlink" title="uniapp获取元素高度"></a>uniapp获取元素高度</h3><p>在页面渲染完成OnReady回调，获取元素高度时，如果不加定时器，获取的元素的高度还是<strong>没渲染完异步数据</strong>前的高度。故需要加定时器 </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&lt;view class=&quot;list&quot;&gt;</span><br><span class="line">            &lt;view :class=&quot;[&apos;item&apos;, `img$&#123;index&#125;`]&quot; v-for=&quot;(item,index) in list&quot; :key=&quot;item&quot; @click=&quot;previewImage(index)&quot;&gt;</span><br><span class="line">                &lt;image :src=&quot;item&quot; mode=&quot;widthFix&quot; lazy-load=&quot;true&quot; lazy-load-margin=&quot;1&quot; @load=&quot;load&quot;&gt;&lt;/image&gt;</span><br><span class="line">            &lt;/view&gt;</span><br><span class="line">        &lt;/view&gt;</span><br><span class="line">		</span><br><span class="line">		// 初始化数据</span><br><span class="line">        init() &#123;</span><br><span class="line">        	// 获取数据后再调用</span><br><span class="line">            this.getImageHeight();</span><br><span class="line">        &#125;,</span><br><span class="line">        // 获取第一个图片所在元素的高度，用于页码计算</span><br><span class="line">        getImageHeight() &#123;</span><br><span class="line">            // 加延时才能获取到实际的高度</span><br><span class="line">            setTimeout(() =&gt; &#123;</span><br><span class="line">                const query = uni.createSelectorQuery();</span><br><span class="line">                query</span><br><span class="line">                    .select(&quot;.img0&quot;)</span><br><span class="line">                    .boundingClientRect((res) =&gt; &#123;</span><br><span class="line">                        this.imageHeight = res.height;</span><br><span class="line">                        console.log(res, &quot;第一个图片&quot;);</span><br><span class="line">                    &#125;)</span><br><span class="line">                    .exec();</span><br><span class="line">            &#125;, 500);</span><br><span class="line">        &#125;,</span><br></pre></td></tr></table></figure>

<h3 id="滚动到指定元素"><a href="#滚动到指定元素" class="headerlink" title="滚动到指定元素"></a>滚动到指定元素</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">// 点击目录将页面滚动到对应位置</span><br><span class="line">      pageScrollTo(index) &#123;</span><br><span class="line">          this.isShowCatalogue = false;</span><br><span class="line">          uni.pageScrollTo(&#123;</span><br><span class="line">              selector: &quot;.img&quot; + index,</span><br><span class="line">              // 状态栏+导航栏+头部固定区域的高度为偏移量</span><br><span class="line">              offsetTop: -this.headerHeight - 80,</span><br><span class="line">          &#125;);</span><br><span class="line">      &#125;,</span><br></pre></td></tr></table></figure>

<h3 id="监听用户滑动页面事件，判断当前页码"><a href="#监听用户滑动页面事件，判断当前页码" class="headerlink" title="监听用户滑动页面事件，判断当前页码"></a>监听用户滑动页面事件，判断当前页码</h3><p>第一种：整页所有图片高度一样可以使用</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">// 监听用户滑动页面事件，判断当前页码</span><br><span class="line">   onPageScroll(e) &#123;</span><br><span class="line">       if (e.scrollTop &gt; 0) &#123;</span><br><span class="line">           // 小数向上取整 + this.headerHeight + 80</span><br><span class="line">           this.currentPage = Math.ceil((e.scrollTop + 80) / this.imageHeight);</span><br><span class="line">       &#125;</span><br><span class="line">       console.log(e, this.imageHeight, this.currentPage);</span><br><span class="line">   &#125;,</span><br></pre></td></tr></table></figure>

<p>Math.ceil() 函数总是四舍五入并返回大于等于给定数字的最小整数。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">console.log(Math.ceil(.95));</span><br><span class="line">// expected output: 1</span><br><span class="line"></span><br><span class="line">console.log(Math.ceil(4));</span><br><span class="line">// expected output: 4</span><br><span class="line"></span><br><span class="line">console.log(Math.ceil(7.004));</span><br><span class="line">// expected output: 8</span><br><span class="line"></span><br><span class="line">console.log(Math.ceil(-7.004));</span><br><span class="line">// expected output: -7</span><br></pre></td></tr></table></figure>

<p>第二种：尝试用循环获取元素高度，因为图片并没有都加载完，后面获取到的高度都一样，以失败告终</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">// 加延时才能获取到实际的高度</span><br><span class="line">setTimeout(() =&gt; &#123;</span><br><span class="line">	this.getImageHeight();</span><br><span class="line">&#125;, 500);</span><br><span class="line">    </span><br><span class="line">// 获取第一个图片所在元素的高度，用于页码计算</span><br><span class="line">async getImageHeight() &#123;</span><br><span class="line">    for (let i = 0; i &lt; this.list.length; i++) &#123;</span><br><span class="line">        const query = uni.createSelectorQuery();</span><br><span class="line">        let start, end;</span><br><span class="line">        await query</span><br><span class="line">            .select(&quot;.img&quot; + i)</span><br><span class="line">            .boundingClientRect(async (res) =&gt; &#123;</span><br><span class="line">                start = i &gt; 0 ? this.imageHeight[i - 1].end : 0;</span><br><span class="line">                end = res.height;</span><br><span class="line">                this.imageHeight.push(&#123; start, end &#125;);</span><br><span class="line">                console.log(res, &quot;图片高度&quot; + i, this.imageHeight);</span><br><span class="line">            &#125;)</span><br><span class="line">            .exec();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<p>最终版：通过load触发（思路：循环获取图片每一个top(可用load)，存一个数组里，依次精确计算当前页码。）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">   screenWidth: getApp().globalData.screenWidth, // 屏幕实际宽度</span><br><span class="line">   list: [],</span><br><span class="line">   imageHeight: [], // 图片高度</span><br><span class="line">   scrollTop: 0,</span><br><span class="line"></span><br><span class="line">   computed: &#123;</span><br><span class="line">       // 当前页码</span><br><span class="line">       currentPage() &#123;</span><br><span class="line">           let page;</span><br><span class="line">           this.imageHeight.forEach((item, index) =&gt; &#123;</span><br><span class="line">               if (</span><br><span class="line">                   this.scrollTop &gt;= item.start &amp;&amp;</span><br><span class="line">                   this.scrollTop &lt;= item.end</span><br><span class="line">               ) &#123;</span><br><span class="line">                   page = index + 1;</span><br><span class="line">               &#125;</span><br><span class="line">           &#125;);</span><br><span class="line">           return page;</span><br><span class="line">       &#125;,</span><br><span class="line">   &#125;,</span><br><span class="line">    </span><br><span class="line">   // 监听用户滑动页面事件，判断当前页码</span><br><span class="line">   onPageScroll(e) &#123;</span><br><span class="line">       this.scrollTop = e.scrollTop;</span><br><span class="line">       console.log(e, this.currentPage);</span><br><span class="line">   &#125;,</span><br><span class="line">    </span><br><span class="line">// 只需查看本事件触发即可知道image的加载情况</span><br><span class="line">   load(e) &#123;</span><br><span class="line">       console.log(e);</span><br><span class="line">       // 宽高比=宽/高=屏幕宽/实际高</span><br><span class="line">       const height =</span><br><span class="line">           this.screenWidth / (e.detail.width / e.detail.height);</span><br><span class="line">       let start, end;</span><br><span class="line">       if (this.imageHeight.length === 0) &#123;</span><br><span class="line">           start = 0;</span><br><span class="line">           end = height;</span><br><span class="line">       &#125; else &#123;</span><br><span class="line">           start = this.imageHeight[this.imageHeight.length - 1].end;</span><br><span class="line">           end = start + height;</span><br><span class="line">       &#125;</span><br><span class="line">       this.imageHeight.push(&#123; start, end &#125;);</span><br><span class="line">       console.log(&quot;图片高度&quot; + height, start, end, this.imageHeight);</span><br><span class="line">   &#125;,</span><br></pre></td></tr></table></figure>

<h3 id="微信小程序单独设置右上角胶囊颜色"><a href="#微信小程序单独设置右上角胶囊颜色" class="headerlink" title="微信小程序单独设置右上角胶囊颜色"></a>微信小程序单独设置右上角胶囊颜色</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    &quot;path&quot;: &quot;index/index&quot;,</span><br><span class="line">    &quot;style&quot;: &#123;</span><br><span class="line">        &quot;navigationBarTitleText&quot;: &quot;首页&quot;,</span><br><span class="line">        &quot;navigationBarTextStyle&quot;: &quot;black&quot; // white默认透明色、black白色</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="判断是在朋友圈打开"><a href="#判断是在朋友圈打开" class="headerlink" title="判断是在朋友圈打开"></a>判断是在朋友圈打开</h3><p>场景值1154：朋友圈内打开“单页模式” </p>
<p><a href="https://blog.csdn.net/aa2528877987/article/details/123127466" target="_blank" rel="noopener">https://blog.csdn.net/aa2528877987/article/details/123127466</a></p>
<h3 id="分包机制"><a href="#分包机制" class="headerlink" title="分包机制"></a>分包机制</h3><p>在这里指的是小程序分包机制，当我们每次打开小程序会发现有的小程序打开的很快，有些很慢，甚至白屏时间很长。原因是包代码量大小的问题。第一次进入小程序的时候，小程序会下载主包代码，如果我们的主包业务代码越多，那么白屏的时间也会越长。 小程序有个机制是在小程序启动时，默认会下载主包并启动主包内页面，当用户进入分包内某个页面时，客户端会把对应分包下载下来，下载完成后再进行展示。因此我们不能把所有代码都放在主页面里面。我们把次级页面放到分包里面。 在构建小程序分包项目时，通常会创建一个或多个分包。每个使用分包小程序必定含有一个主包。所谓的主包，即放置默认启动页面 TabBar 页面，以及一些所有分包都需用到公共资源（css，js，image）；而分包则是根据开发者的配置进行划分。 某些情况下，开发者需要将小程序划分成不同的子包，在构建时打包成不同的分包，用户在使用时按需进行加载。在 pages.json 我们需要 subPackages 管理次级页面的路由：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">// pages.json</span><br><span class="line">&quot;pages&quot;: [],</span><br><span class="line">&quot;subPackages&quot;: [</span><br><span class="line">	&#123;</span><br><span class="line">		&quot;root&quot;: &quot;pages/subpages/index&quot;,   // 分包根目录</span><br><span class="line">		&quot;pages&quot;: [&#123;</span><br><span class="line">			&quot;path&quot;: &quot;album&quot;,              // 配置页面路径</span><br><span class="line">			&quot;style&quot;: &#123;</span><br><span class="line">				&quot;navigationBarTitleText&quot;: &quot;歌单&quot;,</span><br><span class="line">				&quot;app-plus&quot;: &#123;</span><br><span class="line">					&quot;titleNView&quot;: false</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;]</span><br><span class="line">	&#125;</span><br><span class="line">],</span><br></pre></td></tr></table></figure>

<p>分包里面的 pages 与主包的 pages 页面组成保持一致。对小程序进行分包，可以优化小程序首次启动的下载时间，以及在多团队共同开发时可以更好的解耦协作。</p>
<h3 id="小程序自动更新"><a href="#小程序自动更新" class="headerlink" title="小程序自动更新"></a>小程序自动更新</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">getUpdateInfo() &#123;</span><br><span class="line">		// 小程序自动更新</span><br><span class="line">		if (uni.canIUse(&apos;getUpdateManager&apos;)) &#123;</span><br><span class="line">			const updateManager = uni.getUpdateManager()</span><br><span class="line">			updateManager.onCheckForUpdate(function (res) &#123;</span><br><span class="line">				// 请求完新版本信息的回调</span><br><span class="line">				if (res.hasUpdate) &#123;</span><br><span class="line">					updateManager.onUpdateReady(function () &#123;</span><br><span class="line">						uni.showModal(&#123;</span><br><span class="line">							title: &apos;更新提示&apos;,</span><br><span class="line">							content: &apos;新版本已经准备好，是否重启应用？&apos;,</span><br><span class="line">							showCancel: false,</span><br><span class="line">							success: function (res) &#123;</span><br><span class="line">								if (res.confirm) &#123;</span><br><span class="line">									// 新的版本已经下载好，调用 applyUpdate 应用新版本并重启</span><br><span class="line">									updateManager.applyUpdate()</span><br><span class="line">								&#125;</span><br><span class="line">							&#125;</span><br><span class="line">						&#125;)</span><br><span class="line">					&#125;)</span><br><span class="line">					updateManager.onUpdateFailed(function () &#123;</span><br><span class="line">						// 新的版本下载失败</span><br><span class="line">						uni.showModal(&#123;</span><br><span class="line">							title: &apos;已经有新版本了哟~&apos;,</span><br><span class="line">							content:</span><br><span class="line">								&apos;新版本已经上线啦~，请您删除当前小程序，重新搜索打开哟~&apos;</span><br><span class="line">						&#125;)</span><br><span class="line">					&#125;)</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;)</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;,</span><br></pre></td></tr></table></figure>

<h3 id="uniapp-request中post传递数组值的时候，数组没有正确的被传递"><a href="#uniapp-request中post传递数组值的时候，数组没有正确的被传递" class="headerlink" title="uniapp request中post传递数组值的时候，数组没有正确的被传递"></a>uniapp request中post传递数组值的时候，数组没有正确的被传递</h3><p>问题：前端传数组，后端接收到是字符串</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">uni.request(&#123;</span><br><span class="line">  method: &apos;POST&apos;,</span><br><span class="line">  header: &#123;</span><br><span class="line">    &apos;content-type&apos;: &apos;application/x-www-form-urlencoded&apos;,</span><br><span class="line">  &#125;,</span><br><span class="line">  dataType: &apos;json&apos;,</span><br><span class="line">  url: &apos;http://api.cn&apos;, </span><br><span class="line">  data: &#123;</span><br><span class="line">    a: [1,2]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>‘content-type’换成 application/json即可解决</p>
<h3 id="自定义导航栏透明渐变色"><a href="#自定义导航栏透明渐变色" class="headerlink" title="自定义导航栏透明渐变色"></a>自定义导航栏透明渐变色</h3><p>pages.json设置自定义custom</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">  &#123;</span><br><span class="line">	&quot;path&quot;: &quot;pages/index/index&quot;,</span><br><span class="line">	&quot;style&quot;: &#123;</span><br><span class="line">		&quot;navigationBarTitleText&quot;: &quot;秀企车&quot;,</span><br><span class="line">		&quot;navigationStyle&quot;: &quot;custom&quot;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>首页</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 自定义导航栏 --&gt;</span><br><span class="line">&lt;view class=&quot;navbar&quot; v-if=&quot;envType !== 3&quot; :style=&quot;&#123; &apos;padding-top&apos;: systemInfo.statusBarHeight + 13 + &apos;px&apos; &#125;&quot;&gt;首页自定义标题&lt;/view&gt;</span><br><span class="line"></span><br><span class="line">.page &#123;</span><br><span class="line">    width: 100vw;</span><br><span class="line">    height: 100vh;</span><br><span class="line">    position: relative;</span><br><span class="line">&#125;</span><br><span class="line">.navbar &#123;</span><br><span class="line">    width: 100%;</span><br><span class="line">    padding: 26rpx 0;</span><br><span class="line">    position: absolute;</span><br><span class="line">    top: 0;</span><br><span class="line">    left: 0;</span><br><span class="line">    z-index: 999;</span><br><span class="line">    text-align: center;</span><br><span class="line">    background-image: linear-gradient(#ffffff, transparent); // 白-&gt;透明（上到下）</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 透明-&gt;白（上到下）</span><br><span class="line">background: linear-gradient(</span><br><span class="line">    180deg,</span><br><span class="line">    rgba(255, 255, 255, 0) 0%,</span><br><span class="line">    #ffffff 100%</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<h3 id="页面最小高度各平台保持一致"><a href="#页面最小高度各平台保持一致" class="headerlink" title="页面最小高度各平台保持一致"></a>页面最小高度各平台保持一致</h3><p>由于在H5中，页面区域是标题栏下方部分，设置为100vh会导致页面滚动，所以应该区分设置。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">.page &#123;</span><br><span class="line">  // #ifdef H5</span><br><span class="line">  height: 100%;</span><br><span class="line">  // #endif</span><br><span class="line">  // #ifndef H5</span><br><span class="line">  min-height: 100vh;</span><br><span class="line">  // #endif</span><br><span class="line">  background: #fff;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="节流函数（防止重复提交）"><a href="#节流函数（防止重复提交）" class="headerlink" title="节流函数（防止重复提交）"></a>节流函数（防止重复提交）</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">// 节流</span><br><span class="line">const throttle = (fn, wait) =&gt; &#123;</span><br><span class="line">  let delay = wait || 500 // 不传默认500毫秒</span><br><span class="line">  let timer = +new Date()  // 声明初始时间</span><br><span class="line">  return function (...arg) &#123; // 获取参数</span><br><span class="line">    let newTimer = +new Date()  // 获取触发事件的时间</span><br><span class="line">    console.log(timer, newTimer)</span><br><span class="line">    if (newTimer - timer &gt;= delay) &#123;  // 时间判断,是否满足条件</span><br><span class="line">      fn.apply(this, arg)  // 调用需要执行的函数,修改this值,并且传入参数</span><br><span class="line">      timer = +new Date() // 重置初始时间</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">// 类似上一种</span><br><span class="line">const throttle1 = function (func, delay) &#123;</span><br><span class="line">  var prev = Date.now()</span><br><span class="line">  return function () &#123;</span><br><span class="line">    var context = this;</span><br><span class="line">    var args = arguments;</span><br><span class="line">    var now = Date.now();</span><br><span class="line">    console.log(prev, now)</span><br><span class="line">    if (now - prev &gt;= delay) &#123;</span><br><span class="line">      func.apply(context, args);</span><br><span class="line">      prev = Date.now();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">module.exports = &#123;</span><br><span class="line">  throttle</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>页面中使用</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">import Utils from &quot;@/utils/index&quot;;</span><br><span class="line"></span><br><span class="line">// 调用不成功示例</span><br><span class="line">      onClick1() &#123;</span><br><span class="line">          Utils.throttle(this.submit1(), 1000)</span><br><span class="line">      &#125;,</span><br><span class="line">      submit1() &#123;</span><br><span class="line">          console.log(&quot;点击事件随机值&quot; + Math.random())</span><br><span class="line">      &#125;,</span><br><span class="line">      // 点击提交按钮（成功示例）</span><br><span class="line">      onClick: Utils.throttle(function () &#123;</span><br><span class="line">          console.log(&quot;点击事件随机值&quot; + Math.random())</span><br><span class="line">          this.submit()</span><br><span class="line">      &#125;, 2000),</span><br><span class="line">      // 提交数据</span><br><span class="line">      async submit() &#123;</span><br><span class="line">      	...</span><br><span class="line">      	const res = await $http.addTripApi(this.formModel)</span><br><span class="line">      	...</span><br><span class="line">      &#125;</span><br></pre></td></tr></table></figure>

<h5 id="思路2-前端：不允许二次或多次点击"><a href="#思路2-前端：不允许二次或多次点击" class="headerlink" title="思路2. 前端：不允许二次或多次点击"></a>思路2. 前端：不允许二次或多次点击</h5><p>1.例如使用：wx.showToast，wx.showLoading</p>
<p>弹出提示框，提示框显示xx秒，提示框显示期间无法再操作</p>
<p>通俗讲，就是弹出屏蔽层，防止用户第二次点击</p>
<p>2.例如使用：hidden 或者 disable 或者 wx:if</p>
<p>点击一次后，立即禁用或隐藏按钮</p>
<p>此方法可能存在的问题：在弹出提示框前已经点击了多次</p>
<h3 id="uniapp弹窗蒙层禁止滚动穿透滚动底层页面"><a href="#uniapp弹窗蒙层禁止滚动穿透滚动底层页面" class="headerlink" title="uniapp弹窗蒙层禁止滚动穿透滚动底层页面"></a>uniapp弹窗蒙层禁止滚动穿透滚动底层页面</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">// 弹窗蒙层</span><br><span class="line">&lt;view class=&quot;alert-bg&quot;</span><br><span class="line">        v-if=&quot;isShow&quot;</span><br><span class="line">        catchtouchmove=&apos;true&apos;&gt;</span><br><span class="line">        // 弹窗内容</span><br><span class="line">        ...</span><br><span class="line">&lt;/view&gt;</span><br></pre></td></tr></table></figure>

<h3 id="setInterval"><a href="#setInterval" class="headerlink" title="setInterval"></a>setInterval</h3><p>window.setInterval(调用函数，延时时间);</p>
<p>与setTimeout区别：</p>
<p>setTimeout是延时时间到了就去调用这个回调函数，只调用了一次 就结束了这个定时器。</p>
<p>setInterval是 每隔这个延迟时间 就去调用这个回调函数 会调用很多次 重复调用这个函数。</p>
<p>清除定时器 clearInterval()</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">onLoad(options) &#123;</span><br><span class="line">       // 不是微信环境且当前页面出现在屏幕上时执行轮询</span><br><span class="line">       if (this.envType !== 1 &amp;&amp; this.isPolling) &#123;</span><br><span class="line">           // 3秒刷新一次</span><br><span class="line">           this.timer = setInterval(() =&gt; &#123;</span><br><span class="line">               this.getState()</span><br><span class="line">           &#125;, 3000)</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;,</span><br><span class="line">   onShow() &#123;</span><br><span class="line">       this.isPolling = true</span><br><span class="line">   &#125;,</span><br><span class="line">   onHide() &#123;</span><br><span class="line">       this.isPolling = false</span><br><span class="line">   &#125;,</span><br><span class="line">   // 监听页面卸载</span><br><span class="line">   onUnload() &#123;</span><br><span class="line">       clearInterval(this.timer)</span><br><span class="line">   &#125;,</span><br></pre></td></tr></table></figure>

<h3 id="小程序首页onUnload中无法请求接口"><a href="#小程序首页onUnload中无法请求接口" class="headerlink" title="小程序首页onUnload中无法请求接口"></a>小程序首页onUnload中无法请求接口</h3><p>小程序首页的onUnload生命周期函数是在页面被关闭或隐藏时触发的，而请求接口需要在页面可见的状态下才能发送。因此，在onUnload中无法直接请求接口。</p>
<p>如果你想在小程序首页关闭或隐藏时发送接口请求，可以考虑使用其他生命周期函数或事件来实现。以下是一些可能的解决方案：</p>
<ol>
<li>在页面的onHide生命周期函数中发送接口请求：onHide会在小程序页面隐藏时触发，这样可以确保页面仍然是可见状态，可以发送请求。但需要注意，如果用户频繁在首页和其他页面之间切换，可能会频繁触发该生命周期函数并发送多个接口请求，导致性能问题。</li>
<li>使用App全局对象的onHide生命周期函数：将请求接口的逻辑放在App全局对象的onHide生命周期函数中。这样无论哪个页面被关闭或隐藏，都能够在一处统一处理接口请求。</li>
<li>使用其他触发条件：根据具体需求，可以考虑使用其他触发条件来发送接口请求，例如点击按钮、进入其他页面等。你可以在合适的时机，结合业务场景，选择合适的触发条件来发送接口请求。</li>
</ol>
<h3 id="原生微信小程序转uniapp每个页面修改步骤"><a href="#原生微信小程序转uniapp每个页面修改步骤" class="headerlink" title="原生微信小程序转uniapp每个页面修改步骤"></a>原生微信小程序转uniapp每个页面修改步骤</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">this.data换成this</span><br><span class="line"></span><br><span class="line">/images换成/static/images</span><br><span class="line"></span><br><span class="line">bindtap和catchtap换成@click</span><br><span class="line"></span><br><span class="line">wx.改成uni.</span><br><span class="line"></span><br><span class="line">var改成let</span><br><span class="line"></span><br><span class="line">that改成_this</span><br><span class="line"></span><br><span class="line">bind改成@</span><br><span class="line"></span><br><span class="line">wx:if改成v-if去掉大括号</span><br><span class="line"></span><br><span class="line">wx:elif改成v-else-if去掉大括号</span><br><span class="line"></span><br><span class="line">wx:else改成v-else</span><br><span class="line"></span><br><span class="line">wx:for改成v-for看着改</span><br><span class="line"></span><br><span class="line">this.setData看着改</span><br><span class="line"></span><br><span class="line">data-改成函数传参</span><br><span class="line"></span><br><span class="line">style=和=&quot;&#123;&#123;看着改</span><br><span class="line"></span><br><span class="line">引用接口，改.then</span><br><span class="line"></span><br><span class="line">解决报错</span><br></pre></td></tr></table></figure>

<h3 id="vue移动端转uniapp每个页面修改步骤"><a href="#vue移动端转uniapp每个页面修改步骤" class="headerlink" title="vue移动端转uniapp每个页面修改步骤"></a>vue移动端转uniapp每个页面修改步骤</h3><ul>
<li>div和&lt;p标签改成view</li>
<li>span改成text</li>
<li>../../static改成/static/images</li>
<li>img改成image</li>
<li>alt=””改成/</li>
<li>api.改成$http.</li>
<li>res.data改成res</li>
<li>修改Toast、Dialog</li>
<li>lang=”scss”</li>
</ul>
<h3 id="uniapp使用toast提示进行表单校验"><a href="#uniapp使用toast提示进行表单校验" class="headerlink" title="uniapp使用toast提示进行表单校验"></a>uniapp使用toast提示进行表单校验</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">showToast() &#123;</span><br><span class="line">          this.formData.name = &apos;ww&apos;</span><br><span class="line">          const arr = [</span><br><span class="line">              &#123; key: &apos;name&apos;, title: &apos;请输入姓名&apos; &#125;,</span><br><span class="line">              &#123;</span><br><span class="line">                  key: &apos;index&apos;,</span><br><span class="line">                  title: &apos;请选择xxx&apos;,</span><br><span class="line">                  fun: (p) =&gt; &#123;</span><br><span class="line">                      return p === 0</span><br><span class="line">                  &#125;</span><br><span class="line">              &#125;,</span><br><span class="line">              &#123; key: &apos;xxx&apos;, title: &apos;请输入xxx&apos; &#125;</span><br><span class="line">          ]</span><br><span class="line">          let key, title, fun</span><br><span class="line">          for (let i = 0; i &lt; arr.length; i++) &#123;</span><br><span class="line">              key = arr[i].key</span><br><span class="line">              title = arr[i].title</span><br><span class="line">              fun = arr[i].fun</span><br><span class="line">              console.log(key, title, fun, this.formData[key])</span><br><span class="line">              if ((fun &amp;&amp; fun(this[key])) || (!fun &amp;&amp; !this.formData[key])) &#123;</span><br><span class="line">                  // 如果不满足条件或者为空就提示</span><br><span class="line">                  uni.showToast(&#123;</span><br><span class="line">                      title,</span><br><span class="line">                      icon: &apos;none&apos;</span><br><span class="line">                  &#125;)</span><br><span class="line">                  return</span><br><span class="line">              &#125;</span><br><span class="line">          &#125;</span><br><span class="line">      &#125;,</span><br></pre></td></tr></table></figure>

<p>this[key]和this.formData[key]根据实际data数据进行修改</p>
<p>封装一个通用的验证方法来简化代码 </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;form @submit.prevent=&quot;submitForm&quot;&gt;</span><br><span class="line">      &lt;input v-model=&quot;name&quot; type=&quot;text&quot; placeholder=&quot;Name&quot;&gt;</span><br><span class="line">      </span><br><span class="line">      &lt;input v-model=&quot;email&quot; type=&quot;email&quot; placeholder=&quot;Email&quot;&gt;</span><br><span class="line"></span><br><span class="line">      &lt;!-- Add more input fields --&gt;</span><br><span class="line"></span><br><span class="line">      &lt;button type=&quot;submit&quot;&gt;Submit&lt;/button&gt;</span><br><span class="line">    &lt;/form&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">  data() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      name: &apos;&apos;,</span><br><span class="line">      email: &apos;&apos;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    submitForm() &#123;</span><br><span class="line">      const validationResult = this.validateForm();</span><br><span class="line">      if (validationResult.isValid) &#123;</span><br><span class="line">        // Submit the form</span><br><span class="line">      &#125; else &#123;</span><br><span class="line">        this.$toast.error(validationResult.errorMessage);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    validateForm() &#123;</span><br><span class="line">      const requiredFields = [</span><br><span class="line">        &#123; fieldName: &apos;name&apos;, label: &apos;Name&apos; &#125;,</span><br><span class="line">        &#123; fieldName: &apos;email&apos;, label: &apos;Email&apos; &#125;,</span><br><span class="line">        // Add more input fields</span><br><span class="line">      ];</span><br><span class="line"></span><br><span class="line">      for (const field of requiredFields) &#123;</span><br><span class="line">        if (!this[field.fieldName]) &#123;</span><br><span class="line">          return &#123;</span><br><span class="line">            isValid: false,</span><br><span class="line">            errorMessage: `$&#123;field.label&#125; is required.`</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      // Add more custom validation rules</span><br><span class="line"></span><br><span class="line">      return &#123;</span><br><span class="line">        isValid: true,</span><br><span class="line">        errorMessage: &apos;&apos;</span><br><span class="line">      &#125;;</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<h3 id="控制输入框是否自动聚焦"><a href="#控制输入框是否自动聚焦" class="headerlink" title="控制输入框是否自动聚焦"></a>控制输入框是否自动聚焦</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">&lt;input v-model=&quot;formData.code&quot;</span><br><span class="line">                        type=&quot;number&quot;</span><br><span class="line">                        maxlength=&quot;4&quot;</span><br><span class="line">                        class=&quot;idCard-formItem-input&quot;</span><br><span class="line">                        placeholder=&quot;请输入短信验证码&quot;</span><br><span class="line">                        placeholder-class=&quot;placeholder&quot;</span><br><span class="line">                        :focus=&quot;autoFocus&quot;</span><br><span class="line">                        @blur=&quot;handleBlur&quot;</span><br><span class="line">                        @keydown.enter.native=&quot;phoneLogin&quot; /&gt;</span><br><span class="line">                    &lt;view class=&quot;code&quot;</span><br><span class="line">                        @click=&quot;getCode&quot;</span><br><span class="line">                        v-if=&quot;!codeData.status&quot;&gt;获取验证码&lt;/view&gt;</span><br><span class="line">                        </span><br><span class="line">		getCode() &#123;</span><br><span class="line">            this.autoFocus = true</span><br><span class="line">            this.timerInterval = setInterval(() =&gt; &#123;</span><br><span class="line">                if (this.codeData.count &gt; 0) &#123;</span><br><span class="line">                    this.codeData.count = this.codeData.count - 1</span><br><span class="line">                &#125; else &#123;</span><br><span class="line">                    this.codeData.count = 30</span><br><span class="line">                    this.codeData.status = false</span><br><span class="line">                    this.dxToken = &apos;&apos;</span><br><span class="line">                    clearInterval(this.timerInterval)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;, 1000)</span><br><span class="line">        &#125;,</span><br></pre></td></tr></table></figure>

<h3 id="输入框聚焦页面置顶"><a href="#输入框聚焦页面置顶" class="headerlink" title="输入框聚焦页面置顶"></a>输入框聚焦页面置顶</h3><p>切记:adjust-position=”false”，不然ios会自动上推页面导致有问题</p>
<p>.focus为输入框外层容器类名</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&lt;input :placeholder-class=&quot;isCheck&amp;&amp;!formData.title?&apos;err&apos;:&apos;placeholder&apos;&quot;</span><br><span class="line">                          v-model=&quot;formData.title&quot;</span><br><span class="line">                          :adjust-position=&quot;false&quot;</span><br><span class="line">                          maxlength=&quot;32&quot;</span><br><span class="line">                          placeholder=&quot;请输入发票抬头（可检索）&quot;</span><br><span class="line">                          @focus=&quot;focusTitle&quot;</span><br><span class="line">                          @blur=&quot;blurTitle&quot;</span><br><span class="line">                          @input=&quot;inputTitle&quot; /&gt;</span><br><span class="line">                          </span><br><span class="line">// 发票抬头聚焦</span><br><span class="line">      focusTitle() &#123;</span><br><span class="line">          this.$refs.dropRef.show()</span><br><span class="line">          // 输入框聚焦置顶</span><br><span class="line">          this.isFocus = true</span><br><span class="line">          const offsetTop = -this.systemInfo.statusBarHeight - 44 - 45</span><br><span class="line">          console.log(offsetTop)</span><br><span class="line">          // 状态栏+导航栏+头部固定区域的高度为偏移量</span><br><span class="line">          this.$nextTick(() =&gt; &#123;</span><br><span class="line">              // 防止键盘遮挡下拉框</span><br><span class="line">              uni.pageScrollTo(&#123;</span><br><span class="line">                  selector: &apos;.focus&apos;,</span><br><span class="line">                  offsetTop</span><br><span class="line">              &#125;)</span><br><span class="line">          &#125;)</span><br><span class="line">      &#125;,</span><br></pre></td></tr></table></figure>

<h3 id="使用JSON-stringify遇到特殊字符如：-amp-会报错"><a href="#使用JSON-stringify遇到特殊字符如：-amp-会报错" class="headerlink" title="使用JSON.stringify遇到特殊字符如：&amp; 会报错"></a>使用JSON.stringify遇到特殊字符如：&amp; 会报错</h3><p>[Vue warn]: Error in onLoad hook: “SyntaxError: Unexpected end of JSON input”<br>SyntaxError: Unterminated string in JSON at position 90</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[&#123;</span><br><span class="line">             latitude: this.latitude,</span><br><span class="line">             longitude: this.longitude,</span><br><span class="line">             title: &apos;四创科技有限公司(星网锐捷科技园·一期&amp;二期西南)&apos;,</span><br><span class="line">             // title: res.formatted_addresses.recommend,</span><br><span class="line">             address: res.address,</span><br><span class="line">             id: 0,</span><br><span class="line">             width: 44,</span><br><span class="line">             height: 60,</span><br><span class="line">             iconPath: &apos;/static/images/spot_start.png&apos;, // 图标路径</span><br><span class="line">             clock_state: 0,</span><br><span class="line">             time: &apos;&apos;</span><br><span class="line">         &#125;]</span><br></pre></td></tr></table></figure>

<p>解决方案：</p>
<h4 id="1-通过编码解码的方式处理"><a href="#1-通过编码解码的方式处理" class="headerlink" title="1.通过编码解码的方式处理"></a>1.通过编码解码的方式处理</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">let markers = encodeURIComponent(JSON.stringify(this.markers))</span><br><span class="line">                console.log(markers)</span><br><span class="line">                uni.navigateTo(&#123;</span><br><span class="line">                    url: `/sub_trip/trip/SetTrip?isAdd=$&#123;isAdd&#125;&amp;tripList=$&#123;JSON.stringify(</span><br><span class="line">                        this.tripList</span><br><span class="line">                    )&#125;&amp;markers=$&#123;markers&#125;`</span><br><span class="line">                &#125;)</span><br></pre></td></tr></table></figure>

<p>接收页</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">onLoad(options) &#123;</span><br><span class="line">        console.log(options)</span><br><span class="line">        if (options.tripList) &#123;</span><br><span class="line">            this.tripList = JSON.parse(options.tripList)</span><br><span class="line">            this.markers = JSON.parse(decodeURIComponent(options.markers))</span><br><span class="line">        &#125;</span><br><span class="line">        console.log(this.tripList, this.markers)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="2-使用vuex，不容易出问题"><a href="#2-使用vuex，不容易出问题" class="headerlink" title="2.使用vuex，不容易出问题"></a>2.使用vuex，不容易出问题</h4><p>因为这个字段过长，路由传参最多300多字符</p>
<h3 id="数组深拷贝"><a href="#数组深拷贝" class="headerlink" title="数组深拷贝"></a>数组深拷贝</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">let [...markers] = this.markers // 数组深拷贝</span><br><span class="line">            markers.reverse() // 数组反转</span><br><span class="line">            // 处理markers数据</span><br><span class="line">            markers.forEach((item, index) =&gt; &#123;</span><br><span class="line">                item.id = index</span><br><span class="line">                item.width = 44</span><br><span class="line">                item.height = 60</span><br><span class="line">                item.clock_state = 0</span><br><span class="line">                item.time = &apos;&apos;</span><br><span class="line">                if (index === 0) &#123;</span><br><span class="line">                    item.iconPath = &apos;/static/images/spot_start.png&apos;</span><br><span class="line">                &#125; else if (index === this.markers.length - 1) &#123;</span><br><span class="line">                    item.iconPath = &apos;/static/images/spot_end.png&apos;</span><br><span class="line">                &#125; else &#123;</span><br><span class="line">                    item.iconPath = `/static/images/spot$&#123;index&#125;.png`</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;)</span><br><span class="line">            this.markers = markers</span><br><span class="line">            console.log(this.markers)</span><br></pre></td></tr></table></figure>

<h3 id="微信小程序textarea组件-输入字数-＞-限制字数-的bug"><a href="#微信小程序textarea组件-输入字数-＞-限制字数-的bug" class="headerlink" title="微信小程序textarea组件 输入字数 ＞ 限制字数 的bug"></a>微信小程序textarea组件 输入字数 ＞ 限制字数 的bug</h3><p>当你需要给textarea组件添加一个统计输入字数的功能时</p>
<p>如果在手机上通过复制粘贴达到最大限制字数，这时候继续使用手机上的小键盘输入内容，就会出现输入字数大于限制字数的bug，而多出来的字数就是你小键盘上当前输入的内容长度。</p>
<p>或者超过最大限制字数，复制超字数会被统计出来</p>
<p>例如feedback.length可能会显示134、165，但文本框内实际有100个字符，实际问题只是显示字数不对</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;textarea v-model=&quot;feedback&quot;</span><br><span class="line">                placeholder=&apos;请输入反馈内容&apos;</span><br><span class="line">                maxlength=&quot;100&quot;</span><br><span class="line">                @blur=&quot;handleBlur&quot;&gt;</span><br><span class="line">            &lt;/textarea&gt;</span><br><span class="line">            &lt;text class=&quot;count&quot;&gt;</span><br><span class="line">                &lt;text class=&quot;black&quot;&gt;&#123;&#123;feedback.length&#125;&#125;&lt;/text&gt;/100</span><br><span class="line">            &lt;/text&gt;</span><br></pre></td></tr></table></figure>

<p>解决办法：</p>
<p>如果value的长度大于限制长度，则取限制长度展示</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;text class=&quot;black&quot;&gt;&#123;&#123; feedback.length&gt;100 ? 100 : feedback.length &#125;&#125;&lt;/text&gt;/100</span><br></pre></td></tr></table></figure>

<h3 id="套div防止图片被挤压变形"><a href="#套div防止图片被挤压变形" class="headerlink" title="套div防止图片被挤压变形"></a>套div防止图片被挤压变形</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">&lt;view class=&quot;search&quot;&gt;</span><br><span class="line">    &lt;view class=&quot;icon&quot;&gt;</span><br><span class="line">    	&lt;image :src=&quot;getSrc(&apos;search@2x.png&apos;)&quot; /&gt;</span><br><span class="line">    &lt;/view&gt;</span><br><span class="line">    &lt;input v-model=&quot;formData.keyword&quot;</span><br><span class="line">        disabled</span><br><span class="line">        @click=&quot;openPopup&quot;</span><br><span class="line">        placeholder=&quot;任务名称、任务编号&quot;</span><br><span class="line">        placeholder-class=&quot;placeholder&quot; /&gt;</span><br><span class="line">&lt;/view&gt;</span><br><span class="line">	</span><br><span class="line">	.search &#123;</span><br><span class="line">        width: 646rpx;</span><br><span class="line">        height: 60rpx;</span><br><span class="line">        padding: 0 16rpx;</span><br><span class="line">        margin-top: 20rpx;</span><br><span class="line">        border-radius: 32rpx;</span><br><span class="line">        box-sizing: border-box;</span><br><span class="line">        display: flex;</span><br><span class="line">        align-items: center;</span><br><span class="line">        background: #fff;</span><br><span class="line">        .icon &#123;</span><br><span class="line">            // 套div防止图片被挤压</span><br><span class="line">            height: 42rpx;</span><br><span class="line">            image &#123;</span><br><span class="line">                width: 40rpx;</span><br><span class="line">                height: 42rpx;</span><br><span class="line">                margin-right: 16rpx;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        input &#123;</span><br><span class="line">            width: 100%;</span><br><span class="line">            height: 100%;</span><br><span class="line">            font-size: 32rpx;</span><br><span class="line">            letter-spacing: 2rpx;</span><br><span class="line">            text-align: left;</span><br><span class="line">            color: #464c5b;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h3 id="小程序不支持table标签"><a href="#小程序不支持table标签" class="headerlink" title="小程序不支持table标签"></a>小程序不支持table标签</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line">		&lt;view class=&quot;table&quot;&gt;</span><br><span class="line">            &lt;!-- 表头(即第一行) --&gt;</span><br><span class="line">            &lt;view class=&quot;tr&quot;&gt;</span><br><span class="line">                &lt;view class=&quot;th&quot;&gt;插件名称&lt;/view&gt;</span><br><span class="line">                &lt;view class=&quot;th&quot;&gt;插件提供方名称&lt;/view&gt;</span><br><span class="line">                &lt;view class=&quot;th&quot;&gt;使用场景&lt;/view&gt;</span><br><span class="line">                &lt;view class=&quot;th&quot;&gt;共享个人信息内容&lt;/view&gt;</span><br><span class="line">            &lt;/view&gt;</span><br><span class="line">            &lt;!-- 表格第二行 --&gt;</span><br><span class="line">            &lt;view class=&quot;tr&quot;&gt;</span><br><span class="line">                &lt;view class=&quot;td&quot;&gt;OCR身份证识别SDK&lt;/view&gt;</span><br><span class="line">                &lt;view class=&quot;td&quot;&gt;北京市商汤科技开发有限公司&lt;/view&gt;</span><br><span class="line">                &lt;view class=&quot;td&quot;&gt;实名认证&lt;/view&gt;</span><br><span class="line">                &lt;view class=&quot;td&quot;&gt;身份证照片识别&lt;/view&gt;</span><br><span class="line">            &lt;/view&gt;</span><br><span class="line">            &lt;!-- 表格第三行 --&gt;</span><br><span class="line">            &lt;view class=&quot;tr&quot;&gt;</span><br><span class="line">                &lt;view class=&quot;td&quot;&gt;顶象验证SDK&lt;/view&gt;</span><br><span class="line">                &lt;view class=&quot;td&quot;&gt;北京顶象技术有限公司&lt;/view&gt;</span><br><span class="line">                &lt;view class=&quot;td&quot;&gt;验证码防刷&lt;/view&gt;</span><br><span class="line">                &lt;view class=&quot;td&quot;&gt;设备信息、网络信息、IP地址、用户行为&lt;/view&gt;</span><br><span class="line">            &lt;/view&gt;</span><br><span class="line">            &lt;!-- 表格第四行 --&gt;</span><br><span class="line">            &lt;view class=&quot;tr&quot;&gt;</span><br><span class="line">                &lt;view class=&quot;td&quot;&gt;神策SDK&lt;/view&gt;</span><br><span class="line">                &lt;view class=&quot;td&quot;&gt;神策网络科技（北京）有限公司&lt;/view&gt;</span><br><span class="line">                &lt;view class=&quot;td&quot;&gt;用户行为分析&lt;/view&gt;</span><br><span class="line">                &lt;view class=&quot;td&quot;&gt;手机IMEI、操作信息、设备型号、手机操作系统&lt;/view&gt;</span><br><span class="line">            &lt;/view&gt;</span><br><span class="line">            &lt;!-- 表格第五行 --&gt;</span><br><span class="line">            &lt;view class=&quot;tr&quot;&gt;</span><br><span class="line">                &lt;view class=&quot;td&quot;&gt;微信SDK&lt;/view&gt;</span><br><span class="line">                &lt;view class=&quot;td&quot;&gt;深圳市腾讯计算机系统有限公司&lt;/view&gt;</span><br><span class="line">                &lt;view class=&quot;td&quot;&gt;微信登录、分享&lt;/view&gt;</span><br><span class="line">                &lt;view class=&quot;td&quot;&gt;微信信息（头像、昵称、地区、性别）&lt;/view&gt;</span><br><span class="line">            &lt;/view&gt;</span><br><span class="line">        &lt;/view&gt;</span><br><span class="line"></span><br><span class="line">.table &#123;</span><br><span class="line">    display: flex;</span><br><span class="line">    flex-direction: column;</span><br><span class="line">    border-top: 2rpx solid #dadada; /* 单元格上线框 */</span><br><span class="line">    border-left: 2rpx solid #dadada; /* 单元格左线框 */</span><br><span class="line">    .tr &#123;</span><br><span class="line">        display: flex;</span><br><span class="line">        flex-direction: row;</span><br><span class="line">    &#125;</span><br><span class="line">    .th,</span><br><span class="line">    .td &#123;</span><br><span class="line">        width: 25%; /* 4个25%相加刚好100% */</span><br><span class="line">        padding: 2rpx;</span><br><span class="line">        display: flex;</span><br><span class="line">        flex-direction: row;</span><br><span class="line">        flex-wrap: wrap; /* 自动换行 */</span><br><span class="line">        text-align: center; /* 文本居中 */</span><br><span class="line">        justify-content: center; /* 主轴居中 */</span><br><span class="line">        align-items: center; /* 交叉轴居中 */</span><br><span class="line">        border-bottom: 2rpx solid #dadada; /* 单元格下线框 */</span><br><span class="line">        border-right: 2rpx solid #dadada; /* 单元格右线框 */</span><br><span class="line">    &#125;</span><br><span class="line">    .th &#123;</span><br><span class="line">        font-weight: bold;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="uniapp中的textarea文本框设置长度限制"><a href="#uniapp中的textarea文本框设置长度限制" class="headerlink" title="uniapp中的textarea文本框设置长度限制"></a>uniapp中的textarea文本框设置长度限制</h3><p>在uniapp 的项目中要使用编辑文本域的功能，但是文本框的长度是不做限制的，虽然在不写maxlength的情况下是可以的。但是在测试的时候你会发现文本框输入文字的时候添加140个文字以后就不能再添加文字了（没有效果了）。<br>我是在做uniapp的项目的时候，测试出这个问题的，后来发现，在不设置maxlength的情况下，uniapp中默认textarea中的最大字数限制为140。<br>即 在不写maxlength的时候，会在审查元素的时候，会自动生成 maxlength=“140”</p>
<p>解决办法：</p>
<p>在textarea标签中添加<strong>maxlength=’’-1’’</strong>属性</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;textarea  maxlength=&quot;-1&quot; /&gt;</span><br></pre></td></tr></table></figure>

<h3 id="打开另一个小程序"><a href="#打开另一个小程序" class="headerlink" title="打开另一个小程序"></a>打开另一个小程序</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">// 打开另一个小程序</span><br><span class="line">      navigateToMiniProgram() &#123;</span><br><span class="line">          uni.navigateToMiniProgram(&#123;</span><br><span class="line">              appId: &apos;wx3f3b615216e7cfbe&apos;,</span><br><span class="line">              path: &apos;pages/my/My&apos;,</span><br><span class="line">              extraData: &#123;</span><br><span class="line">                  sign_mch_id: &apos;WgrpwNplS8rL&apos;,</span><br><span class="line">                  phone: &apos;18734131475&apos;</span><br><span class="line">              &#125;,</span><br><span class="line">              envVersion: &apos;trial&apos;, // 要打开的小程序版本</span><br><span class="line">              success(res) &#123;</span><br><span class="line">                  // 打开成功</span><br><span class="line">                  console.log(&apos;打开成功&apos;)</span><br><span class="line">              &#125;</span><br><span class="line">          &#125;)</span><br><span class="line">      &#125;,</span><br></pre></td></tr></table></figure>

<p>envVersion： 要打开的小程序版本，有效值： develop（开发版），trial（体验版），release（正式版）。仅在当前小程序为开发版或体验版时此参数有效。如果当前小程序是正式版，则打开的小程序必定是正式版。 </p>
<h4 id="跳转回上一个小程序"><a href="#跳转回上一个小程序" class="headerlink" title="跳转回上一个小程序"></a>跳转回上一个小程序</h4><p>只有当另一个小程序跳转到当前小程序时才会能调用成功。 </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">// 返回第三方小程序</span><br><span class="line">      goBack() &#123;</span><br><span class="line">          // 跳转回上一个小程序，只有当另一个小程序跳转到当前小程序时才会能调用成功</span><br><span class="line">          uni.navigateBackMiniProgram(&#123;</span><br><span class="line">              extraData: &#123;</span><br><span class="line">                  msg: &apos;签约成功&apos;</span><br><span class="line">              &#125;,</span><br><span class="line">              success(res) &#123;</span><br><span class="line">                  // 返回成功</span><br><span class="line">              &#125;</span><br><span class="line">          &#125;)</span><br><span class="line">      &#125;</span><br></pre></td></tr></table></figure>

<h3 id="跳转到E证通小程序进行人脸识别"><a href="#跳转到E证通小程序进行人脸识别" class="headerlink" title="跳转到E证通小程序进行人脸识别"></a>跳转到E证通小程序进行人脸识别</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line">import $http from &apos;@/api/http&apos;</span><br><span class="line">import &#123; mapState &#125; from &apos;vuex&apos;</span><br><span class="line">import &#123; initEid, startEid &#125; from &apos;@/mp_ecard_sdk/main&apos;</span><br><span class="line"></span><br><span class="line">export default &#123;</span><br><span class="line">    data() &#123;</span><br><span class="line">        return &#123;</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;,</span><br><span class="line">    computed: &#123;</span><br><span class="line">        ...mapState(&#123;</span><br><span class="line">            userInfo: (state) =&gt; state.login.userInfo</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;,</span><br><span class="line">    onLoad(option) &#123;</span><br><span class="line">        // 初始化E证通</span><br><span class="line">        initEid()</span><br><span class="line">    &#125;,</span><br><span class="line">    methods: &#123;</span><br><span class="line">        // 跳转到E证通小程序进行人脸识别</span><br><span class="line">        async faceEid() &#123;</span><br><span class="line">            uni.showLoading(&#123;</span><br><span class="line">                title: &apos;加载中&apos;</span><br><span class="line">            &#125;)</span><br><span class="line">            // 获取E证通EidToken</span><br><span class="line">            const token = await $http.eidToken()</span><br><span class="line">            uni.hideLoading()</span><br><span class="line">            const param = &#123;</span><br><span class="line">                data: &#123;</span><br><span class="line">                    token</span><br><span class="line">                &#125;,</span><br><span class="line">                // 核身完成的回调</span><br><span class="line">                verifyDoneCallback: async (res) =&gt; &#123;</span><br><span class="line">                    console.log(&apos;收到核身完成的res&apos;, res)</span><br><span class="line">                    const &#123; token, verifyDone &#125; = res</span><br><span class="line">                    console.log(&apos;核身验证成功的token是:&apos;, token)</span><br><span class="line">                    console.log(&apos;是否完成核身:&apos;, verifyDone)</span><br><span class="line">                    if (verifyDone) &#123;</span><br><span class="line">                        uni.showLoading(&#123;</span><br><span class="line">                            title: &apos;核验中&apos;</span><br><span class="line">                        &#125;)</span><br><span class="line">                        const data = await $http.checkEidToken(res)</span><br><span class="line">                        // name、phone、id_card</span><br><span class="line">                        console.log(data)</span><br><span class="line">                        if (data.name || this.userInfo.state === 1) &#123;</span><br><span class="line">                            // 认证成功 或者 已实名补录人脸的情况</span><br><span class="line">                            console.log(&apos;认证成功&apos;)</span><br><span class="line">                            // 刷新缓存</span><br><span class="line">                            await this.getUserInfo()</span><br><span class="line">                            uni.hideLoading()</span><br><span class="line">                            // 如果在我的页用reLaunch，核验完回来onShow刷新一次，等待上面核验接口执行完又reLaunch，页面感觉会刷新两次</span><br><span class="line">                            uni.switchTab(&#123;</span><br><span class="line">                                url: &apos;/pages/my/My&apos;</span><br><span class="line">                            &#125;)</span><br><span class="line">                        &#125; else &#123;</span><br><span class="line">                            // 认证失败</span><br><span class="line">                            uni.hideLoading()</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            // 有token就进⼊E证通实名认证⻚</span><br><span class="line">            token &amp;&amp; startEid(param)</span><br><span class="line">        &#125;,</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="常用返回值记录"><a href="#常用返回值记录" class="headerlink" title="常用返回值记录"></a>常用返回值记录</h3><h4 id="uniapp视频选择uni-chooseVideo返回值"><a href="#uniapp视频选择uni-chooseVideo返回值" class="headerlink" title="uniapp视频选择uni.chooseVideo返回值"></a>uniapp视频选择uni.chooseVideo返回值</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">// 微信小程序视频选择真机返回值</span><br><span class="line">duration: 2</span><br><span class="line">errMsg: &quot;chooseVideo:ok&quot;</span><br><span class="line">height: 656</span><br><span class="line">size: 176181</span><br><span class="line">tempFilePath: &quot;wxfile://tmp_326eae5820787184e4351b9eb86e131c9b376dc6263e5304.mp4&quot;</span><br><span class="line">width: 296</span><br><span class="line"></span><br><span class="line">// web视频选择返回值</span><br><span class="line">duration: 8.9</span><br><span class="line">errMsg: &quot;chooseVideo:ok&quot;</span><br><span class="line">height: 960</span><br><span class="line">name: &quot;iphone底部按钮问题.mp4&quot;</span><br><span class="line">size: 1201520</span><br><span class="line">width: 442</span><br><span class="line">tempFilePath: &quot;blob:http://localhost:8080/e339462f-8f8a-4025-955a-e2a53760efba&quot;</span><br><span class="line">tempFile:</span><br><span class="line">&#123;</span><br><span class="line">    lastModified: 1669347671458</span><br><span class="line">    lastModifiedDate: Fri Nov 25 2022 11:41:11 GMT+0800 (中国标准时间) &#123;&#125;</span><br><span class="line">    name: &quot;iphone底部按钮问题.mp4&quot;</span><br><span class="line">    size: 1201520</span><br><span class="line">    type: &quot;video/mp4&quot;</span><br><span class="line">    webkitRelativePath: &quot;&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="uniapp监听实时地理位置变化事件uni-onLocationChange返回值"><a href="#uniapp监听实时地理位置变化事件uni-onLocationChange返回值" class="headerlink" title="uniapp监听实时地理位置变化事件uni.onLocationChange返回值"></a>uniapp监听实时地理位置变化事件uni.onLocationChange返回值</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">// 真机</span><br><span class="line">accuracy: 35</span><br><span class="line">altitude: 0</span><br><span class="line">direction: 0</span><br><span class="line">horizontalAccuracy: 35</span><br><span class="line">indoorLocationType: -1</span><br><span class="line">latitude: 39.866444498697916</span><br><span class="line">longitude: 116.30702663845486</span><br><span class="line">provider: &quot;network&quot;</span><br><span class="line">speed: 0</span><br><span class="line">steps: 0</span><br><span class="line">type: &quot;gcj02&quot;</span><br><span class="line">verticalAccuracy: 0</span><br></pre></td></tr></table></figure>


        </div>

        <blockquote class="post-copyright">
    
    <div class="content">
        
<span class="post-time">
    最后更新时间：<time datetime="2024-03-31T16:10:54.000Z" itemprop="dateUpdated">2024-04-01 00:10:54</time>
</span><br>


        
        感谢您的阅读，欢迎评论(*^▽^*) 转载请附上本文链接：<a href="/knowledges/uniapp.html" target="_blank" rel="external">https://qw8.github.io/knowledges/uniapp.html</a>
        
    </div>
    
    <footer>
        <a href="https://qw8.github.io">
            <img src="/img/avatar.jpg" alt="秦伟">
            秦伟
        </a>
    </footer>
</blockquote>

        
<div class="page-reward">
    <a id="rewardBtn" href="javascript:;" class="page-reward-btn waves-effect waves-circle waves-light">赏</a>
</div>



        <div class="post-footer">
            
	<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/uni-app/">uni-app</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/小程序/">小程序</a></li></ul>


            
<div class="page-share-wrap">
    

<div class="page-share" id="pageShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://qw8.github.io/knowledges/uniapp.html&title=《uniapp》 — 秦伟博客&pic=https://qw8.github.io/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://qw8.github.io/knowledges/uniapp.html&title=《uniapp》 — 秦伟博客&source=前端、全栈、SEO的知识点、面试题与学习链接的整理" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://qw8.github.io/knowledges/uniapp.html" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《uniapp》 — 秦伟博客&url=https://qw8.github.io/knowledges/uniapp.html&via=https://qw8.github.io" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://qw8.github.io/knowledges/uniapp.html" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>



    <a href="javascript:;" id="shareFab" class="page-share-fab waves-effect waves-circle">
        <i class="icon icon-share-alt icon-lg"></i>
    </a>
</div>



        </div>
    </div>

    
<nav class="post-nav flex-row flex-justify-between">
  
    <div class="waves-block waves-effect prev">
      <a href="/knowledges/uniapp-ji-chu-zhi-shi.html" id="post-prev" class="post-nav-link">
        <div class="tips"><i class="icon icon-angle-left icon-lg icon-pr"></i> Prev</div>
        <h4 class="title">uniapp基础知识</h4>
      </a>
    </div>
  

  
    <div class="waves-block waves-effect next">
      <a href="/knowledges/vuex.html" id="post-next" class="post-nav-link">
        <div class="tips">Next <i class="icon icon-angle-right icon-lg icon-pl"></i></div>
        <h4 class="title">vuex</h4>
      </a>
    </div>
  
</nav>



    











    <!-- Valine Comments -->
    <div class="comments vcomment" id="comments"></div>
    <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
    <script src="//unpkg.com/valine@latest/dist/Valine.min.js"></script>
    <!-- Valine Comments script -->
    <script>
        var GUEST_INFO = ['nick','mail','link'];
        var guest_info = 'nick,mail,link'.split(',').filter(function(item){
          return GUEST_INFO.indexOf(item) > -1
        });
        new Valine({
            el: '#comments',
            notify: 'false' == 'true',
            verify: 'false' == 'true',
            appId: "TJ17Ax10JrfIIljlO8qkwGvz-gzGzoHsz",
            appKey: "jDGQKdWT9hlzsTLRAbInE4bK",
            avatar: "mm",
            placeholder: "说点什么吧(*╹▽╹*)",
            guest_info: guest_info.length == 0 ? GUEST_INFO : guest_info,
            pageSize: "10"
        })
    </script>
    <!-- Valine Comments end -->










</article>

<div id="reward" class="page-modal reward-lay">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <h3 class="reward-title">
        <i class="icon icon-quote-left"></i>
        谢谢您，我会继续努力哒(*^▽^*)
        <i class="icon icon-quote-right"></i>
    </h3>
    <div class="reward-content">
        
        <div class="reward-code">
            <img id="rewardCode" src="/img/wechat.png" alt="打赏二维码">
        </div>
        
        <label class="reward-toggle">
            <input id="rewardToggle" type="checkbox" class="reward-toggle-check"
                data-wechat="/img/wechat.png" data-alipay="/img/alipay.jpg">
            <div class="reward-toggle-ctrol">
                <span class="reward-toggle-item wechat">微信</span>
                <span class="reward-toggle-label"></span>
                <span class="reward-toggle-item alipay">支付宝</span>
            </div>
        </label>
        
    </div>
</div>



</div>

    <footer class="footer">
    <div class="top">
        <div class="map">
            <!--地球信息-->
<script type="text/javascript" src="/js/jquery-3.4.1.js"></script>
<script type="text/javascript">
    var windowWidth = $(window).width();
    if (windowWidth > 480) {
        document.write('<script type="text/javascript" src="//rf.revolvermaps.com/0/0/8.js?i=5mz4gy0w2d8&amp;m=0&amp;c=ff0000&amp;cr1=ffffff&amp;f=arial&amp;l=33" async="async">  <\/script>');
    }
</script>
        </div>
        <p>
<p>
    <span id="busuanzi_container_site_uv" style='display:none'>
        站点总访客数：<span id="busuanzi_value_site_uv"></span>
    </span>
    <span id="busuanzi_container_site_pv" style='display:none'>
        站点总访问量：<span id="busuanzi_value_site_pv"></span>
    </span>
</p>

</p>
        <p>
            <span>本网站总字数：832.4k</span>
            <span id="sitetime"></span>
        </p>
        <p>部分内容来源于互联网，用于个人知识的总结，如有侵权还请联系删除</p>
        <p>
            
            <span><a href="/atom.xml" target="_blank" class="rss" title="rss"><i
                    class="icon icon-lg icon-rss"></i></a></span>
            
            <span>博客内容遵循 <a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh">知识共享 署名 - 非商业性 - 相同方式共享 4.0 国际协议</a></span>
        </p>
    </div>

    <div class="bottom">
        <p>
            <span>Copyright &copy; 2019 - 2024 <a
                href="https://qw8.github.io/" target="_blank">秦伟的个人博客</a> All Rights Reserved.</span>
            <!-- <span>
                
                
            </span> -->
        </p>
    </div>
</footer>

<script language=javascript>
    function siteTime() {
        window.setTimeout("siteTime()", 1000);
        var seconds = 1000;
        var minutes = seconds * 60;
        var hours = minutes * 60;
        var days = hours * 24;
        var years = days * 365;
        var today = new Date();
        var todayYear = today.getFullYear();
        var todayMonth = today.getMonth() + 1;
        var todayDate = today.getDate();
        var todayHour = today.getHours();
        var todayMinute = today.getMinutes();
        var todaySecond = today.getSeconds();
        /* Date.UTC() -- 返回date对象距世界标准时间(UTC)1970年1月1日午夜之间的毫秒数(时间戳)
        year - 作为date对象的年份，为4位年份值
        month - 0-11之间的整数，做为date对象的月份
        day - 1-31之间的整数，做为date对象的天数
        hours - 0(午夜24点)-23之间的整数，做为date对象的小时数
        minutes - 0-59之间的整数，做为date对象的分钟数
        seconds - 0-59之间的整数，做为date对象的秒数
        microseconds - 0-999之间的整数，做为date对象的毫秒数 */
        var t1 = Date.UTC(2019, 8, 25, 18, 0, 0); // 北京时间
        var t2 = Date.UTC(todayYear, todayMonth, todayDate, todayHour, todayMinute, todaySecond);
        var diff = t2 - t1;
        var diffYears = Math.floor(diff / years);
        var diffDays = Math.floor((diff / days) - diffYears * 365);
        var diffHours = Math.floor((diff - (diffYears * 365 + diffDays) * days) / hours);
        var diffMinutes = Math.floor((diff - (diffYears * 365 + diffDays) * days - diffHours * hours) / minutes);
        var diffSeconds = Math.floor((diff - (diffYears * 365 + diffDays) * days - diffHours * hours - diffMinutes * minutes) / seconds);
        document.getElementById("sitetime").innerHTML = "已安全运行 " + diffYears + "年 " + diffDays + "天 " + diffHours + "小时 " + diffMinutes + "分钟 " + diffSeconds + "秒";
    }
    siteTime();
</script>
</main>
<div class="mask" id="mask"></div>
<a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a>



<div class="global-share" id="globalShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://qw8.github.io/knowledges/uniapp.html&title=《uniapp》 — 秦伟博客&pic=https://qw8.github.io/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://qw8.github.io/knowledges/uniapp.html&title=《uniapp》 — 秦伟博客&source=前端、全栈、SEO的知识点、面试题与学习链接的整理" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://qw8.github.io/knowledges/uniapp.html" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《uniapp》 — 秦伟博客&url=https://qw8.github.io/knowledges/uniapp.html&via=https://qw8.github.io" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://qw8.github.io/knowledges/uniapp.html" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>


<div class="page-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>扫一扫，分享到微信</p>
    <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMYAAADGCAAAAACs8KCBAAACIUlEQVR42u3aS27DMAxF0ex/0+o0QGDnPlIpYOpqVBiO7aMBy49eL7zW23q/Qu68v+fzmfe/bS0ZMmQ8lrFu1/2LCYlsBH/vJVWGDBkHMMhHpL+qBXEe1mXIkCEjfVw/Way9V4YMGTJ4kkfCJU9DZciQIaPz6DSY3t+ZFrcbanEZMmQ8kMELzv//+yfzDRkyZDyKscLFqWm4XI0lQ4aM2Qwe4PqlJt+aYqIpQ4aMoYz149UfaqInyJAhYzQjbZ/xxC49tNEZM8iQIWM2g7fjebHKw3rnznjWKkOGjBGMTkglobMWgtH/ChkyZBzD4C0zDkuPZfCNkCFDxsmMtMWfjio7yeXldRkyZBzJ6LT406C5gS1DhozRjL39q/RwBkkTU7AMGTLmMWoDSzJo3FXWohmsDBkyjmHUDm/xpv+upPMyw5UhQ8aRjLSttms7+BOCfZUhQ8ZjGbUDEGm5m/J4eRwfvJAhQ8YIRtomS49wkQQxvSJDhowTGDxF49RaAOUJaNB0kyFDxjhG/7PSNLG2NWiQKUOGjHGMNAjyj947GPiS28qQIWMcY4WLlL48xdw2MJAhQ8ZoRmfYyV9DUkN+XINvhwwZMiYx0k/sDA/4p/MiWYYMGecw+AmrTlOsfxTjy2BAhgwZMkqpXjpIKLb8ZMiQISOsemtjUZQC8hGmDBkyxjFIEVtL9Xjy1wrfMmTIGM3ohDz+Ag6rHR2TIUPGUMYfW0OTYcS7wfgAAAAASUVORK5CYII=" alt="微信分享二维码">
</div>




<script src="//cdn.bootcss.com/node-waves/0.7.4/waves.min.js"></script>
<script>
var BLOG = { ROOT: '/', SHARE: true, REWARD: true };


</script>

<script src="/js/main.min.js?v=1.7.2"></script>


<div class="search-panel" id="search-panel">
    <ul class="search-result" id="search-result"></ul>
</div>
<template id="search-tpl">
<li class="item">
    <a href="{path}" class="waves-block waves-effect">
        <div class="title ellipsis" title="{title}">{title}</div>
        <div class="flex-row flex-middle">
            <div class="tags ellipsis">
                {tags}
            </div>
            <time class="flex-col time">{date}</time>
        </div>
    </a>
</li>
</template>

<script src="/js/search.min.js?v=1.7.2" async></script>



<!-- mathjax config similar to math.stackexchange -->

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';
    }
});
</script>

<script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" async></script>




<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>



<script>
(function() {
    var OriginTitile = document.title, titleTime;
    document.addEventListener('visibilitychange', function() {
        if (document.hidden) {
            document.title = '(つェ⊂)咦!跑去哪里了';
            clearTimeout(titleTime);
        } else {
            document.title = '欢迎回来━(*｀∀´*)ノ';
            titleTime = setTimeout(function() {
                document.title = OriginTitile;
            },2000);
        }
    });
})();
</script>




<!-- 点击特效 -->
<script type="text/javascript" src="/js/clicklove.js"></script>
<!--动态线条背景-->
<script type="text/javascript"
        color="220,220,220" opacity='0.7' zIndex="-2" count="200"
        src="//cdn.bootcss.com/canvas-nest.js/1.0.0/canvas-nest.min.js">
</script>
<!-- 雪花特效 -->
<script type="text/javascript" src="/js/jquery-3.4.1.js"></script>
<script type="text/javascript">
    var windowWidth = $(window).width();
    if (windowWidth > 480) {
        document.write('<script type="text/javascript" src="/js/snow.js"><\/script>');
    }
</script>

<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"model":{"scale":1,"hHeadPos":0.5,"vHeadPos":0.618,"jsonPath":"/live2dw/assets/tororo.model.json"},"display":{"superSample":2,"position":"right","width":150,"height":300,"hOffset":-25,"vOffset":30},"mobile":{"show":false,"scale":1.2},"react":{"opacityDefault":0.7,"opacityOnHover":0.2},"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script><script>!function(e){var r=Array.prototype.slice.call(document.querySelectorAll("img[data-original]"));function t(){for(var c=0;c<r.length;c++)t=r[c],void 0,0<=(n=t.getBoundingClientRect()).top&&0<=n.left&&n.top<=(e.innerHeight||document.documentElement.clientHeight)&&function(){var t,n,e,i,o=r[c];t=o,n=function(){r=r.filter(function(t){return o!==t})},e=new Image,i=t.getAttribute("data-original"),e.onload=function(){t.src=i,n&&n()},e.src=i}();var t,n}t(),e.addEventListener("scroll",function(){!function(t,n){clearTimeout(t.tId),t.tId=setTimeout(function(){t.call(n)},500)}(t,e)})}(this);</script></body>
</html>
